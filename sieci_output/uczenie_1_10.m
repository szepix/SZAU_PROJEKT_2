%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.302325e+002; foe(n+1)=6.263137e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.190195e+002; foe(n+1)=6.171954e+002; krok(n+1)=5.333277e-004; ng(n+1)=2.164198e+002;
n=2; farx(n+1)=6.157550e+002; foe(n+1)=6.162141e+002; krok(n+1)=1.284363e-003; ng(n+1)=5.413001e+001;
n=3; farx(n+1)=1.806458e+002; foe(n+1)=1.949109e+002; krok(n+1)=2.114442e-001; ng(n+1)=9.194652e+000;
n=4; farx(n+1)=1.807273e+002; foe(n+1)=1.948814e+002; krok(n+1)=5.456206e-006; ng(n+1)=1.450007e+002;
n=5; farx(n+1)=1.807273e+002; foe(n+1)=1.948814e+002; krok(n+1)=9.939659e-015; ng(n+1)=1.393733e+002;
n=6; farx(n+1)=1.090875e+002; foe(n+1)=1.922027e+002; krok(n+1)=3.589327e-001; ng(n+1)=1.393733e+002;
n=7; farx(n+1)=8.211384e+001; foe(n+1)=1.888387e+002; krok(n+1)=1.051652e-001; ng(n+1)=2.365808e+002;
n=8; farx(n+1)=4.717773e+001; foe(n+1)=1.209248e+002; krok(n+1)=1.454604e+000; ng(n+1)=4.065537e+002;
n=9; farx(n+1)=4.677664e+001; foe(n+1)=1.199740e+002; krok(n+1)=8.928204e-003; ng(n+1)=5.050511e+002;
n=10; farx(n+1)=3.181880e+001; foe(n+1)=9.436391e+001; krok(n+1)=4.004429e-001; ng(n+1)=2.944715e+002;
n=11; farx(n+1)=2.942000e+001; foe(n+1)=8.793866e+001; krok(n+1)=9.595947e-002; ng(n+1)=6.238617e+002;
n=12; farx(n+1)=2.067506e+001; foe(n+1)=6.175449e+001; krok(n+1)=4.300038e-001; ng(n+1)=5.472539e+002;
n=13; farx(n+1)=1.851398e+001; foe(n+1)=5.753590e+001; krok(n+1)=1.181571e+000; ng(n+1)=1.130771e+002;
n=14; farx(n+1)=1.482559e+001; foe(n+1)=5.218016e+001; krok(n+1)=8.457767e-001; ng(n+1)=5.097877e+002;
n=15; farx(n+1)=1.287606e+001; foe(n+1)=4.450509e+001; krok(n+1)=4.859246e-001; ng(n+1)=8.347062e+002;
n=16; farx(n+1)=1.052669e+001; foe(n+1)=3.858842e+001; krok(n+1)=7.847380e-001; ng(n+1)=3.307323e+002;
n=17; farx(n+1)=5.945627e+000; foe(n+1)=3.139908e+001; krok(n+1)=1.822196e+000; ng(n+1)=2.238382e+002;
n=18; farx(n+1)=5.199255e+000; foe(n+1)=2.942893e+001; krok(n+1)=7.045190e-002; ng(n+1)=3.649092e+002;
n=19; farx(n+1)=4.049563e+000; foe(n+1)=2.573289e+001; krok(n+1)=2.022243e-001; ng(n+1)=8.585161e+002;
n=20; farx(n+1)=3.691516e+000; foe(n+1)=2.362690e+001; krok(n+1)=6.293018e-001; ng(n+1)=1.038427e+003;
n=21; farx(n+1)=2.855542e+000; foe(n+1)=2.273899e+001; krok(n+1)=1.078611e+000; ng(n+1)=2.366323e+002;
n=22; farx(n+1)=2.783885e+000; foe(n+1)=2.119471e+001; krok(n+1)=7.208199e-001; ng(n+1)=1.602213e+002;
n=23; farx(n+1)=2.377629e+000; foe(n+1)=1.951299e+001; krok(n+1)=4.930774e-001; ng(n+1)=2.447925e+002;
n=24; farx(n+1)=2.212833e+000; foe(n+1)=1.893784e+001; krok(n+1)=8.670260e-001; ng(n+1)=3.798226e+002;
n=25; farx(n+1)=2.005679e+000; foe(n+1)=1.864137e+001; krok(n+1)=1.131462e+000; ng(n+1)=2.355021e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.995548e+000; foe(n+1)=1.858531e+001; krok(n+1)=7.760930e-006; ng(n+1)=1.662223e+002;
n=27; farx(n+1)=1.910407e+000; foe(n+1)=1.847377e+001; krok(n+1)=5.665485e-005; ng(n+1)=9.265094e+001;
n=28; farx(n+1)=1.892519e+000; foe(n+1)=1.830865e+001; krok(n+1)=3.870231e-004; ng(n+1)=4.954216e+001;
n=29; farx(n+1)=1.943548e+000; foe(n+1)=1.751457e+001; krok(n+1)=1.156009e-003; ng(n+1)=6.544658e+001;
n=30; farx(n+1)=1.827790e+000; foe(n+1)=1.696401e+001; krok(n+1)=7.873516e-003; ng(n+1)=2.152043e+002;
n=31; farx(n+1)=1.786809e+000; foe(n+1)=1.683073e+001; krok(n+1)=1.064021e-002; ng(n+1)=2.613335e+002;
n=32; farx(n+1)=2.061021e+000; foe(n+1)=1.664644e+001; krok(n+1)=1.383770e-001; ng(n+1)=3.288814e+002;
n=33; farx(n+1)=1.765340e+000; foe(n+1)=1.612523e+001; krok(n+1)=6.809733e-001; ng(n+1)=2.821658e+002;
n=34; farx(n+1)=1.698938e+000; foe(n+1)=1.575853e+001; krok(n+1)=5.570755e-001; ng(n+1)=3.634251e+002;
n=35; farx(n+1)=1.640805e+000; foe(n+1)=1.530230e+001; krok(n+1)=8.352074e-001; ng(n+1)=7.000853e+001;
n=36; farx(n+1)=1.588358e+000; foe(n+1)=1.514814e+001; krok(n+1)=6.761661e-001; ng(n+1)=1.462437e+002;
n=37; farx(n+1)=1.543208e+000; foe(n+1)=1.496287e+001; krok(n+1)=1.232761e+000; ng(n+1)=2.264350e+002;
n=38; farx(n+1)=1.483130e+000; foe(n+1)=1.479570e+001; krok(n+1)=6.236064e-001; ng(n+1)=1.514379e+002;
n=39; farx(n+1)=1.409021e+000; foe(n+1)=1.474873e+001; krok(n+1)=9.073805e-001; ng(n+1)=1.234268e+002;
n=40; farx(n+1)=1.263025e+000; foe(n+1)=1.464815e+001; krok(n+1)=1.420334e+000; ng(n+1)=1.064146e+002;
n=41; farx(n+1)=1.284651e+000; foe(n+1)=1.461639e+001; krok(n+1)=5.155493e-001; ng(n+1)=1.913306e+002;
n=42; farx(n+1)=1.275394e+000; foe(n+1)=1.459538e+001; krok(n+1)=2.522670e-001; ng(n+1)=5.261412e+001;
n=43; farx(n+1)=1.169650e+000; foe(n+1)=1.458023e+001; krok(n+1)=6.477968e-001; ng(n+1)=3.847596e+001;
n=44; farx(n+1)=1.142099e+000; foe(n+1)=1.456859e+001; krok(n+1)=9.282331e-001; ng(n+1)=5.146579e+001;
n=45; farx(n+1)=1.100264e+000; foe(n+1)=1.456000e+001; krok(n+1)=1.015323e+000; ng(n+1)=6.445068e+001;
n=46; farx(n+1)=1.070806e+000; foe(n+1)=1.455089e+001; krok(n+1)=7.537225e-001; ng(n+1)=1.608029e+001;
n=47; farx(n+1)=1.075494e+000; foe(n+1)=1.454349e+001; krok(n+1)=9.574267e-001; ng(n+1)=4.603361e+001;
n=48; farx(n+1)=1.043848e+000; foe(n+1)=1.452747e+001; krok(n+1)=2.341487e+000; ng(n+1)=4.648561e+001;
n=49; farx(n+1)=1.041855e+000; foe(n+1)=1.452475e+001; krok(n+1)=6.449478e-001; ng(n+1)=5.995419e+001;
n=50; farx(n+1)=1.027971e+000; foe(n+1)=1.452366e+001; krok(n+1)=3.282103e-001; ng(n+1)=1.236141e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.028115e+000; foe(n+1)=1.452361e+001; krok(n+1)=9.340678e-006; ng(n+1)=6.107088e+000;
n=52; farx(n+1)=1.028094e+000; foe(n+1)=1.452360e+001; krok(n+1)=2.411899e-006; ng(n+1)=5.627511e+000;
n=53; farx(n+1)=1.027940e+000; foe(n+1)=1.452359e+001; krok(n+1)=1.270135e-004; ng(n+1)=6.327892e-001;
n=54; farx(n+1)=1.030923e+000; foe(n+1)=1.452339e+001; krok(n+1)=9.697088e-004; ng(n+1)=1.099283e+000;
n=55; farx(n+1)=1.036095e+000; foe(n+1)=1.452330e+001; krok(n+1)=2.000182e-002; ng(n+1)=1.710216e-001;
n=56; farx(n+1)=9.999332e-001; foe(n+1)=1.452217e+001; krok(n+1)=5.403833e-001; ng(n+1)=1.984114e-001;
n=57; farx(n+1)=9.981856e-001; foe(n+1)=1.452209e+001; krok(n+1)=4.275969e-001; ng(n+1)=9.241138e+000;
n=58; farx(n+1)=9.878551e-001; foe(n+1)=1.452191e+001; krok(n+1)=2.317569e-001; ng(n+1)=5.291721e+000;
n=59; farx(n+1)=9.840847e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.055989e-001; ng(n+1)=1.996996e+000;
n=60; farx(n+1)=9.843962e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.752990e-001; ng(n+1)=1.093032e+000;
n=61; farx(n+1)=9.840465e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.024434e+000; ng(n+1)=1.479690e-001;
n=62; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.935632e-001; ng(n+1)=5.954484e-002;
n=63; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.260779e-005; ng(n+1)=1.110486e-003;
n=64; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.272873e-006; ng(n+1)=1.110453e-003;
n=65; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.674848e-006; ng(n+1)=1.110448e-003;
n=66; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.213417e-005; ng(n+1)=1.110445e-003;
n=67; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.026093e-005; ng(n+1)=1.110432e-003;
n=68; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.094321e-010; ng(n+1)=1.110409e-003;
n=69; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.179450e-008; ng(n+1)=1.110409e-003;
n=70; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.398521e-009; ng(n+1)=1.110409e-003;
n=71; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.197137e-007; ng(n+1)=1.110409e-003;
n=72; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.045913e-009; ng(n+1)=1.110409e-003;
n=73; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.706799e-008; ng(n+1)=1.110409e-003;
n=74; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.713671e-006; ng(n+1)=1.110409e-003;
n=75; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.430061e-005; ng(n+1)=1.110405e-003;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.801229e-006; ng(n+1)=1.110384e-003;
n=77; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.079318e-005; ng(n+1)=3.563922e-004;
n=78; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.598828e-005; ng(n+1)=1.512270e-004;
n=79; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.621411e-003; ng(n+1)=8.676536e-005;
n=80; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.085468e-005; ng(n+1)=1.039013e-004;
n=81; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.832743e-005; ng(n+1)=1.038992e-004;
n=82; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.237377e-009; ng(n+1)=1.038937e-004;
n=83; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.789720e-006; ng(n+1)=1.038937e-004;
n=84; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.495175e-009; ng(n+1)=1.038833e-004;
n=85; farx(n+1)=9.839923e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.702102e-009; ng(n+1)=1.038833e-004;
n=86; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.349066e-008; ng(n+1)=1.038833e-004;
n=87; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.141155e-007; ng(n+1)=7.971228e-004;
n=88; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.349696e-006; ng(n+1)=7.971218e-004;
n=89; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.036113e-008; ng(n+1)=7.971182e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=90; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.951149e-006; ng(n+1)=7.971182e-004;
n=91; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.383480e-005; ng(n+1)=2.334899e-004;
n=92; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.351588e-011; ng(n+1)=1.109294e-004;
n=93; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.392239e-008; ng(n+1)=1.109293e-004;
n=94; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.476376e-009; ng(n+1)=1.109293e-004;
n=95; farx(n+1)=9.839929e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.768433e-010; ng(n+1)=1.109293e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
