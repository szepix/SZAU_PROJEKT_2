%uczenie predyktora oe
clear all;
n=0; farx(n+1)=9.364372e+002; foe(n+1)=9.342717e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=9.177105e+002; foe(n+1)=9.165759e+002; krok(n+1)=5.897838e-004; ng(n+1)=3.123447e+002;
n=2; farx(n+1)=9.144048e+002; foe(n+1)=9.138535e+002; krok(n+1)=1.195607e-003; ng(n+1)=9.271125e+001;
n=3; farx(n+1)=2.631460e+002; foe(n+1)=2.621635e+002; krok(n+1)=2.152696e-002; ng(n+1)=8.454321e+001;
n=4; farx(n+1)=2.607132e+002; foe(n+1)=2.598553e+002; krok(n+1)=6.606617e-003; ng(n+1)=5.471203e+002;
n=5; farx(n+1)=5.376236e+002; foe(n+1)=2.406550e+002; krok(n+1)=1.389210e-001; ng(n+1)=4.984045e+002;
n=6; farx(n+1)=8.084009e+002; foe(n+1)=2.308926e+002; krok(n+1)=3.119818e-002; ng(n+1)=2.736233e+002;
n=7; farx(n+1)=8.106241e+002; foe(n+1)=2.253185e+002; krok(n+1)=4.438543e-002; ng(n+1)=2.094806e+002;
n=8; farx(n+1)=5.090468e+002; foe(n+1)=2.160565e+002; krok(n+1)=1.337651e-001; ng(n+1)=1.990060e+002;
n=9; farx(n+1)=2.949508e+002; foe(n+1)=1.996150e+002; krok(n+1)=2.609784e+000; ng(n+1)=2.197182e+002;
n=10; farx(n+1)=2.023291e+002; foe(n+1)=1.756530e+002; krok(n+1)=1.454334e+000; ng(n+1)=2.306448e+002;
n=11; farx(n+1)=1.651796e+002; foe(n+1)=1.656324e+002; krok(n+1)=2.577175e-001; ng(n+1)=2.028177e+002;
n=12; farx(n+1)=1.467149e+002; foe(n+1)=1.430825e+002; krok(n+1)=5.243733e-001; ng(n+1)=3.078269e+002;
n=13; farx(n+1)=1.449560e+002; foe(n+1)=1.392412e+002; krok(n+1)=1.077887e+000; ng(n+1)=1.465034e+002;
n=14; farx(n+1)=1.337756e+002; foe(n+1)=1.378444e+002; krok(n+1)=2.172575e+000; ng(n+1)=2.479660e+001;
n=15; farx(n+1)=1.226411e+002; foe(n+1)=1.359613e+002; krok(n+1)=1.740861e+000; ng(n+1)=3.111051e+001;
n=16; farx(n+1)=1.230713e+002; foe(n+1)=1.330751e+002; krok(n+1)=5.422186e+000; ng(n+1)=2.839929e+001;
n=17; farx(n+1)=1.225895e+002; foe(n+1)=1.329692e+002; krok(n+1)=3.979978e-002; ng(n+1)=6.242291e+001;
n=18; farx(n+1)=1.084376e+002; foe(n+1)=1.302389e+002; krok(n+1)=8.997464e-001; ng(n+1)=6.908188e+001;
n=19; farx(n+1)=1.064138e+002; foe(n+1)=1.290131e+002; krok(n+1)=9.112329e-001; ng(n+1)=5.861648e+001;
n=20; farx(n+1)=8.553673e+001; foe(n+1)=1.254321e+002; krok(n+1)=1.355274e+000; ng(n+1)=7.356871e+001;
n=21; farx(n+1)=6.286367e+001; foe(n+1)=1.224562e+002; krok(n+1)=3.450322e-002; ng(n+1)=3.919444e+002;
n=22; farx(n+1)=6.023605e+001; foe(n+1)=1.218989e+002; krok(n+1)=3.718534e-002; ng(n+1)=1.989115e+002;
n=23; farx(n+1)=5.497192e+001; foe(n+1)=1.201792e+002; krok(n+1)=3.616714e-002; ng(n+1)=1.950495e+002;
n=24; farx(n+1)=5.190760e+001; foe(n+1)=1.184207e+002; krok(n+1)=4.486659e-002; ng(n+1)=1.839510e+003;
n=25; farx(n+1)=4.733138e+001; foe(n+1)=1.142822e+002; krok(n+1)=5.793922e-002; ng(n+1)=8.681122e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.798254e+001; foe(n+1)=1.131073e+002; krok(n+1)=3.128736e-007; ng(n+1)=2.842418e+004;
n=27; farx(n+1)=3.743299e+001; foe(n+1)=1.093635e+002; krok(n+1)=5.295816e-004; ng(n+1)=2.537631e+002;
n=28; farx(n+1)=3.885207e+001; foe(n+1)=1.057263e+002; krok(n+1)=2.420827e-003; ng(n+1)=1.623499e+002;
n=29; farx(n+1)=3.137762e+001; foe(n+1)=8.541433e+001; krok(n+1)=1.881817e-003; ng(n+1)=1.721761e+002;
n=30; farx(n+1)=3.136711e+001; foe(n+1)=8.540189e+001; krok(n+1)=1.023758e-005; ng(n+1)=2.437816e+002;
n=31; farx(n+1)=3.157827e+001; foe(n+1)=8.390621e+001; krok(n+1)=2.595225e-003; ng(n+1)=2.489639e+002;
n=32; farx(n+1)=2.780743e+001; foe(n+1)=7.955378e+001; krok(n+1)=2.584327e-001; ng(n+1)=5.590284e+002;
n=33; farx(n+1)=1.610846e+001; foe(n+1)=5.792107e+001; krok(n+1)=6.435764e-001; ng(n+1)=4.251272e+002;
n=34; farx(n+1)=8.030592e+000; foe(n+1)=4.571306e+001; krok(n+1)=3.319551e-001; ng(n+1)=6.101506e+002;
n=35; farx(n+1)=7.124058e+000; foe(n+1)=4.448808e+001; krok(n+1)=2.538306e-001; ng(n+1)=5.716434e+002;
n=36; farx(n+1)=7.042448e+000; foe(n+1)=4.108713e+001; krok(n+1)=4.112198e-001; ng(n+1)=6.393509e+002;
n=37; farx(n+1)=6.913398e+000; foe(n+1)=3.908944e+001; krok(n+1)=4.329486e-001; ng(n+1)=7.868770e+002;
n=38; farx(n+1)=5.989514e+000; foe(n+1)=3.459034e+001; krok(n+1)=4.756263e-001; ng(n+1)=7.329705e+002;
n=39; farx(n+1)=5.322088e+000; foe(n+1)=3.303896e+001; krok(n+1)=3.589369e-001; ng(n+1)=5.873921e+002;
n=40; farx(n+1)=4.312896e+000; foe(n+1)=3.045956e+001; krok(n+1)=1.477307e+000; ng(n+1)=4.319844e+002;
n=41; farx(n+1)=4.056394e+000; foe(n+1)=2.890643e+001; krok(n+1)=5.045340e-001; ng(n+1)=2.748109e+002;
n=42; farx(n+1)=3.788214e+000; foe(n+1)=2.807351e+001; krok(n+1)=8.752990e-001; ng(n+1)=4.790650e+002;
n=43; farx(n+1)=3.502468e+000; foe(n+1)=2.758677e+001; krok(n+1)=8.922169e-001; ng(n+1)=6.294509e+002;
n=44; farx(n+1)=3.433777e+000; foe(n+1)=2.735426e+001; krok(n+1)=5.841487e-001; ng(n+1)=3.120366e+002;
n=45; farx(n+1)=3.570672e+000; foe(n+1)=2.720188e+001; krok(n+1)=1.522431e+000; ng(n+1)=4.141650e+002;
n=46; farx(n+1)=3.321130e+000; foe(n+1)=2.710125e+001; krok(n+1)=1.554381e+000; ng(n+1)=5.650654e+002;
n=47; farx(n+1)=3.075627e+000; foe(n+1)=2.701487e+001; krok(n+1)=1.062525e+000; ng(n+1)=4.746264e+002;
n=48; farx(n+1)=3.445375e+000; foe(n+1)=2.608756e+001; krok(n+1)=5.148611e+000; ng(n+1)=5.621629e+002;
n=49; farx(n+1)=3.017233e+000; foe(n+1)=2.404768e+001; krok(n+1)=2.382644e+000; ng(n+1)=4.921970e+002;
n=50; farx(n+1)=2.038103e+000; foe(n+1)=2.035299e+001; krok(n+1)=1.238762e+000; ng(n+1)=1.458714e+003;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.906795e+000; foe(n+1)=1.981384e+001; krok(n+1)=4.828730e-006; ng(n+1)=6.305278e+002;
n=52; farx(n+1)=1.740901e+000; foe(n+1)=1.924876e+001; krok(n+1)=1.197415e-005; ng(n+1)=5.330769e+002;
n=53; farx(n+1)=1.733678e+000; foe(n+1)=1.819110e+001; krok(n+1)=2.618406e-004; ng(n+1)=1.423006e+002;
n=54; farx(n+1)=1.532148e+000; foe(n+1)=1.296266e+001; krok(n+1)=6.066958e-004; ng(n+1)=2.306891e+002;
n=55; farx(n+1)=1.463068e+000; foe(n+1)=1.267228e+001; krok(n+1)=7.632150e-003; ng(n+1)=2.569093e+002;
n=56; farx(n+1)=8.924850e-001; foe(n+1)=1.076880e+001; krok(n+1)=3.411505e-002; ng(n+1)=6.992272e+002;
n=57; farx(n+1)=8.821500e-001; foe(n+1)=1.074744e+001; krok(n+1)=9.602589e-003; ng(n+1)=3.166007e+002;
n=58; farx(n+1)=9.489561e-001; foe(n+1)=1.043980e+001; krok(n+1)=1.569476e+000; ng(n+1)=3.257305e+002;
n=59; farx(n+1)=9.496203e-001; foe(n+1)=1.043914e+001; krok(n+1)=1.102111e-003; ng(n+1)=2.834159e+002;
n=60; farx(n+1)=9.268013e-001; foe(n+1)=9.935399e+000; krok(n+1)=1.691294e+000; ng(n+1)=2.824305e+002;
n=61; farx(n+1)=9.418153e-001; foe(n+1)=9.734367e+000; krok(n+1)=1.668762e+000; ng(n+1)=1.957172e+002;
n=62; farx(n+1)=9.246441e-001; foe(n+1)=9.665795e+000; krok(n+1)=7.461552e-001; ng(n+1)=2.475453e+002;
n=63; farx(n+1)=9.150810e-001; foe(n+1)=9.600034e+000; krok(n+1)=8.204121e-001; ng(n+1)=8.717206e+001;
n=64; farx(n+1)=8.991136e-001; foe(n+1)=9.544976e+000; krok(n+1)=6.228822e-001; ng(n+1)=1.224440e+002;
n=65; farx(n+1)=9.070035e-001; foe(n+1)=9.503967e+000; krok(n+1)=1.915347e+000; ng(n+1)=6.043138e+001;
n=66; farx(n+1)=9.083966e-001; foe(n+1)=9.495729e+000; krok(n+1)=8.088973e-001; ng(n+1)=5.907313e+001;
n=67; farx(n+1)=9.048132e-001; foe(n+1)=9.493033e+000; krok(n+1)=8.913350e-001; ng(n+1)=1.618247e+001;
n=68; farx(n+1)=9.020906e-001; foe(n+1)=9.490936e+000; krok(n+1)=6.081435e-001; ng(n+1)=4.749667e+001;
n=69; farx(n+1)=8.810892e-001; foe(n+1)=9.485573e+000; krok(n+1)=5.848156e+000; ng(n+1)=3.938432e+000;
n=70; farx(n+1)=8.622204e-001; foe(n+1)=9.481212e+000; krok(n+1)=3.771624e+000; ng(n+1)=1.483772e+001;
n=71; farx(n+1)=7.947755e-001; foe(n+1)=9.467337e+000; krok(n+1)=5.940872e+000; ng(n+1)=4.440427e+001;
n=72; farx(n+1)=7.484179e-001; foe(n+1)=9.453444e+000; krok(n+1)=1.635976e+000; ng(n+1)=5.982307e+000;
n=73; farx(n+1)=7.122922e-001; foe(n+1)=9.432781e+000; krok(n+1)=1.386016e+000; ng(n+1)=6.028349e+001;
n=74; farx(n+1)=7.174831e-001; foe(n+1)=9.423255e+000; krok(n+1)=1.168297e+000; ng(n+1)=5.906684e+001;
n=75; farx(n+1)=7.086746e-001; foe(n+1)=9.421177e+000; krok(n+1)=6.404647e-001; ng(n+1)=1.407882e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=7.085813e-001; foe(n+1)=9.420974e+000; krok(n+1)=2.803760e-006; ng(n+1)=2.124321e+001;
n=77; farx(n+1)=7.087790e-001; foe(n+1)=9.420908e+000; krok(n+1)=7.005815e-006; ng(n+1)=6.491740e+000;
n=78; farx(n+1)=7.092583e-001; foe(n+1)=9.420854e+000; krok(n+1)=5.019773e-005; ng(n+1)=2.317376e+000;
n=79; farx(n+1)=7.105315e-001; foe(n+1)=9.418573e+000; krok(n+1)=7.815763e-003; ng(n+1)=1.168752e+000;
n=80; farx(n+1)=7.162059e-001; foe(n+1)=9.417513e+000; krok(n+1)=5.027940e-003; ng(n+1)=9.266377e-001;
n=81; farx(n+1)=7.190519e-001; foe(n+1)=9.416936e+000; krok(n+1)=1.280543e-001; ng(n+1)=1.386988e-001;
n=82; farx(n+1)=7.371369e-001; foe(n+1)=9.415707e+000; krok(n+1)=2.693452e-001; ng(n+1)=2.930470e+000;
n=83; farx(n+1)=7.393207e-001; foe(n+1)=9.415464e+000; krok(n+1)=9.909022e-001; ng(n+1)=1.322635e+001;
n=84; farx(n+1)=7.411331e-001; foe(n+1)=9.415427e+000; krok(n+1)=1.220277e+000; ng(n+1)=1.333010e+000;
n=85; farx(n+1)=7.408918e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.717315e-001; ng(n+1)=9.802847e-001;
n=86; farx(n+1)=7.409295e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.015323e+000; ng(n+1)=4.162860e-002;
n=87; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.068393e+000; ng(n+1)=6.294030e-003;
n=88; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.508837e-005; ng(n+1)=1.516906e-003;
n=89; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.793088e-008; ng(n+1)=1.516881e-003;
n=90; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.952471e-006; ng(n+1)=1.516881e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=91; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.770138e-006; ng(n+1)=1.516798e-003;
n=92; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.377529e-006; ng(n+1)=3.015863e-004;
n=93; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.022725e-010; ng(n+1)=1.117607e-004;
n=94; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.394377e-012; ng(n+1)=1.117605e-004;
n=95; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.965956e-012; ng(n+1)=1.117605e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
