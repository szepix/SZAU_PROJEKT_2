%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.480714e+002; foe(n+1)=6.553819e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.026006e+002; foe(n+1)=6.127592e+002; krok(n+1)=5.014459e-004; ng(n+1)=3.859900e+002;
n=2; farx(n+1)=1.819802e+002; foe(n+1)=1.974416e+002; krok(n+1)=2.219272e-002; ng(n+1)=1.051189e+002;
n=3; farx(n+1)=1.786213e+002; foe(n+1)=1.918294e+002; krok(n+1)=1.250908e-003; ng(n+1)=2.502576e+002;
n=4; farx(n+1)=1.759147e+002; foe(n+1)=1.812381e+002; krok(n+1)=4.896932e-003; ng(n+1)=2.453910e+002;
n=5; farx(n+1)=1.602705e+002; foe(n+1)=1.788524e+002; krok(n+1)=1.890949e-002; ng(n+1)=1.149490e+002;
n=6; farx(n+1)=1.665719e+002; foe(n+1)=1.673530e+002; krok(n+1)=3.025518e-001; ng(n+1)=1.754177e+002;
n=7; farx(n+1)=1.639701e+002; foe(n+1)=1.666340e+002; krok(n+1)=2.835564e-002; ng(n+1)=1.390715e+002;
n=8; farx(n+1)=6.092241e+001; foe(n+1)=1.365503e+002; krok(n+1)=5.229318e-001; ng(n+1)=1.527716e+002;
n=9; farx(n+1)=4.962553e+001; foe(n+1)=1.345151e+002; krok(n+1)=1.174729e-001; ng(n+1)=3.771478e+002;
n=10; farx(n+1)=4.317662e+001; foe(n+1)=1.262317e+002; krok(n+1)=2.394184e-001; ng(n+1)=5.545666e+002;
n=11; farx(n+1)=4.296238e+001; foe(n+1)=1.053697e+002; krok(n+1)=8.436372e-002; ng(n+1)=1.146554e+003;
n=12; farx(n+1)=4.298568e+001; foe(n+1)=1.052028e+002; krok(n+1)=4.876433e-003; ng(n+1)=2.676273e+002;
n=13; farx(n+1)=3.617856e+001; foe(n+1)=8.304475e+001; krok(n+1)=2.850859e-001; ng(n+1)=7.742708e+002;
n=14; farx(n+1)=3.228984e+001; foe(n+1)=7.695680e+001; krok(n+1)=2.978305e-001; ng(n+1)=5.200719e+002;
n=15; farx(n+1)=2.341086e+001; foe(n+1)=6.698973e+001; krok(n+1)=4.500546e-001; ng(n+1)=7.812143e+002;
n=16; farx(n+1)=1.931230e+001; foe(n+1)=6.032750e+001; krok(n+1)=2.672252e-001; ng(n+1)=1.196419e+003;
n=17; farx(n+1)=2.010806e+001; foe(n+1)=5.936562e+001; krok(n+1)=5.779335e-001; ng(n+1)=6.325878e+002;
n=18; farx(n+1)=2.055712e+001; foe(n+1)=5.748299e+001; krok(n+1)=2.984343e+000; ng(n+1)=5.399943e+002;
n=19; farx(n+1)=1.801223e+001; foe(n+1)=5.502801e+001; krok(n+1)=2.012153e+000; ng(n+1)=3.200142e+002;
n=20; farx(n+1)=1.755126e+001; foe(n+1)=5.333621e+001; krok(n+1)=7.491049e-001; ng(n+1)=5.629399e+002;
n=21; farx(n+1)=1.708683e+001; foe(n+1)=5.222887e+001; krok(n+1)=5.030621e-001; ng(n+1)=3.578162e+002;
n=22; farx(n+1)=1.694237e+001; foe(n+1)=5.162177e+001; krok(n+1)=6.614848e-001; ng(n+1)=5.635676e+002;
n=23; farx(n+1)=1.567885e+001; foe(n+1)=5.077073e+001; krok(n+1)=2.092736e+000; ng(n+1)=5.691333e+002;
n=24; farx(n+1)=1.537026e+001; foe(n+1)=5.025721e+001; krok(n+1)=5.002089e-001; ng(n+1)=7.547434e+002;
n=25; farx(n+1)=1.480863e+001; foe(n+1)=4.958478e+001; krok(n+1)=2.451494e+000; ng(n+1)=5.555674e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.420624e+001; foe(n+1)=4.870942e+001; krok(n+1)=1.278257e-005; ng(n+1)=4.581933e+002;
n=27; farx(n+1)=9.989268e+000; foe(n+1)=4.312250e+001; krok(n+1)=7.138862e-004; ng(n+1)=1.444662e+002;
n=28; farx(n+1)=6.205558e+000; foe(n+1)=3.305115e+001; krok(n+1)=2.302017e-004; ng(n+1)=4.420896e+002;
n=29; farx(n+1)=6.156182e+000; foe(n+1)=3.250572e+001; krok(n+1)=5.828972e-004; ng(n+1)=9.648089e+002;
n=30; farx(n+1)=5.992474e+000; foe(n+1)=3.142010e+001; krok(n+1)=1.387045e-003; ng(n+1)=6.500315e+002;
n=31; farx(n+1)=5.565751e+000; foe(n+1)=3.099812e+001; krok(n+1)=1.778431e-001; ng(n+1)=2.819208e+002;
n=32; farx(n+1)=4.917606e+000; foe(n+1)=2.981975e+001; krok(n+1)=1.961845e-001; ng(n+1)=3.983718e+002;
n=33; farx(n+1)=4.722914e+000; foe(n+1)=2.864589e+001; krok(n+1)=3.202323e-001; ng(n+1)=5.126364e+002;
n=34; farx(n+1)=4.941586e+000; foe(n+1)=2.600834e+001; krok(n+1)=2.196395e+000; ng(n+1)=8.744144e+002;
n=35; farx(n+1)=4.017144e+000; foe(n+1)=2.356126e+001; krok(n+1)=1.009068e+000; ng(n+1)=5.793403e+002;
n=36; farx(n+1)=3.335519e+000; foe(n+1)=2.122835e+001; krok(n+1)=5.525859e-001; ng(n+1)=4.494632e+002;
n=37; farx(n+1)=2.689219e+000; foe(n+1)=2.019785e+001; krok(n+1)=7.011953e-001; ng(n+1)=2.814059e+002;
n=38; farx(n+1)=2.169592e+000; foe(n+1)=1.918389e+001; krok(n+1)=5.551463e-001; ng(n+1)=5.784154e+002;
n=39; farx(n+1)=2.105309e+000; foe(n+1)=1.852904e+001; krok(n+1)=3.161324e-001; ng(n+1)=4.382871e+002;
n=40; farx(n+1)=2.212953e+000; foe(n+1)=1.722299e+001; krok(n+1)=7.926233e-001; ng(n+1)=1.837229e+002;
n=41; farx(n+1)=2.040100e+000; foe(n+1)=1.651612e+001; krok(n+1)=8.892951e-001; ng(n+1)=2.455913e+002;
n=42; farx(n+1)=1.761213e+000; foe(n+1)=1.583135e+001; krok(n+1)=1.154449e+000; ng(n+1)=1.742458e+002;
n=43; farx(n+1)=1.701590e+000; foe(n+1)=1.548052e+001; krok(n+1)=3.655097e-001; ng(n+1)=4.433627e+002;
n=44; farx(n+1)=1.524425e+000; foe(n+1)=1.526080e+001; krok(n+1)=8.610892e-001; ng(n+1)=8.360960e+001;
n=45; farx(n+1)=1.493330e+000; foe(n+1)=1.503202e+001; krok(n+1)=3.923690e-001; ng(n+1)=1.806375e+002;
n=46; farx(n+1)=1.512160e+000; foe(n+1)=1.492667e+001; krok(n+1)=6.051036e-001; ng(n+1)=2.758007e+002;
n=47; farx(n+1)=1.622909e+000; foe(n+1)=1.480759e+001; krok(n+1)=7.101669e-001; ng(n+1)=1.056874e+002;
n=48; farx(n+1)=1.422282e+000; foe(n+1)=1.472927e+001; krok(n+1)=5.403833e-001; ng(n+1)=7.621818e+001;
n=49; farx(n+1)=1.312057e+000; foe(n+1)=1.467745e+001; krok(n+1)=8.377184e-001; ng(n+1)=1.820931e+002;
n=50; farx(n+1)=1.259286e+000; foe(n+1)=1.461432e+001; krok(n+1)=1.114269e+000; ng(n+1)=2.848581e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.257293e+000; foe(n+1)=1.460944e+001; krok(n+1)=3.897392e-006; ng(n+1)=8.387807e+001;
n=52; farx(n+1)=1.255540e+000; foe(n+1)=1.460141e+001; krok(n+1)=1.538457e-005; ng(n+1)=5.180065e+001;
n=53; farx(n+1)=1.250387e+000; foe(n+1)=1.459890e+001; krok(n+1)=4.506169e-005; ng(n+1)=1.391272e+001;
n=54; farx(n+1)=1.253245e+000; foe(n+1)=1.459226e+001; krok(n+1)=6.748373e-003; ng(n+1)=2.520730e+000;
n=55; farx(n+1)=1.299407e+000; foe(n+1)=1.458103e+001; krok(n+1)=1.351485e-002; ng(n+1)=3.828771e+000;
n=56; farx(n+1)=1.238979e+000; foe(n+1)=1.457378e+001; krok(n+1)=4.703297e-002; ng(n+1)=2.861749e+001;
n=57; farx(n+1)=1.205243e+000; foe(n+1)=1.456041e+001; krok(n+1)=2.072253e-001; ng(n+1)=7.379756e+001;
n=58; farx(n+1)=1.145985e+000; foe(n+1)=1.454615e+001; krok(n+1)=1.056325e+000; ng(n+1)=9.541230e+001;
n=59; farx(n+1)=1.085800e+000; foe(n+1)=1.453424e+001; krok(n+1)=1.561751e+000; ng(n+1)=2.510786e+001;
n=60; farx(n+1)=1.084279e+000; foe(n+1)=1.452652e+001; krok(n+1)=1.991896e+000; ng(n+1)=5.923474e+001;
n=61; farx(n+1)=1.046149e+000; foe(n+1)=1.452461e+001; krok(n+1)=7.021280e-001; ng(n+1)=7.702573e+000;
n=62; farx(n+1)=1.022191e+000; foe(n+1)=1.452327e+001; krok(n+1)=3.427774e-001; ng(n+1)=2.180742e+001;
n=63; farx(n+1)=1.004700e+000; foe(n+1)=1.452263e+001; krok(n+1)=8.040192e-001; ng(n+1)=2.761015e+001;
n=64; farx(n+1)=9.939397e-001; foe(n+1)=1.452213e+001; krok(n+1)=1.086288e+000; ng(n+1)=6.240653e+000;
n=65; farx(n+1)=9.954559e-001; foe(n+1)=1.452195e+001; krok(n+1)=8.006816e-001; ng(n+1)=8.893045e+000;
n=66; farx(n+1)=9.865593e-001; foe(n+1)=1.452190e+001; krok(n+1)=1.023163e+000; ng(n+1)=5.342119e-001;
n=67; farx(n+1)=9.843014e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.008859e-001; ng(n+1)=1.337452e+000;
n=68; farx(n+1)=9.839950e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.139125e+000; ng(n+1)=3.369715e-001;
n=69; farx(n+1)=9.839926e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.171548e+000; ng(n+1)=2.486968e-001;
n=70; farx(n+1)=9.839462e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.080989e+000; ng(n+1)=2.291426e-001;
n=71; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.812470e-001; ng(n+1)=3.860412e-002;
n=72; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.117235e-007; ng(n+1)=4.784724e-003;
n=73; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.343560e-007; ng(n+1)=4.784724e-003;
 % z造 kierunek w metodzie zm - odnowa 
n=74; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.940122e-006; ng(n+1)=4.784722e-003;
n=75; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.738604e-006; ng(n+1)=1.625393e-003;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.033526e-006; ng(n+1)=2.192573e-004;
n=77; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.332946e-006; ng(n+1)=1.120046e-004;
n=78; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.720244e-005; ng(n+1)=1.079112e-004;
n=79; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.688916e-003; ng(n+1)=2.460770e-004;
n=80; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.504753e-005; ng(n+1)=1.662926e-004;
n=81; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.092544e-010; ng(n+1)=1.662452e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=82; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.046074e-005; ng(n+1)=1.662452e-004;
n=83; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.150304e-006; ng(n+1)=2.727213e-004;
n=84; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.456311e-005; ng(n+1)=2.644276e-004;
n=85; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.743790e-005; ng(n+1)=2.416991e-004;
n=86; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.430061e-005; ng(n+1)=2.416887e-004;
 % z造 kierunek w metodzie zm - odnowa 
 % z造 kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
