%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.168135e+002; foe(n+1)=6.120187e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.029301e+002; foe(n+1)=5.930658e+002; krok(n+1)=1.066655e-003; ng(n+1)=2.493652e+002;
n=2; farx(n+1)=3.694718e+002; foe(n+1)=3.449276e+002; krok(n+1)=2.716773e-003; ng(n+1)=3.829774e+002;
n=3; farx(n+1)=3.651425e+002; foe(n+1)=3.177171e+002; krok(n+1)=3.473499e-004; ng(n+1)=1.148340e+003;
n=4; farx(n+1)=9.649599e+002; foe(n+1)=2.630401e+002; krok(n+1)=8.672124e-003; ng(n+1)=1.136558e+003;
n=5; farx(n+1)=1.089937e+003; foe(n+1)=2.534130e+002; krok(n+1)=1.771116e-002; ng(n+1)=2.804913e+002;
n=6; farx(n+1)=1.068444e+003; foe(n+1)=2.517282e+002; krok(n+1)=2.539936e-002; ng(n+1)=2.312236e+002;
n=7; farx(n+1)=6.135247e+002; foe(n+1)=2.247140e+002; krok(n+1)=9.515193e-002; ng(n+1)=2.419660e+002;
n=8; farx(n+1)=4.403294e+002; foe(n+1)=2.177043e+002; krok(n+1)=3.113587e-003; ng(n+1)=3.843093e+002;
n=9; farx(n+1)=3.710472e+002; foe(n+1)=2.138416e+002; krok(n+1)=2.521242e-002; ng(n+1)=4.686464e+002;
n=10; farx(n+1)=5.755456e+001; foe(n+1)=1.804571e+002; krok(n+1)=4.500546e-001; ng(n+1)=5.047307e+002;
n=11; farx(n+1)=3.006748e+001; foe(n+1)=1.691195e+002; krok(n+1)=1.178924e-002; ng(n+1)=2.007062e+003;
n=12; farx(n+1)=9.434570e+000; foe(n+1)=6.228932e+001; krok(n+1)=1.221144e-001; ng(n+1)=3.160768e+003;
n=13; farx(n+1)=8.185703e+000; foe(n+1)=5.619458e+001; krok(n+1)=3.238984e-001; ng(n+1)=1.134501e+003;
n=14; farx(n+1)=9.827788e+000; foe(n+1)=5.483619e+001; krok(n+1)=8.764941e-002; ng(n+1)=5.471188e+002;
n=15; farx(n+1)=9.815707e+000; foe(n+1)=5.211108e+001; krok(n+1)=4.385923e-001; ng(n+1)=2.351508e+002;
n=16; farx(n+1)=8.490077e+000; foe(n+1)=4.342032e+001; krok(n+1)=7.071111e+000; ng(n+1)=5.074982e+002;
n=17; farx(n+1)=8.058071e+000; foe(n+1)=3.949124e+001; krok(n+1)=2.357265e-001; ng(n+1)=5.039979e+002;
n=18; farx(n+1)=5.878574e+000; foe(n+1)=3.442203e+001; krok(n+1)=8.823184e-001; ng(n+1)=4.163817e+002;
n=19; farx(n+1)=3.519154e+000; foe(n+1)=2.778207e+001; krok(n+1)=1.727068e+000; ng(n+1)=3.474826e+002;
n=20; farx(n+1)=3.378174e+000; foe(n+1)=2.458562e+001; krok(n+1)=3.780408e-001; ng(n+1)=7.070536e+002;
n=21; farx(n+1)=3.033315e+000; foe(n+1)=2.182059e+001; krok(n+1)=1.131462e+000; ng(n+1)=9.414626e+002;
n=22; farx(n+1)=2.247798e+000; foe(n+1)=1.926449e+001; krok(n+1)=1.002885e+000; ng(n+1)=3.214405e+002;
n=23; farx(n+1)=2.093556e+000; foe(n+1)=1.751789e+001; krok(n+1)=3.923690e-001; ng(n+1)=3.256821e+002;
n=24; farx(n+1)=1.879433e+000; foe(n+1)=1.678627e+001; krok(n+1)=9.397835e-001; ng(n+1)=4.636991e+002;
n=25; farx(n+1)=1.803226e+000; foe(n+1)=1.646920e+001; krok(n+1)=6.477968e-001; ng(n+1)=3.477589e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.786089e+000; foe(n+1)=1.643655e+001; krok(n+1)=1.113124e-005; ng(n+1)=1.282721e+002;
n=27; farx(n+1)=1.762272e+000; foe(n+1)=1.637367e+001; krok(n+1)=2.382783e-005; ng(n+1)=1.107854e+002;
n=28; farx(n+1)=1.740609e+000; foe(n+1)=1.634977e+001; krok(n+1)=1.374956e-004; ng(n+1)=2.676772e+001;
n=29; farx(n+1)=1.602932e+000; foe(n+1)=1.604088e+001; krok(n+1)=6.718810e-003; ng(n+1)=1.511361e+001;
n=30; farx(n+1)=1.598712e+000; foe(n+1)=1.577087e+001; krok(n+1)=5.770731e-003; ng(n+1)=1.698542e+002;
n=31; farx(n+1)=1.511368e+000; foe(n+1)=1.565964e+001; krok(n+1)=2.025137e-002; ng(n+1)=4.223986e+002;
n=32; farx(n+1)=1.737965e+000; foe(n+1)=1.550336e+001; krok(n+1)=7.815941e-002; ng(n+1)=4.180211e+002;
n=33; farx(n+1)=1.680271e+000; foe(n+1)=1.527758e+001; krok(n+1)=7.271671e-001; ng(n+1)=3.495242e+002;
n=34; farx(n+1)=1.550816e+000; foe(n+1)=1.496366e+001; krok(n+1)=1.435731e+000; ng(n+1)=1.329770e+002;
n=35; farx(n+1)=1.504285e+000; foe(n+1)=1.486497e+001; krok(n+1)=5.327583e-001; ng(n+1)=1.613641e+002;
n=36; farx(n+1)=1.447035e+000; foe(n+1)=1.477116e+001; krok(n+1)=4.951781e-001; ng(n+1)=2.905138e+002;
n=37; farx(n+1)=1.309630e+000; foe(n+1)=1.462970e+001; krok(n+1)=2.737327e+000; ng(n+1)=8.691113e+001;
n=38; farx(n+1)=1.277474e+000; foe(n+1)=1.459738e+001; krok(n+1)=8.316025e-001; ng(n+1)=1.295612e+002;
n=39; farx(n+1)=1.256359e+000; foe(n+1)=1.458614e+001; krok(n+1)=3.091015e-001; ng(n+1)=5.250292e+001;
n=40; farx(n+1)=1.198248e+000; foe(n+1)=1.457315e+001; krok(n+1)=4.641165e-001; ng(n+1)=7.882398e+001;
n=41; farx(n+1)=1.142155e+000; foe(n+1)=1.455829e+001; krok(n+1)=1.017241e+000; ng(n+1)=5.121248e+001;
n=42; farx(n+1)=1.155118e+000; foe(n+1)=1.454832e+001; krok(n+1)=1.080691e+000; ng(n+1)=6.498416e+001;
n=43; farx(n+1)=1.112783e+000; foe(n+1)=1.453750e+001; krok(n+1)=1.047159e+000; ng(n+1)=1.283700e+001;
n=44; farx(n+1)=1.067509e+000; foe(n+1)=1.453209e+001; krok(n+1)=9.205345e-001; ng(n+1)=4.589690e+001;
n=45; farx(n+1)=1.079665e+000; foe(n+1)=1.452902e+001; krok(n+1)=9.282331e-001; ng(n+1)=3.267653e+001;
n=46; farx(n+1)=1.071666e+000; foe(n+1)=1.452696e+001; krok(n+1)=7.545111e-001; ng(n+1)=9.220804e+000;
n=47; farx(n+1)=1.050654e+000; foe(n+1)=1.452605e+001; krok(n+1)=5.360036e-001; ng(n+1)=1.245197e+001;
n=48; farx(n+1)=1.003764e+000; foe(n+1)=1.452373e+001; krok(n+1)=2.886327e+000; ng(n+1)=1.863110e+001;
n=49; farx(n+1)=9.876276e-001; foe(n+1)=1.452268e+001; krok(n+1)=9.110982e-001; ng(n+1)=2.430355e+001;
n=50; farx(n+1)=9.841656e-001; foe(n+1)=1.452253e+001; krok(n+1)=9.961132e-001; ng(n+1)=1.048303e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=9.842838e-001; foe(n+1)=1.452245e+001; krok(n+1)=1.749314e-006; ng(n+1)=1.649098e+001;
n=52; farx(n+1)=9.842298e-001; foe(n+1)=1.452242e+001; krok(n+1)=1.148266e-005; ng(n+1)=3.832329e+000;
n=53; farx(n+1)=9.846301e-001; foe(n+1)=1.452240e+001; krok(n+1)=1.186196e-004; ng(n+1)=8.137753e-001;
n=54; farx(n+1)=9.859257e-001; foe(n+1)=1.452204e+001; krok(n+1)=8.616391e-004; ng(n+1)=1.573093e+000;
n=55; farx(n+1)=9.815359e-001; foe(n+1)=1.452194e+001; krok(n+1)=2.925850e-002; ng(n+1)=1.233129e-001;
n=56; farx(n+1)=9.853529e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.812841e-002; ng(n+1)=5.619738e-001;
n=57; farx(n+1)=9.841462e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.112329e-001; ng(n+1)=1.154799e+000;
n=58; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.248131e+000; ng(n+1)=1.940385e-001;
n=59; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.422827e-005; ng(n+1)=4.870207e-003;
n=60; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.069939e-005; ng(n+1)=4.870138e-003;
n=61; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.171397e-006; ng(n+1)=4.870086e-003;
n=62; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.090552e-005; ng(n+1)=4.870056e-003;
n=63; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.151540e-005; ng(n+1)=4.870003e-003;
n=64; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.452764e-006; ng(n+1)=4.869898e-003;
n=65; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.204914e-006; ng(n+1)=4.869867e-003;
n=66; farx(n+1)=9.839948e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.390184e-005; ng(n+1)=4.869832e-003;
n=67; farx(n+1)=9.839942e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.008243e+000; ng(n+1)=4.869715e-003;
n=68; farx(n+1)=9.839942e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.061240e-005; ng(n+1)=4.034453e-005;
n=69; farx(n+1)=9.839942e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.680493e-008; ng(n+1)=4.034410e-005;
n=70; farx(n+1)=9.839942e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.760512e-009; ng(n+1)=4.034409e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
