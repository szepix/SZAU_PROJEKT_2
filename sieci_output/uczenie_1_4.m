%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.567551e+002; foe(n+1)=6.568803e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.112211e+002; foe(n+1)=6.113620e+002; krok(n+1)=5.148205e-004; ng(n+1)=3.799515e+002;
n=2; farx(n+1)=2.009722e+002; foe(n+1)=2.018218e+002; krok(n+1)=1.771116e-002; ng(n+1)=1.133838e+002;
n=3; farx(n+1)=1.954705e+002; foe(n+1)=1.975833e+002; krok(n+1)=7.624904e-004; ng(n+1)=2.336023e+002;
n=4; farx(n+1)=2.082950e+002; foe(n+1)=1.909704e+002; krok(n+1)=1.621660e-002; ng(n+1)=2.215577e+002;
n=5; farx(n+1)=1.954427e+002; foe(n+1)=1.888223e+002; krok(n+1)=4.795168e-003; ng(n+1)=1.219239e+002;
n=6; farx(n+1)=1.970823e+002; foe(n+1)=1.777145e+002; krok(n+1)=1.607991e-001; ng(n+1)=1.854764e+002;
n=7; farx(n+1)=1.913923e+002; foe(n+1)=1.763233e+002; krok(n+1)=4.486659e-002; ng(n+1)=1.625455e+002;
n=8; farx(n+1)=3.389279e+001; foe(n+1)=1.198352e+002; krok(n+1)=5.798395e-001; ng(n+1)=1.825557e+002;
n=9; farx(n+1)=3.358325e+001; foe(n+1)=1.196660e+002; krok(n+1)=2.129131e-003; ng(n+1)=6.169451e+002;
n=10; farx(n+1)=3.733801e+001; foe(n+1)=1.147241e+002; krok(n+1)=2.032965e-001; ng(n+1)=5.627399e+002;
n=11; farx(n+1)=4.298362e+001; foe(n+1)=1.033556e+002; krok(n+1)=4.572701e-001; ng(n+1)=4.442259e+002;
n=12; farx(n+1)=3.999642e+001; foe(n+1)=1.002379e+002; krok(n+1)=1.827549e-001; ng(n+1)=1.210469e+002;
n=13; farx(n+1)=2.906541e+001; foe(n+1)=8.679364e+001; krok(n+1)=5.216257e-001; ng(n+1)=7.576745e+002;
n=14; farx(n+1)=1.681432e+001; foe(n+1)=5.812013e+001; krok(n+1)=1.601794e-001; ng(n+1)=4.332922e+002;
n=15; farx(n+1)=1.608414e+001; foe(n+1)=5.712406e+001; krok(n+1)=2.522670e-001; ng(n+1)=5.834823e+002;
n=16; farx(n+1)=1.647895e+001; foe(n+1)=5.510204e+001; krok(n+1)=4.635137e-001; ng(n+1)=9.049563e+002;
n=17; farx(n+1)=1.591458e+001; foe(n+1)=4.987511e+001; krok(n+1)=3.881773e-001; ng(n+1)=4.676733e+002;
n=18; farx(n+1)=1.355137e+001; foe(n+1)=4.627034e+001; krok(n+1)=1.322970e+000; ng(n+1)=2.101165e+002;
n=19; farx(n+1)=1.040326e+001; foe(n+1)=4.187069e+001; krok(n+1)=1.104103e+000; ng(n+1)=4.569287e+002;
n=20; farx(n+1)=8.519484e+000; foe(n+1)=3.724024e+001; krok(n+1)=1.021678e+000; ng(n+1)=5.933642e+002;
n=21; farx(n+1)=6.971587e+000; foe(n+1)=3.337371e+001; krok(n+1)=1.068708e+000; ng(n+1)=1.448986e+002;
n=22; farx(n+1)=5.814221e+000; foe(n+1)=3.078530e+001; krok(n+1)=4.980566e-001; ng(n+1)=3.122880e+002;
n=23; farx(n+1)=5.557026e+000; foe(n+1)=2.760891e+001; krok(n+1)=4.544515e-001; ng(n+1)=1.057186e+003;
n=24; farx(n+1)=4.983899e+000; foe(n+1)=2.558472e+001; krok(n+1)=4.065930e-001; ng(n+1)=5.158703e+002;
n=25; farx(n+1)=3.628339e+000; foe(n+1)=2.172722e+001; krok(n+1)=9.957442e-001; ng(n+1)=1.702921e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.555984e+000; foe(n+1)=2.144198e+001; krok(n+1)=6.790329e-006; ng(n+1)=5.060953e+002;
n=27; farx(n+1)=3.391168e+000; foe(n+1)=2.109362e+001; krok(n+1)=5.720244e-005; ng(n+1)=1.952191e+002;
n=28; farx(n+1)=3.356705e+000; foe(n+1)=2.069491e+001; krok(n+1)=9.268097e-004; ng(n+1)=4.831982e+001;
n=29; farx(n+1)=3.030268e+000; foe(n+1)=1.943790e+001; krok(n+1)=6.552053e-004; ng(n+1)=1.006258e+002;
n=30; farx(n+1)=3.185667e+000; foe(n+1)=1.896252e+001; krok(n+1)=5.119766e-003; ng(n+1)=4.389920e+002;
n=31; farx(n+1)=2.343407e+000; foe(n+1)=1.835144e+001; krok(n+1)=1.113003e-001; ng(n+1)=6.482439e+002;
n=32; farx(n+1)=2.376853e+000; foe(n+1)=1.820059e+001; krok(n+1)=6.205612e-002; ng(n+1)=6.730891e+002;
n=33; farx(n+1)=2.167601e+000; foe(n+1)=1.736866e+001; krok(n+1)=5.872046e-001; ng(n+1)=5.716204e+002;
n=34; farx(n+1)=1.793216e+000; foe(n+1)=1.646987e+001; krok(n+1)=8.771846e-001; ng(n+1)=1.705036e+002;
n=35; farx(n+1)=1.734893e+000; foe(n+1)=1.591360e+001; krok(n+1)=9.372047e-001; ng(n+1)=3.395545e+002;
n=36; farx(n+1)=1.738407e+000; foe(n+1)=1.554089e+001; krok(n+1)=4.635137e-001; ng(n+1)=5.168536e+002;
n=37; farx(n+1)=1.691660e+000; foe(n+1)=1.518064e+001; krok(n+1)=1.044632e+000; ng(n+1)=7.737797e+001;
n=38; farx(n+1)=1.569773e+000; foe(n+1)=1.502911e+001; krok(n+1)=4.788369e-001; ng(n+1)=1.677812e+002;
n=39; farx(n+1)=1.416836e+000; foe(n+1)=1.490479e+001; krok(n+1)=8.612093e-001; ng(n+1)=2.996823e+002;
n=40; farx(n+1)=1.345325e+000; foe(n+1)=1.480052e+001; krok(n+1)=5.166865e-001; ng(n+1)=6.828294e+001;
n=41; farx(n+1)=1.466464e+000; foe(n+1)=1.472521e+001; krok(n+1)=6.145657e-001; ng(n+1)=9.789086e+001;
n=42; farx(n+1)=1.345000e+000; foe(n+1)=1.466870e+001; krok(n+1)=1.769355e+000; ng(n+1)=9.462630e+001;
n=43; farx(n+1)=1.279016e+000; foe(n+1)=1.463029e+001; krok(n+1)=4.884576e-001; ng(n+1)=4.295582e+001;
n=44; farx(n+1)=1.285657e+000; foe(n+1)=1.461612e+001; krok(n+1)=5.631821e-001; ng(n+1)=9.226464e+001;
n=45; farx(n+1)=1.265011e+000; foe(n+1)=1.459849e+001; krok(n+1)=1.535939e+000; ng(n+1)=6.644470e+001;
n=46; farx(n+1)=1.263106e+000; foe(n+1)=1.458716e+001; krok(n+1)=6.322648e-001; ng(n+1)=4.980012e+001;
n=47; farx(n+1)=1.174221e+000; foe(n+1)=1.457340e+001; krok(n+1)=1.250289e+000; ng(n+1)=3.416292e+001;
n=48; farx(n+1)=1.130551e+000; foe(n+1)=1.456692e+001; krok(n+1)=1.420334e+000; ng(n+1)=2.958425e+001;
n=49; farx(n+1)=1.109322e+000; foe(n+1)=1.455357e+001; krok(n+1)=1.710369e+000; ng(n+1)=7.702150e+001;
n=50; farx(n+1)=1.101948e+000; foe(n+1)=1.454945e+001; krok(n+1)=3.743784e-001; ng(n+1)=3.379013e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.102336e+000; foe(n+1)=1.454833e+001; krok(n+1)=2.080520e-006; ng(n+1)=5.532261e+001;
n=52; farx(n+1)=1.102295e+000; foe(n+1)=1.454776e+001; krok(n+1)=1.524497e-005; ng(n+1)=1.319725e+001;
n=53; farx(n+1)=1.105455e+000; foe(n+1)=1.454667e+001; krok(n+1)=1.480290e-004; ng(n+1)=5.397613e+000;
n=54; farx(n+1)=1.110087e+000; foe(n+1)=1.453134e+001; krok(n+1)=7.315478e-004; ng(n+1)=1.100194e+001;
n=55; farx(n+1)=1.076021e+000; foe(n+1)=1.452886e+001; krok(n+1)=1.791379e-002; ng(n+1)=1.498168e+000;
n=56; farx(n+1)=1.082656e+000; foe(n+1)=1.452736e+001; krok(n+1)=7.602301e-002; ng(n+1)=5.935129e+000;
n=57; farx(n+1)=1.038213e+000; foe(n+1)=1.452436e+001; krok(n+1)=2.869393e-001; ng(n+1)=1.562364e+001;
n=58; farx(n+1)=1.007045e+000; foe(n+1)=1.452270e+001; krok(n+1)=1.657803e+000; ng(n+1)=3.554172e+001;
n=59; farx(n+1)=1.005416e+000; foe(n+1)=1.452223e+001; krok(n+1)=8.193164e-001; ng(n+1)=1.428686e+001;
n=60; farx(n+1)=9.907949e-001; foe(n+1)=1.452196e+001; krok(n+1)=1.142810e+000; ng(n+1)=8.566831e+000;
n=61; farx(n+1)=9.845097e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.778590e+000; ng(n+1)=3.421453e+000;
n=62; farx(n+1)=9.843507e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.029948e-001; ng(n+1)=3.651959e+000;
n=63; farx(n+1)=9.839373e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.926233e-001; ng(n+1)=3.602532e-001;
n=64; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.096257e+000; ng(n+1)=3.749527e-002;
n=65; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.279756e-005; ng(n+1)=9.497975e-003;
n=66; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.952471e-006; ng(n+1)=9.497601e-003;
n=67; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.779509e-005; ng(n+1)=9.497506e-003;
n=68; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.306250e-004; ng(n+1)=9.497337e-003;
n=69; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.069939e-005; ng(n+1)=9.496097e-003;
n=70; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.386340e-007; ng(n+1)=9.495995e-003;
n=71; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.324083e-005; ng(n+1)=9.495992e-003;
n=72; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.080134e-005; ng(n+1)=9.495677e-003;
n=73; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.612390e-005; ng(n+1)=9.495574e-003;
n=74; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.728198e-011; ng(n+1)=9.495326e-003;
n=75; farx(n+1)=9.839863e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.022416e-005; ng(n+1)=9.495326e-003;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839861e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.791879e-006; ng(n+1)=1.181937e-002;
n=77; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.209447e-005; ng(n+1)=3.830454e-003;
n=78; farx(n+1)=9.839864e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.881966e-005; ng(n+1)=9.756004e-004;
n=79; farx(n+1)=9.839848e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.790165e-003; ng(n+1)=2.883751e-004;
n=80; farx(n+1)=9.839820e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.612384e-002; ng(n+1)=1.939088e-004;
n=81; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.978790e-002; ng(n+1)=1.597676e-004;
n=82; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.069939e-005; ng(n+1)=1.540660e-004;
n=83; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.210449e-005; ng(n+1)=1.540641e-004;
n=84; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.613405e-008; ng(n+1)=1.540623e-004;
n=85; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.084137e-006; ng(n+1)=1.540623e-004;
n=86; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.270239e-009; ng(n+1)=1.540621e-004;
n=87; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.784319e-006; ng(n+1)=1.540621e-004;
n=88; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.416371e-005; ng(n+1)=1.540611e-004;
n=89; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.746916e-005; ng(n+1)=1.540593e-004;
n=90; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.945120e-005; ng(n+1)=1.540551e-004;
n=91; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.363812e-011; ng(n+1)=1.540505e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=92; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.051019e-009; ng(n+1)=1.540505e-004;
n=93; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.193880e-007; ng(n+1)=1.540072e-004;
n=94; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.318593e-005; ng(n+1)=1.488243e-004;
n=95; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.204914e-006; ng(n+1)=1.487206e-004;
n=96; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.107983e-006; ng(n+1)=1.487199e-004;
n=97; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.611240e-005; ng(n+1)=1.486716e-004;
n=98; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.018607e-006; ng(n+1)=1.486661e-004;
n=99; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.135831e-006; ng(n+1)=1.486599e-004;
n=100; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.450277e-008; ng(n+1)=1.486591e-004;
%odnowa zmiennej metryki
n=101; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.823256e-013; ng(n+1)=1.486591e-004;
n=102; farx(n+1)=9.839846e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.234836e-012; ng(n+1)=1.486591e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
