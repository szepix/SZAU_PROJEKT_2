%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.591019e+002; foe(n+1)=6.603530e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.160524e+002; foe(n+1)=6.169436e+002; krok(n+1)=5.047515e-004; ng(n+1)=3.617038e+002;
n=2; farx(n+1)=6.155745e+002; foe(n+1)=6.159010e+002; krok(n+1)=1.599574e-003; ng(n+1)=4.630512e+001;
n=3; farx(n+1)=1.844235e+002; foe(n+1)=1.866271e+002; krok(n+1)=6.486637e-002; ng(n+1)=2.835952e+001;
n=4; farx(n+1)=1.823511e+002; foe(n+1)=1.862030e+002; krok(n+1)=8.446781e-004; ng(n+1)=7.382352e+001;
n=5; farx(n+1)=1.840742e+002; foe(n+1)=1.858019e+002; krok(n+1)=1.706649e-002; ng(n+1)=9.285334e+001;
n=6; farx(n+1)=1.314678e+002; foe(n+1)=1.553821e+002; krok(n+1)=2.549299e-001; ng(n+1)=1.074782e+002;
n=7; farx(n+1)=7.107224e+001; foe(n+1)=1.365775e+002; krok(n+1)=2.143812e-001; ng(n+1)=1.074553e+002;
n=8; farx(n+1)=7.024648e+001; foe(n+1)=1.281661e+002; krok(n+1)=3.404866e-001; ng(n+1)=2.570078e+002;
n=9; farx(n+1)=6.719215e+001; foe(n+1)=1.253668e+002; krok(n+1)=1.251552e-001; ng(n+1)=3.157637e+002;
n=10; farx(n+1)=4.939009e+001; foe(n+1)=1.112398e+002; krok(n+1)=7.011953e-001; ng(n+1)=1.495219e+002;
n=11; farx(n+1)=4.926729e+001; foe(n+1)=1.111175e+002; krok(n+1)=2.021443e-003; ng(n+1)=9.664368e+001;
n=12; farx(n+1)=3.762525e+001; foe(n+1)=9.968623e+001; krok(n+1)=8.212251e-001; ng(n+1)=1.253433e+002;
n=13; farx(n+1)=2.442883e+001; foe(n+1)=7.165491e+001; krok(n+1)=3.042461e-002; ng(n+1)=7.296799e+002;
n=14; farx(n+1)=2.237219e+001; foe(n+1)=6.514914e+001; krok(n+1)=2.946134e-001; ng(n+1)=7.129179e+002;
n=15; farx(n+1)=2.081238e+001; foe(n+1)=6.098518e+001; krok(n+1)=8.268560e-002; ng(n+1)=9.327760e+002;
n=16; farx(n+1)=1.774253e+001; foe(n+1)=5.415511e+001; krok(n+1)=8.377184e-001; ng(n+1)=3.337581e+002;
n=17; farx(n+1)=1.612735e+001; foe(n+1)=5.190757e+001; krok(n+1)=2.093785e-001; ng(n+1)=3.132747e+002;
n=18; farx(n+1)=1.187330e+001; foe(n+1)=4.129499e+001; krok(n+1)=1.258151e+000; ng(n+1)=2.040616e+002;
n=19; farx(n+1)=7.894580e+000; foe(n+1)=3.456123e+001; krok(n+1)=7.610808e-001; ng(n+1)=7.390865e+002;
n=20; farx(n+1)=6.488422e+000; foe(n+1)=3.204768e+001; krok(n+1)=1.914311e-001; ng(n+1)=8.906012e+002;
n=21; farx(n+1)=6.463002e+000; foe(n+1)=3.119749e+001; krok(n+1)=2.577175e-001; ng(n+1)=3.121451e+002;
n=22; farx(n+1)=5.890905e+000; foe(n+1)=2.982362e+001; krok(n+1)=8.295027e-001; ng(n+1)=1.200508e+002;
n=23; farx(n+1)=5.541715e+000; foe(n+1)=2.770476e+001; krok(n+1)=6.321212e-001; ng(n+1)=4.021352e+002;
n=24; farx(n+1)=4.934592e+000; foe(n+1)=2.656494e+001; krok(n+1)=3.238984e-001; ng(n+1)=2.105580e+002;
n=25; farx(n+1)=3.693389e+000; foe(n+1)=2.469206e+001; krok(n+1)=9.001093e-001; ng(n+1)=5.227465e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.636954e+000; foe(n+1)=2.454255e+001; krok(n+1)=5.005977e-006; ng(n+1)=3.824496e+002;
n=27; farx(n+1)=3.501567e+000; foe(n+1)=2.417009e+001; krok(n+1)=1.120667e-004; ng(n+1)=1.288742e+002;
n=28; farx(n+1)=3.494112e+000; foe(n+1)=2.366141e+001; krok(n+1)=2.224690e-004; ng(n+1)=1.135536e+002;
n=29; farx(n+1)=2.709240e+000; foe(n+1)=2.103885e+001; krok(n+1)=6.791933e-004; ng(n+1)=1.468862e+002;
n=30; farx(n+1)=2.815880e+000; foe(n+1)=2.079314e+001; krok(n+1)=7.342058e-003; ng(n+1)=6.209876e+002;
n=31; farx(n+1)=3.055770e+000; foe(n+1)=1.938938e+001; krok(n+1)=8.268560e-002; ng(n+1)=9.462427e+002;
n=32; farx(n+1)=2.474066e+000; foe(n+1)=1.908268e+001; krok(n+1)=1.328156e-001; ng(n+1)=5.989100e+002;
n=33; farx(n+1)=1.621982e+000; foe(n+1)=1.720764e+001; krok(n+1)=4.345151e+000; ng(n+1)=6.443041e+002;
n=34; farx(n+1)=2.118866e+000; foe(n+1)=1.635807e+001; krok(n+1)=7.238398e-001; ng(n+1)=3.019032e+002;
n=35; farx(n+1)=2.007630e+000; foe(n+1)=1.591390e+001; krok(n+1)=7.461831e-001; ng(n+1)=1.899403e+002;
n=36; farx(n+1)=1.861494e+000; foe(n+1)=1.561315e+001; krok(n+1)=2.960535e-001; ng(n+1)=8.530210e+001;
n=37; farx(n+1)=1.701395e+000; foe(n+1)=1.545836e+001; krok(n+1)=5.570755e-001; ng(n+1)=5.939238e+001;
n=38; farx(n+1)=1.519364e+000; foe(n+1)=1.530707e+001; krok(n+1)=3.457398e-001; ng(n+1)=2.798513e+002;
n=39; farx(n+1)=1.422888e+000; foe(n+1)=1.505510e+001; krok(n+1)=1.197939e+000; ng(n+1)=1.517377e+002;
n=40; farx(n+1)=1.488574e+000; foe(n+1)=1.491058e+001; krok(n+1)=8.674420e-001; ng(n+1)=1.544542e+002;
n=41; farx(n+1)=1.559194e+000; foe(n+1)=1.483195e+001; krok(n+1)=4.980566e-001; ng(n+1)=2.580677e+002;
n=42; farx(n+1)=1.390671e+000; foe(n+1)=1.473046e+001; krok(n+1)=1.476581e+000; ng(n+1)=7.121732e+001;
n=43; farx(n+1)=1.313049e+000; foe(n+1)=1.468059e+001; krok(n+1)=8.008859e-001; ng(n+1)=1.079207e+002;
n=44; farx(n+1)=1.310949e+000; foe(n+1)=1.463142e+001; krok(n+1)=1.476581e+000; ng(n+1)=4.375750e+001;
n=45; farx(n+1)=1.301741e+000; foe(n+1)=1.461716e+001; krok(n+1)=6.063266e-001; ng(n+1)=6.619714e+001;
n=46; farx(n+1)=1.241332e+000; foe(n+1)=1.459719e+001; krok(n+1)=1.001473e+000; ng(n+1)=9.409669e+001;
n=47; farx(n+1)=1.182753e+000; foe(n+1)=1.457748e+001; krok(n+1)=1.009068e+000; ng(n+1)=5.945744e+001;
n=48; farx(n+1)=1.128059e+000; foe(n+1)=1.456759e+001; krok(n+1)=8.179879e-001; ng(n+1)=4.185216e+001;
n=49; farx(n+1)=1.110996e+000; foe(n+1)=1.455974e+001; krok(n+1)=4.128102e-001; ng(n+1)=4.907906e+001;
n=50; farx(n+1)=1.091851e+000; foe(n+1)=1.455087e+001; krok(n+1)=9.180501e-001; ng(n+1)=1.039178e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.092513e+000; foe(n+1)=1.454731e+001; krok(n+1)=2.136506e-006; ng(n+1)=7.232365e+001;
n=52; farx(n+1)=1.092074e+000; foe(n+1)=1.454516e+001; krok(n+1)=1.438760e-005; ng(n+1)=2.538171e+001;
n=53; farx(n+1)=1.089714e+000; foe(n+1)=1.454432e+001; krok(n+1)=4.614756e-005; ng(n+1)=8.931740e+000;
n=54; farx(n+1)=1.100061e+000; foe(n+1)=1.452974e+001; krok(n+1)=2.397584e-003; ng(n+1)=5.415122e+000;
n=55; farx(n+1)=1.076188e+000; foe(n+1)=1.452849e+001; krok(n+1)=2.067140e-002; ng(n+1)=9.856100e-001;
n=56; farx(n+1)=1.081708e+000; foe(n+1)=1.452718e+001; krok(n+1)=8.100548e-002; ng(n+1)=4.489604e+000;
n=57; farx(n+1)=1.036362e+000; foe(n+1)=1.452432e+001; krok(n+1)=2.594656e-001; ng(n+1)=1.052857e+001;
n=58; farx(n+1)=1.007527e+000; foe(n+1)=1.452273e+001; krok(n+1)=1.499788e+000; ng(n+1)=3.529111e+001;
n=59; farx(n+1)=1.005979e+000; foe(n+1)=1.452224e+001; krok(n+1)=8.088973e-001; ng(n+1)=1.409986e+001;
n=60; farx(n+1)=9.910104e-001; foe(n+1)=1.452196e+001; krok(n+1)=1.119298e+000; ng(n+1)=7.969192e+000;
n=61; farx(n+1)=9.846568e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.707324e+000; ng(n+1)=2.863172e+000;
n=62; farx(n+1)=9.844388e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.413217e-001; ng(n+1)=4.185670e+000;
n=63; farx(n+1)=9.839391e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.131859e-001; ng(n+1)=3.997469e-001;
n=64; farx(n+1)=9.839831e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.091740e+000; ng(n+1)=3.323185e-002;
n=65; farx(n+1)=9.839831e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.055995e-009; ng(n+1)=1.105355e-002;
n=66; farx(n+1)=9.839831e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.424686e-005; ng(n+1)=1.105355e-002;
n=67; farx(n+1)=9.839831e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.209447e-005; ng(n+1)=1.105324e-002;
n=68; farx(n+1)=9.839831e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.314101e-005; ng(n+1)=1.105310e-002;
n=69; farx(n+1)=9.839831e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.171397e-006; ng(n+1)=1.105295e-002;
n=70; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.019823e+000; ng(n+1)=1.105288e-002;
n=71; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.098436e-005; ng(n+1)=1.262700e-003;
n=72; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.443034e-009; ng(n+1)=1.262699e-003;
n=73; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.478237e-009; ng(n+1)=1.262698e-003;
n=74; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.273013e-006; ng(n+1)=1.262698e-003;
n=75; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.718817e-008; ng(n+1)=1.262695e-003;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.804198e-006; ng(n+1)=1.262695e-003;
n=77; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.960744e-006; ng(n+1)=5.013157e-004;
n=78; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.896326e-005; ng(n+1)=1.356950e-004;
n=79; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.127653e-009; ng(n+1)=7.232423e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=80; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.360285e-005; ng(n+1)=7.232418e-005;
n=81; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.662987e-006; ng(n+1)=7.623342e-005;
n=82; farx(n+1)=9.839844e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.170387e-004; ng(n+1)=1.113964e-004;
n=83; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.579503e-005; ng(n+1)=2.833317e-004;
n=84; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.511561e-006; ng(n+1)=7.592868e-005;
n=85; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.576430e-012; ng(n+1)=7.592502e-005;
n=86; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.777116e-007; ng(n+1)=7.592502e-005;
n=87; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.694130e-005; ng(n+1)=7.592474e-005;
n=88; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.086051e-006; ng(n+1)=7.593341e-005;
n=89; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.186761e-009; ng(n+1)=7.593160e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=90; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.575152e-006; ng(n+1)=7.593160e-005;
n=91; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.193880e-007; ng(n+1)=5.734085e-005;
n=92; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.016539e-010; ng(n+1)=4.878999e-005;
n=93; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.539303e-012; ng(n+1)=4.879001e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=94; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.408407e-011; ng(n+1)=4.879001e-005;
n=95; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.418899e-012; ng(n+1)=4.878994e-005;
n=96; farx(n+1)=9.839845e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.654029e-011; ng(n+1)=4.878995e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
