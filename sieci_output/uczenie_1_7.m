%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.131575e+002; foe(n+1)=6.222225e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.037608e+002; foe(n+1)=6.127157e+002; krok(n+1)=6.011432e-004; ng(n+1)=1.990207e+002;
n=2; farx(n+1)=2.023707e+002; foe(n+1)=2.132563e+002; krok(n+1)=1.935565e-002; ng(n+1)=1.308230e+002;
n=3; farx(n+1)=1.943458e+002; foe(n+1)=1.976069e+002; krok(n+1)=2.983603e-003; ng(n+1)=4.178075e+002;
n=4; farx(n+1)=1.906264e+002; foe(n+1)=1.899188e+002; krok(n+1)=2.201622e-003; ng(n+1)=3.366076e+002;
n=5; farx(n+1)=1.687067e+002; foe(n+1)=1.860792e+002; krok(n+1)=8.331886e-002; ng(n+1)=2.185626e+002;
n=6; farx(n+1)=1.853975e+002; foe(n+1)=1.742342e+002; krok(n+1)=1.613460e-001; ng(n+1)=2.974537e+002;
n=7; farx(n+1)=1.804143e+002; foe(n+1)=1.731002e+002; krok(n+1)=6.721749e-002; ng(n+1)=1.660294e+002;
n=8; farx(n+1)=1.264498e+002; foe(n+1)=1.571873e+002; krok(n+1)=2.292046e-001; ng(n+1)=1.743292e+002;
n=9; farx(n+1)=6.078352e+001; foe(n+1)=1.384215e+002; krok(n+1)=1.189808e+000; ng(n+1)=5.611354e+001;
n=10; farx(n+1)=5.855776e+001; foe(n+1)=1.380402e+002; krok(n+1)=1.142380e-002; ng(n+1)=3.793722e+002;
n=11; farx(n+1)=1.990557e+001; foe(n+1)=8.920659e+001; krok(n+1)=1.062344e+000; ng(n+1)=4.701350e+002;
n=12; farx(n+1)=1.979200e+001; foe(n+1)=8.910606e+001; krok(n+1)=4.848544e-004; ng(n+1)=1.338060e+003;
n=13; farx(n+1)=1.496667e+001; foe(n+1)=7.361935e+001; krok(n+1)=4.320574e-002; ng(n+1)=1.106177e+003;
n=14; farx(n+1)=1.601929e+001; foe(n+1)=6.034334e+001; krok(n+1)=1.489153e-001; ng(n+1)=3.666096e+003;
n=15; farx(n+1)=1.388731e+001; foe(n+1)=4.896294e+001; krok(n+1)=7.571530e-001; ng(n+1)=3.380549e+002;
n=16; farx(n+1)=1.142530e+001; foe(n+1)=4.649097e+001; krok(n+1)=1.086288e+000; ng(n+1)=2.126190e+002;
n=17; farx(n+1)=9.512046e+000; foe(n+1)=4.124630e+001; krok(n+1)=2.730900e-001; ng(n+1)=4.490126e+002;
n=18; farx(n+1)=9.117839e+000; foe(n+1)=3.789965e+001; krok(n+1)=1.591497e+000; ng(n+1)=4.751560e+002;
n=19; farx(n+1)=7.354908e+000; foe(n+1)=3.512983e+001; krok(n+1)=2.096860e+000; ng(n+1)=5.131286e+002;
n=20; farx(n+1)=6.530116e+000; foe(n+1)=3.236227e+001; krok(n+1)=1.044632e+000; ng(n+1)=8.811920e+001;
n=21; farx(n+1)=6.502375e+000; foe(n+1)=3.170925e+001; krok(n+1)=2.577175e-001; ng(n+1)=2.488250e+002;
n=22; farx(n+1)=6.337211e+000; foe(n+1)=3.062304e+001; krok(n+1)=1.321671e+000; ng(n+1)=3.198585e+002;
n=23; farx(n+1)=6.008667e+000; foe(n+1)=2.965924e+001; krok(n+1)=7.113726e-001; ng(n+1)=1.529057e+002;
n=24; farx(n+1)=6.037612e+000; foe(n+1)=2.913841e+001; krok(n+1)=7.101669e-001; ng(n+1)=4.273924e+002;
n=25; farx(n+1)=6.063567e+000; foe(n+1)=2.897392e+001; krok(n+1)=8.885059e-001; ng(n+1)=4.442418e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.913398e+000; foe(n+1)=2.874593e+001; krok(n+1)=1.083629e-005; ng(n+1)=2.890786e+002;
n=27; farx(n+1)=5.254626e+000; foe(n+1)=2.776854e+001; krok(n+1)=2.439194e-004; ng(n+1)=1.300113e+002;
n=28; farx(n+1)=4.622389e+000; foe(n+1)=2.609552e+001; krok(n+1)=3.028161e-004; ng(n+1)=1.814900e+002;
n=29; farx(n+1)=3.640311e+000; foe(n+1)=2.337507e+001; krok(n+1)=5.034661e-004; ng(n+1)=2.078411e+002;
n=30; farx(n+1)=3.601132e+000; foe(n+1)=2.330263e+001; krok(n+1)=6.072741e-003; ng(n+1)=6.868964e+002;
n=31; farx(n+1)=3.469211e+000; foe(n+1)=2.314961e+001; krok(n+1)=3.069500e-002; ng(n+1)=5.488771e+002;
n=32; farx(n+1)=2.955769e+000; foe(n+1)=2.212955e+001; krok(n+1)=3.825314e-001; ng(n+1)=7.626896e+002;
n=33; farx(n+1)=3.129491e+000; foe(n+1)=2.113683e+001; krok(n+1)=2.230786e-001; ng(n+1)=7.099405e+002;
n=34; farx(n+1)=2.586005e+000; foe(n+1)=1.865505e+001; krok(n+1)=2.137801e+000; ng(n+1)=6.353323e+002;
n=35; farx(n+1)=2.184279e+000; foe(n+1)=1.709124e+001; krok(n+1)=5.770438e-001; ng(n+1)=1.798152e+002;
n=36; farx(n+1)=1.850812e+000; foe(n+1)=1.666469e+001; krok(n+1)=8.727420e-001; ng(n+1)=2.921092e+002;
n=37; farx(n+1)=1.729346e+000; foe(n+1)=1.645860e+001; krok(n+1)=2.114117e-001; ng(n+1)=2.177306e+002;
n=38; farx(n+1)=1.717442e+000; foe(n+1)=1.593719e+001; krok(n+1)=9.876806e-001; ng(n+1)=3.721874e+002;
n=39; farx(n+1)=1.796406e+000; foe(n+1)=1.550011e+001; krok(n+1)=3.465039e-001; ng(n+1)=8.932901e+001;
n=40; farx(n+1)=1.635249e+000; foe(n+1)=1.530993e+001; krok(n+1)=8.922169e-001; ng(n+1)=1.975205e+002;
n=41; farx(n+1)=1.457724e+000; foe(n+1)=1.510792e+001; krok(n+1)=1.071175e+000; ng(n+1)=2.501967e+002;
n=42; farx(n+1)=1.428129e+000; foe(n+1)=1.493021e+001; krok(n+1)=8.295027e-001; ng(n+1)=1.389384e+002;
n=43; farx(n+1)=1.465655e+000; foe(n+1)=1.481204e+001; krok(n+1)=8.658973e-001; ng(n+1)=2.147660e+002;
n=44; farx(n+1)=1.515619e+000; foe(n+1)=1.476021e+001; krok(n+1)=5.824576e-001; ng(n+1)=1.993974e+002;
n=45; farx(n+1)=1.338669e+000; foe(n+1)=1.467061e+001; krok(n+1)=1.382584e+000; ng(n+1)=3.062194e+001;
n=46; farx(n+1)=1.305630e+000; foe(n+1)=1.463774e+001; krok(n+1)=1.829120e+000; ng(n+1)=5.745988e+001;
n=47; farx(n+1)=1.336567e+000; foe(n+1)=1.461894e+001; krok(n+1)=4.386596e-001; ng(n+1)=8.980356e+001;
n=48; farx(n+1)=1.280914e+000; foe(n+1)=1.460134e+001; krok(n+1)=4.992693e-001; ng(n+1)=6.545567e+001;
n=49; farx(n+1)=1.244982e+000; foe(n+1)=1.459556e+001; krok(n+1)=4.641165e-001; ng(n+1)=8.342074e+001;
n=50; farx(n+1)=1.172155e+000; foe(n+1)=1.457625e+001; krok(n+1)=1.295594e+000; ng(n+1)=5.369661e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.171750e+000; foe(n+1)=1.457561e+001; krok(n+1)=2.343927e-006; ng(n+1)=3.192819e+001;
n=52; farx(n+1)=1.168858e+000; foe(n+1)=1.457423e+001; krok(n+1)=1.007837e-004; ng(n+1)=8.199272e+000;
n=53; farx(n+1)=1.170266e+000; foe(n+1)=1.457172e+001; krok(n+1)=1.297027e-004; ng(n+1)=9.289553e+000;
n=54; farx(n+1)=1.187011e+000; foe(n+1)=1.455000e+001; krok(n+1)=1.711903e-004; ng(n+1)=2.490036e+001;
n=55; farx(n+1)=1.153546e+000; foe(n+1)=1.454695e+001; krok(n+1)=4.382471e-002; ng(n+1)=2.754393e+000;
n=56; farx(n+1)=1.169988e+000; foe(n+1)=1.454134e+001; krok(n+1)=7.240442e-002; ng(n+1)=7.064308e+000;
n=57; farx(n+1)=1.111675e+000; foe(n+1)=1.453466e+001; krok(n+1)=1.011122e-001; ng(n+1)=1.734617e+000;
n=58; farx(n+1)=1.063118e+000; foe(n+1)=1.452874e+001; krok(n+1)=1.330664e+000; ng(n+1)=6.417154e+001;
n=59; farx(n+1)=1.052438e+000; foe(n+1)=1.452565e+001; krok(n+1)=9.169512e-001; ng(n+1)=3.381006e+001;
n=60; farx(n+1)=1.021806e+000; foe(n+1)=1.452328e+001; krok(n+1)=1.051310e+000; ng(n+1)=1.824691e+001;
n=61; farx(n+1)=9.954383e-001; foe(n+1)=1.452212e+001; krok(n+1)=2.984733e+000; ng(n+1)=1.197295e+001;
n=62; farx(n+1)=9.937463e-001; foe(n+1)=1.452196e+001; krok(n+1)=4.854776e-001; ng(n+1)=1.965149e+001;
n=63; farx(n+1)=9.858312e-001; foe(n+1)=1.452191e+001; krok(n+1)=6.776371e-001; ng(n+1)=3.552220e+000;
n=64; farx(n+1)=9.840353e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.853052e-001; ng(n+1)=1.119880e+000;
n=65; farx(n+1)=9.838957e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.282331e-001; ng(n+1)=1.416616e+000;
n=66; farx(n+1)=9.839645e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.885059e-001; ng(n+1)=1.880754e-001;
n=67; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.383585e+000; ng(n+1)=4.358049e-002;
n=68; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.860122e-005; ng(n+1)=1.255622e-002;
n=69; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.229892e-005; ng(n+1)=1.255594e-002;
n=70; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.657636e-005; ng(n+1)=1.255515e-002;
n=71; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.410994e-006; ng(n+1)=1.255494e-002;
n=72; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.937881e-007; ng(n+1)=1.255482e-002;
n=73; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.537311e-005; ng(n+1)=1.255481e-002;
n=74; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.523765e-006; ng(n+1)=1.255449e-002;
n=75; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.418144e-006; ng(n+1)=1.255440e-002;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839736e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.705497e-006; ng(n+1)=1.255433e-002;
n=77; farx(n+1)=9.839733e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.984122e-006; ng(n+1)=9.589545e-003;
n=78; farx(n+1)=9.839732e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.705554e-005; ng(n+1)=4.386250e-004;
n=79; farx(n+1)=9.839745e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.505914e-003; ng(n+1)=2.162311e-004;
n=80; farx(n+1)=9.839785e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.237981e-003; ng(n+1)=1.738192e-004;
n=81; farx(n+1)=9.839785e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.600086e-006; ng(n+1)=1.187518e-004;
n=82; farx(n+1)=9.839785e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.190752e-005; ng(n+1)=1.187506e-004;
n=83; farx(n+1)=9.839785e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.867289e-006; ng(n+1)=1.187483e-004;
n=84; farx(n+1)=9.839785e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.036438e-005; ng(n+1)=1.187469e-004;
n=85; farx(n+1)=9.839785e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.044862e-008; ng(n+1)=1.187456e-004;
n=86; farx(n+1)=9.839785e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.200447e-008; ng(n+1)=1.187457e-004;
n=87; farx(n+1)=9.839941e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.036275e-001; ng(n+1)=1.187457e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
