%uczenie predyktora oe
clear all;
n=0; farx(n+1)=9.329005e+002; foe(n+1)=9.367900e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=9.158839e+002; foe(n+1)=9.158309e+002; krok(n+1)=5.704577e-004; ng(n+1)=3.373104e+002;
n=2; farx(n+1)=9.207596e+002; foe(n+1)=9.045360e+002; krok(n+1)=3.918749e-003; ng(n+1)=7.445564e+001;
n=3; farx(n+1)=4.556804e+002; foe(n+1)=4.012984e+002; krok(n+1)=1.651908e-003; ng(n+1)=4.447534e+002;
n=4; farx(n+1)=4.490490e+002; foe(n+1)=3.937378e+002; krok(n+1)=4.498643e-006; ng(n+1)=2.299788e+003;
n=5; farx(n+1)=1.886095e+003; foe(n+1)=3.196709e+002; krok(n+1)=1.838554e-003; ng(n+1)=2.227276e+003;
n=6; farx(n+1)=2.083145e+003; foe(n+1)=3.127856e+002; krok(n+1)=1.786211e-003; ng(n+1)=1.000386e+003;
n=7; farx(n+1)=2.125686e+003; foe(n+1)=3.113970e+002; krok(n+1)=8.336543e-004; ng(n+1)=9.743616e+002;
n=8; farx(n+1)=2.054115e+003; foe(n+1)=3.073645e+002; krok(n+1)=4.785778e-002; ng(n+1)=9.619717e+002;
n=9; farx(n+1)=8.002342e+002; foe(n+1)=2.353306e+002; krok(n+1)=1.048747e+000; ng(n+1)=1.016366e+003;
n=10; farx(n+1)=9.249054e+002; foe(n+1)=2.183731e+002; krok(n+1)=2.238597e+000; ng(n+1)=9.112528e+002;
n=11; farx(n+1)=2.363673e+002; foe(n+1)=1.946407e+002; krok(n+1)=3.365287e+000; ng(n+1)=1.649201e+002;
n=12; farx(n+1)=1.452033e+002; foe(n+1)=1.893216e+002; krok(n+1)=3.450079e-001; ng(n+1)=6.812595e+002;
n=13; farx(n+1)=6.066310e+001; foe(n+1)=1.686252e+002; krok(n+1)=8.088973e-001; ng(n+1)=1.056614e+003;
n=14; farx(n+1)=2.901994e+001; foe(n+1)=1.477544e+002; krok(n+1)=5.520515e-001; ng(n+1)=1.003302e+003;
n=15; farx(n+1)=2.476376e+001; foe(n+1)=1.428768e+002; krok(n+1)=6.778645e-002; ng(n+1)=8.724189e+002;
n=16; farx(n+1)=1.562112e+001; foe(n+1)=1.273958e+002; krok(n+1)=2.020751e-001; ng(n+1)=9.752563e+002;
n=17; farx(n+1)=1.159559e+001; foe(n+1)=1.118831e+002; krok(n+1)=2.936023e-001; ng(n+1)=2.058047e+003;
n=18; farx(n+1)=4.682493e+000; foe(n+1)=3.233889e+001; krok(n+1)=6.656880e-001; ng(n+1)=3.224868e+003;
n=19; farx(n+1)=1.888170e+000; foe(n+1)=1.897318e+001; krok(n+1)=5.642809e-001; ng(n+1)=1.433348e+003;
n=20; farx(n+1)=1.471836e+000; foe(n+1)=1.496427e+001; krok(n+1)=1.015974e-001; ng(n+1)=1.748332e+003;
n=21; farx(n+1)=1.468518e+000; foe(n+1)=1.307852e+001; krok(n+1)=7.655551e-001; ng(n+1)=3.393579e+002;
n=22; farx(n+1)=1.404891e+000; foe(n+1)=1.288354e+001; krok(n+1)=6.268073e-001; ng(n+1)=3.848770e+002;
n=23; farx(n+1)=1.365821e+000; foe(n+1)=1.283175e+001; krok(n+1)=1.119298e+000; ng(n+1)=1.308586e+002;
n=24; farx(n+1)=1.199719e+000; foe(n+1)=1.132843e+001; krok(n+1)=4.774949e+001; ng(n+1)=8.191847e+001;
n=25; farx(n+1)=1.128700e+000; foe(n+1)=1.090975e+001; krok(n+1)=8.896431e-001; ng(n+1)=5.249583e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.111292e+000; foe(n+1)=1.067003e+001; krok(n+1)=1.044207e-005; ng(n+1)=3.812944e+002;
n=27; farx(n+1)=1.096600e+000; foe(n+1)=1.061512e+001; krok(n+1)=5.394991e-006; ng(n+1)=2.499768e+002;
n=28; farx(n+1)=1.083539e+000; foe(n+1)=1.060156e+001; krok(n+1)=1.022605e-004; ng(n+1)=2.782177e+001;
n=29; farx(n+1)=9.885377e-001; foe(n+1)=1.040428e+001; krok(n+1)=3.870416e-003; ng(n+1)=1.697897e+001;
n=30; farx(n+1)=8.967540e-001; foe(n+1)=9.989181e+000; krok(n+1)=1.086709e-002; ng(n+1)=6.649186e+001;
n=31; farx(n+1)=8.139569e-001; foe(n+1)=9.901606e+000; krok(n+1)=1.632237e-002; ng(n+1)=4.600572e+002;
n=32; farx(n+1)=8.664967e-001; foe(n+1)=9.795367e+000; krok(n+1)=9.118713e-002; ng(n+1)=4.295491e+002;
n=33; farx(n+1)=8.615873e-001; foe(n+1)=9.677583e+000; krok(n+1)=7.739151e-001; ng(n+1)=2.941133e+002;
n=34; farx(n+1)=8.150388e-001; foe(n+1)=9.536259e+000; krok(n+1)=1.476581e+000; ng(n+1)=1.766956e+002;
n=35; farx(n+1)=8.155983e-001; foe(n+1)=9.472646e+000; krok(n+1)=5.732413e-001; ng(n+1)=7.604926e+001;
n=36; farx(n+1)=8.104924e-001; foe(n+1)=9.449288e+000; krok(n+1)=1.380032e+000; ng(n+1)=1.034795e+002;
n=37; farx(n+1)=7.877679e-001; foe(n+1)=9.431291e+000; krok(n+1)=1.226779e+000; ng(n+1)=8.040199e+001;
n=38; farx(n+1)=7.662488e-001; foe(n+1)=9.421439e+000; krok(n+1)=7.957487e-001; ng(n+1)=1.954825e+001;
n=39; farx(n+1)=7.580313e-001; foe(n+1)=9.418726e+000; krok(n+1)=1.092360e+000; ng(n+1)=1.521678e+001;
n=40; farx(n+1)=7.540738e-001; foe(n+1)=9.417227e+000; krok(n+1)=6.564205e-001; ng(n+1)=2.953416e+001;
n=41; farx(n+1)=7.480891e-001; foe(n+1)=9.416075e+000; krok(n+1)=9.576737e-001; ng(n+1)=2.334529e+001;
n=42; farx(n+1)=7.418252e-001; foe(n+1)=9.415661e+000; krok(n+1)=1.104103e+000; ng(n+1)=1.062158e+001;
n=43; farx(n+1)=7.404624e-001; foe(n+1)=9.415519e+000; krok(n+1)=1.127230e+000; ng(n+1)=4.156961e+000;
n=44; farx(n+1)=7.403278e-001; foe(n+1)=9.415447e+000; krok(n+1)=1.304892e+000; ng(n+1)=4.530182e+000;
n=45; farx(n+1)=7.409709e-001; foe(n+1)=9.415428e+000; krok(n+1)=1.598536e+000; ng(n+1)=3.398804e+000;
n=46; farx(n+1)=7.411777e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.257512e+000; ng(n+1)=8.976098e-001;
n=47; farx(n+1)=7.410219e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.531645e+000; ng(n+1)=1.588865e-001;
n=48; farx(n+1)=7.409295e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.114269e+000; ng(n+1)=2.215594e-001;
n=49; farx(n+1)=7.409295e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.119944e-006; ng(n+1)=4.020584e-003;
n=50; farx(n+1)=7.409295e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.076807e-005; ng(n+1)=4.020561e-003;
%odnowa zmiennej metryki
n=51; farx(n+1)=7.409294e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.197434e-006; ng(n+1)=4.020518e-003;
n=52; farx(n+1)=7.409292e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.222055e-005; ng(n+1)=2.529013e-003;
n=53; farx(n+1)=7.409290e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.882199e-005; ng(n+1)=2.250112e-003;
n=54; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.240245e-003; ng(n+1)=3.270649e-004;
n=55; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.935565e-002; ng(n+1)=2.326478e-004;
n=56; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.349696e-006; ng(n+1)=2.213735e-004;
n=57; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.294124e-005; ng(n+1)=2.213705e-004;
n=58; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.118683e-005; ng(n+1)=2.213674e-004;
n=59; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.244400e-007; ng(n+1)=2.213648e-004;
n=60; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.064909e-009; ng(n+1)=2.213648e-004;
n=61; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.057445e-008; ng(n+1)=2.213648e-004;
n=62; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.611299e-008; ng(n+1)=2.213649e-004;
n=63; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.738439e-006; ng(n+1)=2.213649e-004;
n=64; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.641628e-006; ng(n+1)=2.213637e-004;
n=65; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.210339e-005; ng(n+1)=2.213617e-004;
n=66; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.747856e-006; ng(n+1)=2.213485e-004;
n=67; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.290553e-005; ng(n+1)=2.213468e-004;
n=68; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.722086e-006; ng(n+1)=2.213437e-004;
n=69; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.512808e-005; ng(n+1)=2.213429e-004;
n=70; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.766350e-008; ng(n+1)=2.213394e-004;
n=71; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.985011e-008; ng(n+1)=2.213394e-004;
n=72; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.493785e-005; ng(n+1)=2.213394e-004;
n=73; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.866408e-007; ng(n+1)=2.213355e-004;
n=74; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.306521e-006; ng(n+1)=2.213354e-004;
n=75; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.351176e-007; ng(n+1)=2.213342e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.758193e-006; ng(n+1)=2.213341e-004;
n=77; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.430061e-005; ng(n+1)=9.788974e-005;
n=78; farx(n+1)=7.409301e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.809248e-005; ng(n+1)=1.081508e-004;
n=79; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.402881e-003; ng(n+1)=1.061746e-004;
n=80; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.600086e-006; ng(n+1)=1.575260e-004;
n=81; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.201815e-005; ng(n+1)=1.575077e-004;
n=82; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.600086e-006; ng(n+1)=1.575047e-004;
n=83; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.846386e-005; ng(n+1)=1.575032e-004;
n=84; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.110546e-007; ng(n+1)=1.574985e-004;
n=85; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.879296e-007; ng(n+1)=1.574984e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=86; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.290553e-005; ng(n+1)=1.574983e-004;
n=87; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.846386e-005; ng(n+1)=9.966376e-005;
n=88; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.873148e-006; ng(n+1)=2.708415e-004;
n=89; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.860122e-005; ng(n+1)=1.259613e-004;
n=90; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.290553e-005; ng(n+1)=1.257307e-004;
n=91; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.761882e-006; ng(n+1)=1.257335e-004;
n=92; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.089046e-005; ng(n+1)=1.257324e-004;
n=93; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.003238e-007; ng(n+1)=1.257302e-004;
n=94; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.337129e-009; ng(n+1)=1.257302e-004;
n=95; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.461382e-006; ng(n+1)=1.257302e-004;
n=96; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.687119e-007; ng(n+1)=1.257297e-004;
n=97; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.331502e-008; ng(n+1)=1.257296e-004;
n=98; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.437762e-009; ng(n+1)=1.257295e-004;
n=99; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.319882e-011; ng(n+1)=1.257296e-004;
n=100; farx(n+1)=7.409297e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.699195e-010; ng(n+1)=1.257296e-004;
%odnowa zmiennej metryki
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
