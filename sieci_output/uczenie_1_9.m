%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.566879e+002; foe(n+1)=6.563682e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.126163e+002; foe(n+1)=6.120684e+002; krok(n+1)=5.127695e-004; ng(n+1)=3.741710e+002;
n=2; farx(n+1)=2.016541e+002; foe(n+1)=2.000110e+002; krok(n+1)=1.912971e-002; ng(n+1)=1.052988e+002;
n=3; farx(n+1)=1.966264e+002; foe(n+1)=1.971581e+002; krok(n+1)=5.817002e-004; ng(n+1)=1.982726e+002;
n=4; farx(n+1)=2.123820e+002; foe(n+1)=1.906309e+002; krok(n+1)=2.835564e-002; ng(n+1)=1.746165e+002;
n=5; farx(n+1)=2.027452e+002; foe(n+1)=1.891611e+002; krok(n+1)=3.452691e-003; ng(n+1)=1.175433e+002;
n=6; farx(n+1)=2.034742e+002; foe(n+1)=1.801848e+002; krok(n+1)=1.204104e-001; ng(n+1)=1.734321e+002;
n=7; farx(n+1)=1.969070e+002; foe(n+1)=1.786763e+002; krok(n+1)=4.544795e-002; ng(n+1)=1.577384e+002;
n=8; farx(n+1)=3.781143e+001; foe(n+1)=1.269488e+002; krok(n+1)=4.641165e-001; ng(n+1)=1.798578e+002;
n=9; farx(n+1)=3.385855e+001; foe(n+1)=1.245571e+002; krok(n+1)=9.698882e-003; ng(n+1)=9.963110e+002;
n=10; farx(n+1)=3.300684e+001; foe(n+1)=1.220056e+002; krok(n+1)=1.163808e-002; ng(n+1)=1.598968e+003;
n=11; farx(n+1)=3.555963e+001; foe(n+1)=1.042049e+002; krok(n+1)=5.436452e-001; ng(n+1)=1.589494e+003;
n=12; farx(n+1)=3.728083e+001; foe(n+1)=9.577882e+001; krok(n+1)=5.223159e-001; ng(n+1)=6.648433e+002;
n=13; farx(n+1)=2.060848e+001; foe(n+1)=7.901600e+001; krok(n+1)=1.135362e+000; ng(n+1)=2.211937e+002;
n=14; farx(n+1)=1.183655e+001; foe(n+1)=5.204860e+001; krok(n+1)=1.881412e-001; ng(n+1)=2.744218e+002;
n=15; farx(n+1)=1.210431e+001; foe(n+1)=5.069474e+001; krok(n+1)=6.951230e-003; ng(n+1)=5.262414e+002;
n=16; farx(n+1)=1.090727e+001; foe(n+1)=4.511364e+001; krok(n+1)=5.312625e-001; ng(n+1)=5.092776e+002;
n=17; farx(n+1)=9.918712e+000; foe(n+1)=4.278078e+001; krok(n+1)=3.435737e-001; ng(n+1)=1.414886e+002;
n=18; farx(n+1)=9.046922e+000; foe(n+1)=3.876855e+001; krok(n+1)=5.752763e-001; ng(n+1)=6.263359e+002;
n=19; farx(n+1)=7.868360e+000; foe(n+1)=3.672061e+001; krok(n+1)=1.477307e+000; ng(n+1)=4.893399e+002;
n=20; farx(n+1)=6.654571e+000; foe(n+1)=3.396062e+001; krok(n+1)=1.168297e+000; ng(n+1)=3.856670e+002;
n=21; farx(n+1)=5.546516e+000; foe(n+1)=2.996261e+001; krok(n+1)=1.142810e+000; ng(n+1)=1.143307e+002;
n=22; farx(n+1)=5.096515e+000; foe(n+1)=2.796796e+001; krok(n+1)=1.207877e+000; ng(n+1)=1.905658e+002;
n=23; farx(n+1)=4.325192e+000; foe(n+1)=2.485918e+001; krok(n+1)=9.857126e-001; ng(n+1)=6.530794e+002;
n=24; farx(n+1)=3.472179e+000; foe(n+1)=2.247317e+001; krok(n+1)=7.382907e-001; ng(n+1)=2.303518e+002;
n=25; farx(n+1)=3.116873e+000; foe(n+1)=2.124724e+001; krok(n+1)=2.760258e-001; ng(n+1)=6.023023e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.973987e+000; foe(n+1)=2.037048e+001; krok(n+1)=7.048309e-006; ng(n+1)=8.000294e+002;
n=27; farx(n+1)=2.811641e+000; foe(n+1)=1.994150e+001; krok(n+1)=6.627688e-005; ng(n+1)=1.872774e+002;
n=28; farx(n+1)=2.618257e+000; foe(n+1)=1.962468e+001; krok(n+1)=5.047515e-004; ng(n+1)=6.540310e+001;
n=29; farx(n+1)=2.225610e+000; foe(n+1)=1.839163e+001; krok(n+1)=9.756778e-004; ng(n+1)=9.746890e+001;
n=30; farx(n+1)=2.221616e+000; foe(n+1)=1.808622e+001; krok(n+1)=6.130766e-003; ng(n+1)=2.860455e+002;
n=31; farx(n+1)=2.103142e+000; foe(n+1)=1.792580e+001; krok(n+1)=1.941426e-002; ng(n+1)=6.287412e+002;
n=32; farx(n+1)=2.518167e+000; foe(n+1)=1.734186e+001; krok(n+1)=5.419562e-001; ng(n+1)=7.486118e+002;
n=33; farx(n+1)=2.121227e+000; foe(n+1)=1.703593e+001; krok(n+1)=1.641051e-001; ng(n+1)=4.417332e+002;
n=34; farx(n+1)=1.839940e+000; foe(n+1)=1.628747e+001; krok(n+1)=1.104103e+000; ng(n+1)=2.287996e+002;
n=35; farx(n+1)=1.758266e+000; foe(n+1)=1.568803e+001; krok(n+1)=7.011953e-001; ng(n+1)=1.237161e+002;
n=36; farx(n+1)=1.766114e+000; foe(n+1)=1.546657e+001; krok(n+1)=4.385923e-001; ng(n+1)=3.921857e+002;
n=37; farx(n+1)=1.445102e+000; foe(n+1)=1.513147e+001; krok(n+1)=2.034481e+000; ng(n+1)=2.545244e+002;
n=38; farx(n+1)=1.363238e+000; foe(n+1)=1.494181e+001; krok(n+1)=3.227510e-001; ng(n+1)=1.245530e+002;
n=39; farx(n+1)=1.501201e+000; foe(n+1)=1.484419e+001; krok(n+1)=5.461275e-001; ng(n+1)=1.889967e+002;
n=40; farx(n+1)=1.529654e+000; foe(n+1)=1.477572e+001; krok(n+1)=1.476581e+000; ng(n+1)=1.677541e+002;
n=41; farx(n+1)=1.372418e+000; foe(n+1)=1.467612e+001; krok(n+1)=8.771846e-001; ng(n+1)=2.465750e+001;
n=42; farx(n+1)=1.286964e+000; foe(n+1)=1.464376e+001; krok(n+1)=1.080691e+000; ng(n+1)=8.135950e+001;
n=43; farx(n+1)=1.271573e+000; foe(n+1)=1.462467e+001; krok(n+1)=6.137814e-001; ng(n+1)=9.125812e+001;
n=44; farx(n+1)=1.279192e+000; foe(n+1)=1.459496e+001; krok(n+1)=5.250759e-001; ng(n+1)=7.929558e+001;
n=45; farx(n+1)=1.266273e+000; foe(n+1)=1.458910e+001; krok(n+1)=3.874329e-001; ng(n+1)=2.311806e+001;
n=46; farx(n+1)=1.226667e+000; foe(n+1)=1.457465e+001; krok(n+1)=1.707324e+000; ng(n+1)=4.303732e+001;
n=47; farx(n+1)=1.141424e+000; foe(n+1)=1.456338e+001; krok(n+1)=1.633314e+000; ng(n+1)=3.678426e+001;
n=48; farx(n+1)=1.142599e+000; foe(n+1)=1.455722e+001; krok(n+1)=1.054352e+000; ng(n+1)=3.610032e+001;
n=49; farx(n+1)=1.120828e+000; foe(n+1)=1.455098e+001; krok(n+1)=5.327344e-001; ng(n+1)=6.570966e+001;
n=50; farx(n+1)=1.061865e+000; foe(n+1)=1.454505e+001; krok(n+1)=1.120145e+000; ng(n+1)=1.845353e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.062296e+000; foe(n+1)=1.454379e+001; krok(n+1)=2.669404e-006; ng(n+1)=3.856257e+001;
n=52; farx(n+1)=1.062219e+000; foe(n+1)=1.454216e+001; krok(n+1)=9.884595e-006; ng(n+1)=2.882267e+001;
n=53; farx(n+1)=1.060328e+000; foe(n+1)=1.454155e+001; krok(n+1)=6.123045e-005; ng(n+1)=6.975035e+000;
n=54; farx(n+1)=1.070476e+000; foe(n+1)=1.452837e+001; krok(n+1)=1.861026e-003; ng(n+1)=6.355119e+000;
n=55; farx(n+1)=1.045912e+000; foe(n+1)=1.452651e+001; krok(n+1)=2.476948e-002; ng(n+1)=6.104943e-001;
n=56; farx(n+1)=1.059702e+000; foe(n+1)=1.452522e+001; krok(n+1)=4.183102e-002; ng(n+1)=9.658176e+000;
n=57; farx(n+1)=1.021346e+000; foe(n+1)=1.452305e+001; krok(n+1)=4.004429e-001; ng(n+1)=2.027838e+001;
n=58; farx(n+1)=9.962586e-001; foe(n+1)=1.452218e+001; krok(n+1)=1.711800e+000; ng(n+1)=2.886538e+001;
n=59; farx(n+1)=9.952568e-001; foe(n+1)=1.452199e+001; krok(n+1)=8.745977e-001; ng(n+1)=9.705416e+000;
n=60; farx(n+1)=9.864655e-001; foe(n+1)=1.452190e+001; krok(n+1)=1.199074e+000; ng(n+1)=5.822835e+000;
n=61; farx(n+1)=9.841647e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.569476e+000; ng(n+1)=2.448147e+000;
n=62; farx(n+1)=9.840053e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.576737e-001; ng(n+1)=5.892546e-001;
n=63; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.571530e-001; ng(n+1)=2.167533e-002;
n=64; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.720017e-005; ng(n+1)=8.560671e-003;
n=65; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.450741e-005; ng(n+1)=8.560521e-003;
n=66; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.955467e-006; ng(n+1)=8.560225e-003;
n=67; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.868738e-005; ng(n+1)=8.560157e-003;
n=68; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.852244e-007; ng(n+1)=8.559997e-003;
n=69; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.612156e-009; ng(n+1)=8.559994e-003;
n=70; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.117993e-009; ng(n+1)=8.559994e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=71; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.666364e-006; ng(n+1)=8.559994e-003;
n=72; farx(n+1)=9.839863e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.007443e-005; ng(n+1)=8.260898e-004;
n=73; farx(n+1)=9.839863e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.990494e-005; ng(n+1)=5.083980e-004;
n=74; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.739044e-003; ng(n+1)=1.927728e-004;
n=75; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.687119e-007; ng(n+1)=7.575049e-005;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.430035e-005; ng(n+1)=7.575026e-005;
n=77; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.760222e-007; ng(n+1)=5.642799e-005;
n=78; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.817408e-006; ng(n+1)=5.332092e-005;
n=79; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.319416e-008; ng(n+1)=5.386340e-005;
n=80; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.982777e-009; ng(n+1)=5.386337e-005;
n=81; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.934119e-009; ng(n+1)=5.386338e-005;
n=82; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.330406e-010; ng(n+1)=5.386337e-005;
n=83; farx(n+1)=9.839858e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.723304e-010; ng(n+1)=5.386336e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
