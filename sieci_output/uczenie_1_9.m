%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.408486e+002; foe(n+1)=6.242124e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.291367e+002; foe(n+1)=6.143683e+002; krok(n+1)=6.946998e-004; ng(n+1)=2.109966e+002;
n=2; farx(n+1)=2.036003e+002; foe(n+1)=1.993120e+002; krok(n+1)=4.050274e-002; ng(n+1)=1.344416e+002;
n=3; farx(n+1)=2.028005e+002; foe(n+1)=1.981476e+002; krok(n+1)=5.734420e-004; ng(n+1)=9.805748e+001;
n=4; farx(n+1)=2.032251e+002; foe(n+1)=1.916331e+002; krok(n+1)=3.598781e-002; ng(n+1)=6.578276e+001;
n=5; farx(n+1)=2.266684e+002; foe(n+1)=1.750897e+002; krok(n+1)=6.083508e-001; ng(n+1)=9.025382e+001;
n=6; farx(n+1)=2.044452e+002; foe(n+1)=1.739628e+002; krok(n+1)=1.300904e-001; ng(n+1)=6.698714e+001;
n=7; farx(n+1)=2.030715e+002; foe(n+1)=1.735226e+002; krok(n+1)=1.928435e-001; ng(n+1)=4.679865e+001;
n=8; farx(n+1)=2.017792e+002; foe(n+1)=1.727558e+002; krok(n+1)=4.979739e-001; ng(n+1)=3.972730e+001;
n=9; farx(n+1)=1.936986e+002; foe(n+1)=1.717135e+002; krok(n+1)=4.080312e+000; ng(n+1)=1.791605e+001;
n=10; farx(n+1)=7.621356e+001; foe(n+1)=1.536250e+002; krok(n+1)=1.561580e+000; ng(n+1)=4.334078e+001;
n=11; farx(n+1)=7.308883e+001; foe(n+1)=1.535643e+002; krok(n+1)=1.733806e-004; ng(n+1)=5.597701e+002;
n=12; farx(n+1)=4.425462e+001; foe(n+1)=1.356034e+002; krok(n+1)=2.167825e+000; ng(n+1)=5.862165e+002;
n=13; farx(n+1)=3.887208e+001; foe(n+1)=1.320012e+002; krok(n+1)=5.849663e-003; ng(n+1)=1.142534e+003;
n=14; farx(n+1)=3.950938e+001; foe(n+1)=1.277552e+002; krok(n+1)=3.039298e-002; ng(n+1)=1.668392e+003;
n=15; farx(n+1)=3.763012e+001; foe(n+1)=1.201719e+002; krok(n+1)=3.095635e-002; ng(n+1)=1.789851e+003;
n=16; farx(n+1)=3.654495e+001; foe(n+1)=1.130676e+002; krok(n+1)=4.890625e-002; ng(n+1)=2.295645e+003;
n=17; farx(n+1)=2.736967e+001; foe(n+1)=7.282162e+001; krok(n+1)=7.101669e-001; ng(n+1)=1.984679e+003;
n=18; farx(n+1)=2.007703e+001; foe(n+1)=5.925604e+001; krok(n+1)=5.355876e-001; ng(n+1)=7.779748e+002;
n=19; farx(n+1)=1.579311e+001; foe(n+1)=5.108493e+001; krok(n+1)=5.571345e-001; ng(n+1)=6.163141e+002;
n=20; farx(n+1)=9.410812e+000; foe(n+1)=4.236749e+001; krok(n+1)=8.354052e-001; ng(n+1)=5.673594e+002;
n=21; farx(n+1)=7.736247e+000; foe(n+1)=3.626044e+001; krok(n+1)=2.092736e+000; ng(n+1)=6.062086e+002;
n=22; farx(n+1)=6.979703e+000; foe(n+1)=3.190190e+001; krok(n+1)=4.556164e-001; ng(n+1)=4.217167e+002;
n=23; farx(n+1)=6.234427e+000; foe(n+1)=2.948922e+001; krok(n+1)=3.693268e-001; ng(n+1)=4.129059e+002;
n=24; farx(n+1)=5.010140e+000; foe(n+1)=2.705923e+001; krok(n+1)=6.155707e-001; ng(n+1)=5.985203e+002;
n=25; farx(n+1)=4.054921e+000; foe(n+1)=2.269227e+001; krok(n+1)=1.754638e+000; ng(n+1)=4.517337e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.983883e+000; foe(n+1)=2.236850e+001; krok(n+1)=2.031935e-005; ng(n+1)=2.953609e+002;
n=27; farx(n+1)=3.739641e+000; foe(n+1)=2.184532e+001; krok(n+1)=2.208984e-005; ng(n+1)=3.782825e+002;
n=28; farx(n+1)=3.639792e+000; foe(n+1)=2.164630e+001; krok(n+1)=3.766475e-004; ng(n+1)=5.365041e+001;
n=29; farx(n+1)=3.426102e+000; foe(n+1)=2.013060e+001; krok(n+1)=1.861026e-003; ng(n+1)=6.599257e+001;
n=30; farx(n+1)=3.619257e+000; foe(n+1)=1.954452e+001; krok(n+1)=3.910756e-003; ng(n+1)=5.187025e+002;
n=31; farx(n+1)=2.376659e+000; foe(n+1)=1.837931e+001; krok(n+1)=1.093247e-001; ng(n+1)=5.946633e+002;
n=32; farx(n+1)=2.422937e+000; foe(n+1)=1.824952e+001; krok(n+1)=5.576355e-002; ng(n+1)=6.527938e+002;
n=33; farx(n+1)=2.147374e+000; foe(n+1)=1.741992e+001; krok(n+1)=7.957487e-001; ng(n+1)=5.599774e+002;
n=34; farx(n+1)=1.881188e+000; foe(n+1)=1.643694e+001; krok(n+1)=8.426513e-001; ng(n+1)=1.597571e+002;
n=35; farx(n+1)=1.865481e+000; foe(n+1)=1.601661e+001; krok(n+1)=7.638857e-001; ng(n+1)=3.444112e+002;
n=36; farx(n+1)=1.798404e+000; foe(n+1)=1.564540e+001; krok(n+1)=5.045340e-001; ng(n+1)=5.088712e+002;
n=37; farx(n+1)=1.513971e+000; foe(n+1)=1.517305e+001; krok(n+1)=1.210579e+000; ng(n+1)=9.806613e+001;
n=38; farx(n+1)=1.555212e+000; foe(n+1)=1.502510e+001; krok(n+1)=7.832156e-001; ng(n+1)=2.403243e+002;
n=39; farx(n+1)=1.593821e+000; foe(n+1)=1.489455e+001; krok(n+1)=6.749097e-001; ng(n+1)=1.680559e+002;
n=40; farx(n+1)=1.490673e+000; foe(n+1)=1.481282e+001; krok(n+1)=4.228884e-001; ng(n+1)=9.801063e+001;
n=41; farx(n+1)=1.340573e+000; foe(n+1)=1.474089e+001; krok(n+1)=3.791860e-001; ng(n+1)=1.574847e+002;
n=42; farx(n+1)=1.352908e+000; foe(n+1)=1.467201e+001; krok(n+1)=1.420334e+000; ng(n+1)=7.538112e+001;
n=43; farx(n+1)=1.325141e+000; foe(n+1)=1.463451e+001; krok(n+1)=9.959478e-001; ng(n+1)=1.500131e+002;
n=44; farx(n+1)=1.330855e+000; foe(n+1)=1.462076e+001; krok(n+1)=5.885355e-001; ng(n+1)=5.067353e+001;
n=45; farx(n+1)=1.237810e+000; foe(n+1)=1.459515e+001; krok(n+1)=1.040494e+000; ng(n+1)=7.773528e+001;
n=46; farx(n+1)=1.184832e+000; foe(n+1)=1.458620e+001; krok(n+1)=1.307567e+000; ng(n+1)=4.602540e+001;
n=47; farx(n+1)=1.181004e+000; foe(n+1)=1.457237e+001; krok(n+1)=1.192577e+000; ng(n+1)=1.609258e+001;
n=48; farx(n+1)=1.183646e+000; foe(n+1)=1.456874e+001; krok(n+1)=4.555491e-001; ng(n+1)=3.962896e+001;
n=49; farx(n+1)=1.099314e+000; foe(n+1)=1.455659e+001; krok(n+1)=1.817570e+000; ng(n+1)=7.810976e+001;
n=50; farx(n+1)=1.040795e+000; foe(n+1)=1.454362e+001; krok(n+1)=2.137416e+000; ng(n+1)=3.893364e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.039464e+000; foe(n+1)=1.454182e+001; krok(n+1)=7.068094e-006; ng(n+1)=3.886365e+001;
n=52; farx(n+1)=1.038931e+000; foe(n+1)=1.454061e+001; krok(n+1)=3.557081e-006; ng(n+1)=4.576587e+001;
n=53; farx(n+1)=1.037364e+000; foe(n+1)=1.454008e+001; krok(n+1)=5.755042e-005; ng(n+1)=7.444232e+000;
n=54; farx(n+1)=1.050097e+000; foe(n+1)=1.452900e+001; krok(n+1)=2.013418e-003; ng(n+1)=5.637160e+000;
n=55; farx(n+1)=1.046581e+000; foe(n+1)=1.452527e+001; krok(n+1)=5.507577e-002; ng(n+1)=1.062152e+000;
n=56; farx(n+1)=1.058331e+000; foe(n+1)=1.452490e+001; krok(n+1)=2.243330e-002; ng(n+1)=2.381627e+001;
n=57; farx(n+1)=1.016939e+000; foe(n+1)=1.452284e+001; krok(n+1)=3.328440e-001; ng(n+1)=2.213650e+001;
n=58; farx(n+1)=9.930683e-001; foe(n+1)=1.452206e+001; krok(n+1)=1.941881e+000; ng(n+1)=2.612178e+001;
n=59; farx(n+1)=9.926911e-001; foe(n+1)=1.452195e+001; krok(n+1)=9.112329e-001; ng(n+1)=6.887195e+000;
n=60; farx(n+1)=9.858464e-001; foe(n+1)=1.452190e+001; krok(n+1)=1.107016e+000; ng(n+1)=4.480010e+000;
n=61; farx(n+1)=9.839445e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.361453e+000; ng(n+1)=1.703005e+000;
n=62; farx(n+1)=9.840132e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.922169e-001; ng(n+1)=5.353212e-001;
n=63; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.536620e-001; ng(n+1)=3.011512e-002;
n=64; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.258975e-006; ng(n+1)=3.128297e-003;
n=65; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.793088e-008; ng(n+1)=3.128275e-003;
n=66; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.491360e-009; ng(n+1)=3.128275e-003;
n=67; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.524649e-011; ng(n+1)=3.128275e-003;
n=68; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.665802e-011; ng(n+1)=3.128275e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=69; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.779995e-006; ng(n+1)=3.128275e-003;
n=70; farx(n+1)=9.839916e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.810792e-005; ng(n+1)=8.232941e-004;
n=71; farx(n+1)=9.839916e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.215525e-005; ng(n+1)=2.672556e-004;
n=72; farx(n+1)=9.839913e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.859551e-003; ng(n+1)=1.215081e-004;
n=73; farx(n+1)=9.839913e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.920561e-006; ng(n+1)=1.033410e-004;
n=74; farx(n+1)=9.839913e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.272048e-007; ng(n+1)=1.033406e-004;
n=75; farx(n+1)=9.839913e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.471718e-008; ng(n+1)=1.033405e-004;
%odnowa zmiennej metryki
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
