%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.466580e+002; foe(n+1)=6.585144e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.050816e+002; foe(n+1)=6.163273e+002; krok(n+1)=5.034661e-004; ng(n+1)=3.735806e+002;
n=2; farx(n+1)=5.648203e+002; foe(n+1)=5.677825e+002; krok(n+1)=2.067140e-002; ng(n+1)=7.987169e+001;
n=3; farx(n+1)=2.208944e+002; foe(n+1)=2.223626e+002; krok(n+1)=9.991826e-004; ng(n+1)=5.812938e+002;
n=4; farx(n+1)=2.494033e+002; foe(n+1)=2.106234e+002; krok(n+1)=4.128102e-001; ng(n+1)=1.379318e+002;
n=5; farx(n+1)=3.078038e+002; foe(n+1)=2.027567e+002; krok(n+1)=2.340680e-001; ng(n+1)=1.291719e+002;
n=6; farx(n+1)=2.950946e+002; foe(n+1)=1.893836e+002; krok(n+1)=2.477256e-001; ng(n+1)=7.257620e+001;
n=7; farx(n+1)=2.896412e+002; foe(n+1)=1.857730e+002; krok(n+1)=3.878020e-001; ng(n+1)=9.669361e+001;
n=8; farx(n+1)=2.674190e+002; foe(n+1)=1.801180e+002; krok(n+1)=9.397835e-001; ng(n+1)=8.651703e+001;
n=9; farx(n+1)=2.750906e+002; foe(n+1)=1.782479e+002; krok(n+1)=6.744582e-001; ng(n+1)=1.250680e+001;
n=10; farx(n+1)=2.747314e+002; foe(n+1)=1.781287e+002; krok(n+1)=1.244469e-001; ng(n+1)=1.504620e+001;
n=11; farx(n+1)=2.686617e+002; foe(n+1)=1.777325e+002; krok(n+1)=2.920744e-001; ng(n+1)=1.622325e+001;
n=12; farx(n+1)=2.675227e+002; foe(n+1)=1.776394e+002; krok(n+1)=2.871462e+000; ng(n+1)=1.497057e+001;
n=13; farx(n+1)=2.617386e+002; foe(n+1)=1.772754e+002; krok(n+1)=6.505487e+000; ng(n+1)=1.154585e+001;
n=14; farx(n+1)=2.629483e+002; foe(n+1)=1.770521e+002; krok(n+1)=4.498732e-001; ng(n+1)=2.509662e+001;
n=15; farx(n+1)=2.732764e+002; foe(n+1)=1.765305e+002; krok(n+1)=7.101669e-001; ng(n+1)=2.616993e+001;
n=16; farx(n+1)=2.846553e+002; foe(n+1)=1.760222e+002; krok(n+1)=1.754638e+000; ng(n+1)=1.509308e+001;
n=17; farx(n+1)=2.691425e+002; foe(n+1)=1.756950e+002; krok(n+1)=1.420334e+000; ng(n+1)=1.154267e+001;
n=18; farx(n+1)=2.492296e+002; foe(n+1)=1.751226e+002; krok(n+1)=3.883762e+000; ng(n+1)=1.198227e+001;
n=19; farx(n+1)=1.644385e+002; foe(n+1)=1.723410e+002; krok(n+1)=1.295495e+000; ng(n+1)=1.090788e+001;
n=20; farx(n+1)=1.607066e+002; foe(n+1)=1.723234e+002; krok(n+1)=2.702490e-004; ng(n+1)=1.751748e+002;
n=21; farx(n+1)=1.382406e+002; foe(n+1)=1.710511e+002; krok(n+1)=8.289013e-001; ng(n+1)=1.905135e+002;
n=22; farx(n+1)=1.042737e+002; foe(n+1)=1.694448e+002; krok(n+1)=7.438244e-002; ng(n+1)=2.586981e+002;
n=23; farx(n+1)=7.026439e+001; foe(n+1)=1.649255e+002; krok(n+1)=2.760258e-001; ng(n+1)=4.165991e+002;
n=24; farx(n+1)=6.143432e+001; foe(n+1)=1.607473e+002; krok(n+1)=6.524238e-002; ng(n+1)=8.162380e+002;
n=25; farx(n+1)=6.074649e+001; foe(n+1)=1.584000e+002; krok(n+1)=4.663645e-002; ng(n+1)=1.314544e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.945803e+001; foe(n+1)=1.319446e+002; krok(n+1)=4.645269e-005; ng(n+1)=1.453809e+003;
n=27; farx(n+1)=3.368293e+001; foe(n+1)=9.608161e+001; krok(n+1)=2.531441e-005; ng(n+1)=2.250869e+003;
n=28; farx(n+1)=3.005085e+001; foe(n+1)=8.620460e+001; krok(n+1)=8.058731e-004; ng(n+1)=4.606979e+002;
n=29; farx(n+1)=2.135446e+001; foe(n+1)=7.652437e+001; krok(n+1)=2.818678e-003; ng(n+1)=5.515238e+002;
n=30; farx(n+1)=1.967417e+001; foe(n+1)=6.959825e+001; krok(n+1)=6.099924e-003; ng(n+1)=1.082779e+003;
n=31; farx(n+1)=1.882807e+001; foe(n+1)=5.789925e+001; krok(n+1)=4.226038e-002; ng(n+1)=7.809396e+002;
n=32; farx(n+1)=1.797042e+001; foe(n+1)=5.616552e+001; krok(n+1)=1.519256e-001; ng(n+1)=9.312086e+002;
n=33; farx(n+1)=1.497995e+001; foe(n+1)=5.026667e+001; krok(n+1)=1.702433e-001; ng(n+1)=8.288610e+002;
n=34; farx(n+1)=9.624384e+000; foe(n+1)=4.127917e+001; krok(n+1)=2.448603e+000; ng(n+1)=3.614159e+002;
n=35; farx(n+1)=7.110417e+000; foe(n+1)=3.269428e+001; krok(n+1)=8.704303e-001; ng(n+1)=7.269555e+002;
n=36; farx(n+1)=5.650928e+000; foe(n+1)=3.008025e+001; krok(n+1)=1.638325e-001; ng(n+1)=3.356589e+002;
n=37; farx(n+1)=4.949445e+000; foe(n+1)=2.799759e+001; krok(n+1)=3.724184e-001; ng(n+1)=1.572831e+002;
n=38; farx(n+1)=3.979898e+000; foe(n+1)=2.483881e+001; krok(n+1)=4.641165e-001; ng(n+1)=8.016314e+002;
n=39; farx(n+1)=3.444861e+000; foe(n+1)=2.215012e+001; krok(n+1)=1.404256e+000; ng(n+1)=5.754977e+002;
n=40; farx(n+1)=3.343375e+000; foe(n+1)=2.015344e+001; krok(n+1)=4.992693e-001; ng(n+1)=3.361340e+002;
n=41; farx(n+1)=3.280869e+000; foe(n+1)=1.975666e+001; krok(n+1)=1.271551e-001; ng(n+1)=2.425827e+002;
n=42; farx(n+1)=2.334270e+000; foe(n+1)=1.837813e+001; krok(n+1)=1.273593e+000; ng(n+1)=5.745044e+002;
n=43; farx(n+1)=1.927581e+000; foe(n+1)=1.756412e+001; krok(n+1)=8.922448e-001; ng(n+1)=7.024566e+002;
n=44; farx(n+1)=1.985893e+000; foe(n+1)=1.660447e+001; krok(n+1)=9.145402e-001; ng(n+1)=1.006408e+002;
n=45; farx(n+1)=1.957373e+000; foe(n+1)=1.630980e+001; krok(n+1)=4.819709e-001; ng(n+1)=3.352947e+002;
n=46; farx(n+1)=1.898696e+000; foe(n+1)=1.558918e+001; krok(n+1)=2.582008e+000; ng(n+1)=5.583232e+002;
n=47; farx(n+1)=1.714940e+000; foe(n+1)=1.531034e+001; krok(n+1)=1.328156e-001; ng(n+1)=3.903394e+002;
n=48; farx(n+1)=1.427031e+000; foe(n+1)=1.508749e+001; krok(n+1)=3.355407e-001; ng(n+1)=1.970543e+002;
n=49; farx(n+1)=1.336409e+000; foe(n+1)=1.497270e+001; krok(n+1)=8.847528e-001; ng(n+1)=2.118283e+002;
n=50; farx(n+1)=1.454280e+000; foe(n+1)=1.486999e+001; krok(n+1)=1.447680e+000; ng(n+1)=2.276633e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.444084e+000; foe(n+1)=1.479773e+001; krok(n+1)=2.636114e-006; ng(n+1)=3.340019e+002;
n=52; farx(n+1)=1.442534e+000; foe(n+1)=1.479291e+001; krok(n+1)=6.663450e-005; ng(n+1)=1.796806e+001;
n=53; farx(n+1)=1.434207e+000; foe(n+1)=1.473360e+001; krok(n+1)=3.523348e-004; ng(n+1)=3.355709e+001;
n=54; farx(n+1)=1.365790e+000; foe(n+1)=1.463486e+001; krok(n+1)=1.498490e-004; ng(n+1)=5.730849e+001;
n=55; farx(n+1)=1.308572e+000; foe(n+1)=1.460402e+001; krok(n+1)=2.733118e-002; ng(n+1)=2.986025e+000;
n=56; farx(n+1)=1.270018e+000; foe(n+1)=1.460170e+001; krok(n+1)=2.043074e-002; ng(n+1)=1.527573e+002;
n=57; farx(n+1)=1.201242e+000; foe(n+1)=1.457041e+001; krok(n+1)=1.651241e+000; ng(n+1)=1.420260e+002;
n=58; farx(n+1)=1.210312e+000; foe(n+1)=1.455899e+001; krok(n+1)=6.287558e-001; ng(n+1)=1.003932e+002;
n=59; farx(n+1)=1.138511e+000; foe(n+1)=1.454198e+001; krok(n+1)=8.295027e-001; ng(n+1)=3.031256e+001;
n=60; farx(n+1)=1.116057e+000; foe(n+1)=1.453708e+001; krok(n+1)=6.871474e-001; ng(n+1)=3.382659e+001;
n=61; farx(n+1)=1.073344e+000; foe(n+1)=1.452948e+001; krok(n+1)=1.663205e+000; ng(n+1)=5.765510e+001;
n=62; farx(n+1)=1.053412e+000; foe(n+1)=1.452738e+001; krok(n+1)=4.500546e-001; ng(n+1)=3.160998e+001;
n=63; farx(n+1)=1.041219e+000; foe(n+1)=1.452438e+001; krok(n+1)=6.137814e-001; ng(n+1)=3.026361e+001;
n=64; farx(n+1)=1.016160e+000; foe(n+1)=1.452276e+001; krok(n+1)=1.841052e+000; ng(n+1)=1.595906e+001;
n=65; farx(n+1)=9.954976e-001; foe(n+1)=1.452217e+001; krok(n+1)=5.841487e-001; ng(n+1)=1.965124e+001;
n=66; farx(n+1)=9.934865e-001; foe(n+1)=1.452198e+001; krok(n+1)=9.089030e-001; ng(n+1)=8.504180e+000;
n=67; farx(n+1)=9.885142e-001; foe(n+1)=1.452191e+001; krok(n+1)=1.104103e+000; ng(n+1)=7.861199e+000;
n=68; farx(n+1)=9.856677e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.595898e-001; ng(n+1)=1.999996e+000;
n=69; farx(n+1)=9.837526e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.262060e+000; ng(n+1)=9.643712e-001;
n=70; farx(n+1)=9.841750e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.666867e+000; ng(n+1)=1.379844e+000;
n=71; farx(n+1)=9.839136e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.109668e+000; ng(n+1)=2.487217e-001;
n=72; farx(n+1)=9.839853e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.015323e+000; ng(n+1)=1.211729e-001;
n=73; farx(n+1)=9.839853e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.737149e-007; ng(n+1)=1.222998e-002;
n=74; farx(n+1)=9.839853e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.614205e-007; ng(n+1)=1.222998e-002;
n=75; farx(n+1)=9.839853e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.596182e-010; ng(n+1)=1.222997e-002;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839854e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.680793e-006; ng(n+1)=1.222997e-002;
n=77; farx(n+1)=9.839854e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.330827e-005; ng(n+1)=1.511865e-003;
n=78; farx(n+1)=9.839855e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.117454e-005; ng(n+1)=4.476315e-004;
n=79; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.663446e-003; ng(n+1)=1.068738e-004;
n=80; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.233048e-006; ng(n+1)=8.559689e-005;
n=81; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.135969e-005; ng(n+1)=8.559313e-005;
n=82; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.344165e-005; ng(n+1)=8.557896e-005;
n=83; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.379773e-007; ng(n+1)=8.557746e-005;
n=84; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.451632e-007; ng(n+1)=8.557745e-005;
n=85; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.457938e-009; ng(n+1)=8.557741e-005;
n=86; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.356202e-010; ng(n+1)=8.557742e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=87; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.548640e-010; ng(n+1)=8.557742e-005;
n=88; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.509254e-005; ng(n+1)=8.557500e-005;
n=89; farx(n+1)=9.839859e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.280408e-005; ng(n+1)=2.078076e-004;
n=90; farx(n+1)=9.839866e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.739128e-004; ng(n+1)=1.680061e-004;
n=91; farx(n+1)=9.839866e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.596370e-005; ng(n+1)=1.895179e-004;
n=92; farx(n+1)=9.839866e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.638332e-005; ng(n+1)=1.894497e-004;
n=93; farx(n+1)=9.839866e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.062185e-006; ng(n+1)=1.894446e-004;
n=94; farx(n+1)=9.839866e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.297418e-011; ng(n+1)=1.894431e-004;
n=95; farx(n+1)=9.839866e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.264556e-010; ng(n+1)=1.894432e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
