%uczenie predyktora oe
clear all;
n=0; farx(n+1)=9.331083e+002; foe(n+1)=9.400173e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=9.149835e+002; foe(n+1)=9.171392e+002; krok(n+1)=5.592616e-004; ng(n+1)=3.752922e+002;
n=2; farx(n+1)=9.157536e+002; foe(n+1)=9.155358e+002; krok(n+1)=7.998863e-004; ng(n+1)=8.878454e+001;
n=3; farx(n+1)=1.890963e+002; foe(n+1)=1.810176e+002; krok(n+1)=3.838379e-001; ng(n+1)=6.303254e+000;
n=4; farx(n+1)=1.889640e+002; foe(n+1)=1.810071e+002; krok(n+1)=3.031326e-005; ng(n+1)=1.245363e+002;
n=5; farx(n+1)=1.992699e+002; foe(n+1)=1.755401e+002; krok(n+1)=8.551938e-001; ng(n+1)=1.252488e+002;
n=6; farx(n+1)=1.990307e+002; foe(n+1)=1.700419e+002; krok(n+1)=1.260542e-003; ng(n+1)=2.212444e+002;
n=7; farx(n+1)=1.143196e+002; foe(n+1)=1.545897e+002; krok(n+1)=1.538197e-001; ng(n+1)=1.657686e+002;
n=8; farx(n+1)=9.272831e+001; foe(n+1)=1.468657e+002; krok(n+1)=5.857529e-002; ng(n+1)=1.309360e+002;
n=9; farx(n+1)=7.486162e+001; foe(n+1)=1.283639e+002; krok(n+1)=6.914797e-001; ng(n+1)=2.010211e+002;
n=10; farx(n+1)=6.814311e+001; foe(n+1)=1.217576e+002; krok(n+1)=3.500452e-002; ng(n+1)=2.535952e+002;
n=11; farx(n+1)=4.689439e+001; foe(n+1)=1.101329e+002; krok(n+1)=2.496347e-001; ng(n+1)=3.335379e+002;
n=12; farx(n+1)=3.746552e+001; foe(n+1)=9.172503e+001; krok(n+1)=2.845490e+000; ng(n+1)=3.517812e+002;
n=13; farx(n+1)=2.230613e+001; foe(n+1)=7.970190e+001; krok(n+1)=4.467816e-001; ng(n+1)=1.642916e+002;
n=14; farx(n+1)=1.639794e+001; foe(n+1)=7.104845e+001; krok(n+1)=2.531481e-001; ng(n+1)=5.865205e+002;
n=15; farx(n+1)=1.607819e+001; foe(n+1)=6.960167e+001; krok(n+1)=3.268918e-001; ng(n+1)=4.945027e+002;
n=16; farx(n+1)=1.135837e+001; foe(n+1)=5.704089e+001; krok(n+1)=1.402391e+000; ng(n+1)=1.661829e+002;
n=17; farx(n+1)=1.106819e+001; foe(n+1)=5.294342e+001; krok(n+1)=1.230771e-001; ng(n+1)=4.641817e+002;
n=18; farx(n+1)=8.757278e+000; foe(n+1)=4.777095e+001; krok(n+1)=3.885953e-001; ng(n+1)=7.880011e+002;
n=19; farx(n+1)=7.666436e+000; foe(n+1)=4.282156e+001; krok(n+1)=2.200070e-001; ng(n+1)=2.678491e+002;
n=20; farx(n+1)=7.666989e+000; foe(n+1)=3.870417e+001; krok(n+1)=6.954939e-001; ng(n+1)=2.253823e+002;
n=21; farx(n+1)=6.335117e+000; foe(n+1)=3.273515e+001; krok(n+1)=1.854055e+000; ng(n+1)=4.170751e+002;
n=22; farx(n+1)=3.680457e+000; foe(n+1)=2.616832e+001; krok(n+1)=8.352074e-001; ng(n+1)=4.083002e+002;
n=23; farx(n+1)=2.624977e+000; foe(n+1)=2.341352e+001; krok(n+1)=1.178633e-001; ng(n+1)=1.453666e+003;
n=24; farx(n+1)=2.257682e+000; foe(n+1)=2.081664e+001; krok(n+1)=3.903951e-001; ng(n+1)=1.288923e+003;
n=25; farx(n+1)=2.360220e+000; foe(n+1)=1.960548e+001; krok(n+1)=1.522124e-001; ng(n+1)=3.530127e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.365552e+000; foe(n+1)=1.947644e+001; krok(n+1)=1.894313e-005; ng(n+1)=1.998511e+002;
n=27; farx(n+1)=2.118421e+000; foe(n+1)=1.909604e+001; krok(n+1)=5.939136e-005; ng(n+1)=1.948608e+002;
n=28; farx(n+1)=2.101178e+000; foe(n+1)=1.873971e+001; krok(n+1)=7.570404e-005; ng(n+1)=1.619214e+002;
n=29; farx(n+1)=1.618780e+000; foe(n+1)=1.634710e+001; krok(n+1)=2.105249e-003; ng(n+1)=8.455220e+001;
n=30; farx(n+1)=1.742195e+000; foe(n+1)=1.578612e+001; krok(n+1)=4.664313e-003; ng(n+1)=5.781115e+002;
n=31; farx(n+1)=1.702836e+000; foe(n+1)=1.563715e+001; krok(n+1)=8.672124e-003; ng(n+1)=7.804966e+002;
n=32; farx(n+1)=1.514521e+000; foe(n+1)=1.512900e+001; krok(n+1)=1.072012e-001; ng(n+1)=8.983360e+002;
n=33; farx(n+1)=1.330174e+000; foe(n+1)=1.368025e+001; krok(n+1)=6.063266e-001; ng(n+1)=8.268199e+002;
n=34; farx(n+1)=1.016280e+000; foe(n+1)=1.211020e+001; krok(n+1)=5.673929e-001; ng(n+1)=4.402104e+002;
n=35; farx(n+1)=9.779902e-001; foe(n+1)=1.144856e+001; krok(n+1)=7.101669e-001; ng(n+1)=2.247742e+002;
n=36; farx(n+1)=9.508997e-001; foe(n+1)=1.099008e+001; krok(n+1)=4.004429e-001; ng(n+1)=5.964790e+002;
n=37; farx(n+1)=8.908775e-001; foe(n+1)=1.062800e+001; krok(n+1)=6.400584e-001; ng(n+1)=2.026868e+002;
n=38; farx(n+1)=8.587054e-001; foe(n+1)=1.012701e+001; krok(n+1)=9.806012e-001; ng(n+1)=3.113594e+002;
n=39; farx(n+1)=8.581659e-001; foe(n+1)=1.000847e+001; krok(n+1)=3.785938e-001; ng(n+1)=8.052828e+001;
n=40; farx(n+1)=8.450669e-001; foe(n+1)=9.756196e+000; krok(n+1)=9.429061e-001; ng(n+1)=1.506615e+002;
n=41; farx(n+1)=8.498412e-001; foe(n+1)=9.674703e+000; krok(n+1)=7.847380e-001; ng(n+1)=2.074607e+002;
n=42; farx(n+1)=8.259277e-001; foe(n+1)=9.602966e+000; krok(n+1)=8.127796e-001; ng(n+1)=1.438067e+002;
n=43; farx(n+1)=8.351015e-001; foe(n+1)=9.530472e+000; krok(n+1)=4.228884e-001; ng(n+1)=5.898979e+001;
n=44; farx(n+1)=8.345775e-001; foe(n+1)=9.491199e+000; krok(n+1)=1.509022e+000; ng(n+1)=7.918610e+001;
n=45; farx(n+1)=8.246820e-001; foe(n+1)=9.465207e+000; krok(n+1)=1.420334e+000; ng(n+1)=1.002604e+002;
n=46; farx(n+1)=8.118346e-001; foe(n+1)=9.446353e+000; krok(n+1)=8.704303e-001; ng(n+1)=9.165289e+001;
n=47; farx(n+1)=8.020982e-001; foe(n+1)=9.436708e+000; krok(n+1)=1.110032e+000; ng(n+1)=3.597971e+001;
n=48; farx(n+1)=7.884164e-001; foe(n+1)=9.428275e+000; krok(n+1)=2.225298e+000; ng(n+1)=2.468079e+001;
n=49; farx(n+1)=7.760955e-001; foe(n+1)=9.423464e+000; krok(n+1)=1.006076e+000; ng(n+1)=4.963563e+001;
n=50; farx(n+1)=7.596159e-001; foe(n+1)=9.418876e+000; krok(n+1)=3.171012e+000; ng(n+1)=1.008362e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=7.591445e-001; foe(n+1)=9.418229e+000; krok(n+1)=7.136974e-006; ng(n+1)=2.431236e+001;
n=52; farx(n+1)=7.592011e-001; foe(n+1)=9.418170e+000; krok(n+1)=3.014214e-006; ng(n+1)=1.019979e+001;
n=53; farx(n+1)=7.596135e-001; foe(n+1)=9.417735e+000; krok(n+1)=6.218716e-004; ng(n+1)=1.606168e+000;
n=54; farx(n+1)=7.550071e-001; foe(n+1)=9.416253e+000; krok(n+1)=2.266194e-004; ng(n+1)=5.983737e+000;
n=55; farx(n+1)=7.548125e-001; foe(n+1)=9.416066e+000; krok(n+1)=3.816957e-002; ng(n+1)=2.235856e-001;
n=56; farx(n+1)=7.511655e-001; foe(n+1)=9.415881e+000; krok(n+1)=4.256083e-002; ng(n+1)=3.525310e-001;
n=57; farx(n+1)=7.416797e-001; foe(n+1)=9.415437e+000; krok(n+1)=3.146509e-001; ng(n+1)=5.912149e-001;
n=58; farx(n+1)=7.411114e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.038220e+000; ng(n+1)=3.925010e+000;
n=59; farx(n+1)=7.409288e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.068393e+000; ng(n+1)=1.314570e-001;
n=60; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.853327e-001; ng(n+1)=3.761830e-002;
n=61; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.386253e-006; ng(n+1)=4.531311e-004;
n=62; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.844544e-008; ng(n+1)=4.531267e-004;
n=63; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.014124e-009; ng(n+1)=4.531266e-004;
n=64; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.278780e-006; ng(n+1)=4.531266e-004;
n=65; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.269631e-006; ng(n+1)=4.531255e-004;
n=66; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.110161e-005; ng(n+1)=4.531214e-004;
n=67; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.424230e-005; ng(n+1)=4.531166e-004;
n=68; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.615184e-006; ng(n+1)=4.531099e-004;
n=69; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.333987e-007; ng(n+1)=4.531087e-004;
n=70; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.488118e-006; ng(n+1)=4.531085e-004;
n=71; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.746466e-010; ng(n+1)=4.531073e-004;
n=72; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.965311e-009; ng(n+1)=4.531073e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=73; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.712708e-006; ng(n+1)=4.531073e-004;
n=74; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.610254e-006; ng(n+1)=3.848669e-004;
n=75; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.812256e-004; ng(n+1)=1.767894e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.065195e-005; ng(n+1)=3.203335e-004;
n=77; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.616676e-006; ng(n+1)=3.893902e-004;
n=78; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.418894e-005; ng(n+1)=1.542238e-004;
n=79; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.471113e-004; ng(n+1)=2.605425e-004;
n=80; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.797545e-007; ng(n+1)=9.442686e-005;
n=81; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.709206e-006; ng(n+1)=9.442684e-005;
n=82; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.232111e-009; ng(n+1)=9.442650e-005;
n=83; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.434661e-006; ng(n+1)=9.442651e-005;
n=84; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.269595e-006; ng(n+1)=9.442657e-005;
n=85; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.130389e-005; ng(n+1)=9.441627e-005;
n=86; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.998254e-009; ng(n+1)=9.441290e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=87; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.098717e-006; ng(n+1)=9.441290e-005;
n=88; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.046074e-005; ng(n+1)=6.816957e-005;
n=89; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.139878e-005; ng(n+1)=1.005545e-004;
n=90; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.265901e-006; ng(n+1)=6.362875e-005;
n=91; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.364200e-010; ng(n+1)=6.362757e-005;
n=92; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.108141e-009; ng(n+1)=6.362756e-005;
n=93; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.549625e-009; ng(n+1)=6.362756e-005;
n=94; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.226382e-006; ng(n+1)=6.362755e-005;
n=95; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.359409e-008; ng(n+1)=6.362728e-005;
n=96; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.103409e-008; ng(n+1)=6.362728e-005;
n=97; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.226263e-010; ng(n+1)=6.362726e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
