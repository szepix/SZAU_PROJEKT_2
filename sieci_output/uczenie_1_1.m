%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.217075e+002; foe(n+1)=6.191718e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.118617e+002; foe(n+1)=6.090662e+002; krok(n+1)=7.138862e-004; ng(n+1)=2.107196e+002;
n=2; farx(n+1)=2.709824e+002; foe(n+1)=2.666481e+002; krok(n+1)=9.949946e-003; ng(n+1)=1.872528e+002;
n=3; farx(n+1)=2.636490e+002; foe(n+1)=2.515768e+002; krok(n+1)=8.713055e-004; ng(n+1)=6.807458e+002;
n=4; farx(n+1)=2.671475e+002; foe(n+1)=2.381503e+002; krok(n+1)=4.173411e-003; ng(n+1)=6.317749e+002;
n=5; farx(n+1)=4.707181e+002; foe(n+1)=2.294876e+002; krok(n+1)=5.507794e-002; ng(n+1)=4.857531e+002;
n=6; farx(n+1)=4.716699e+002; foe(n+1)=2.179096e+002; krok(n+1)=1.525346e-001; ng(n+1)=2.149494e+002;
n=7; farx(n+1)=9.409374e+001; foe(n+1)=1.686832e+002; krok(n+1)=2.808512e+000; ng(n+1)=1.993336e+002;
n=8; farx(n+1)=9.162135e+001; foe(n+1)=1.671521e+002; krok(n+1)=1.660195e-002; ng(n+1)=2.774538e+002;
n=9; farx(n+1)=8.344599e+001; foe(n+1)=1.599420e+002; krok(n+1)=1.476964e-001; ng(n+1)=3.667860e+002;
n=10; farx(n+1)=5.864302e+001; foe(n+1)=1.314328e+002; krok(n+1)=2.905632e-001; ng(n+1)=7.742696e+002;
n=11; farx(n+1)=5.805879e+001; foe(n+1)=1.310127e+002; krok(n+1)=9.888795e-003; ng(n+1)=1.471577e+002;
n=12; farx(n+1)=5.238544e+001; foe(n+1)=1.124599e+002; krok(n+1)=2.223238e-001; ng(n+1)=1.614203e+002;
n=13; farx(n+1)=3.798967e+001; foe(n+1)=8.571874e+001; krok(n+1)=3.619299e-001; ng(n+1)=2.686308e+002;
n=14; farx(n+1)=3.665500e+001; foe(n+1)=8.491539e+001; krok(n+1)=4.864952e-002; ng(n+1)=2.183758e+002;
n=15; farx(n+1)=2.591858e+001; foe(n+1)=7.623731e+001; krok(n+1)=9.790194e-002; ng(n+1)=9.677253e+002;
n=16; farx(n+1)=1.959321e+001; foe(n+1)=6.645024e+001; krok(n+1)=1.633314e+000; ng(n+1)=8.963253e+002;
n=17; farx(n+1)=1.633623e+001; foe(n+1)=5.888006e+001; krok(n+1)=7.178655e-001; ng(n+1)=3.779977e+002;
n=18; farx(n+1)=1.426890e+001; foe(n+1)=5.461843e+001; krok(n+1)=1.641051e-001; ng(n+1)=6.744514e+002;
n=19; farx(n+1)=1.342391e+001; foe(n+1)=4.759723e+001; krok(n+1)=5.107206e-001; ng(n+1)=8.486906e+002;
n=20; farx(n+1)=9.545000e+000; foe(n+1)=3.972776e+001; krok(n+1)=1.791582e+000; ng(n+1)=1.268788e+002;
n=21; farx(n+1)=8.348281e+000; foe(n+1)=3.604144e+001; krok(n+1)=7.957487e-001; ng(n+1)=7.647640e+002;
n=22; farx(n+1)=7.385374e+000; foe(n+1)=3.284908e+001; krok(n+1)=4.854776e-001; ng(n+1)=3.047744e+002;
n=23; farx(n+1)=5.405164e+000; foe(n+1)=2.966039e+001; krok(n+1)=2.016994e-001; ng(n+1)=6.752018e+002;
n=24; farx(n+1)=4.010867e+000; foe(n+1)=2.540116e+001; krok(n+1)=4.602673e-001; ng(n+1)=7.795265e+002;
n=25; farx(n+1)=3.640395e+000; foe(n+1)=2.484050e+001; krok(n+1)=3.035583e-001; ng(n+1)=3.915078e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.626155e+000; foe(n+1)=2.462437e+001; krok(n+1)=7.530287e-006; ng(n+1)=3.289286e+002;
n=27; farx(n+1)=3.340107e+000; foe(n+1)=2.419927e+001; krok(n+1)=5.883434e-005; ng(n+1)=1.819506e+002;
n=28; farx(n+1)=3.293463e+000; foe(n+1)=2.393087e+001; krok(n+1)=3.125285e-004; ng(n+1)=7.653005e+001;
n=29; farx(n+1)=3.080745e+000; foe(n+1)=2.085038e+001; krok(n+1)=2.478376e-003; ng(n+1)=9.623490e+001;
n=30; farx(n+1)=3.137953e+000; foe(n+1)=2.071712e+001; krok(n+1)=1.296700e-003; ng(n+1)=6.302207e+002;
n=31; farx(n+1)=2.693811e+000; foe(n+1)=1.884788e+001; krok(n+1)=1.139041e-001; ng(n+1)=4.194358e+002;
n=32; farx(n+1)=2.416205e+000; foe(n+1)=1.869572e+001; krok(n+1)=7.959957e-002; ng(n+1)=3.415488e+002;
n=33; farx(n+1)=2.126013e+000; foe(n+1)=1.716900e+001; krok(n+1)=1.601363e+000; ng(n+1)=3.739165e+002;
n=34; farx(n+1)=2.013110e+000; foe(n+1)=1.654217e+001; krok(n+1)=4.968529e-001; ng(n+1)=4.973937e+002;
n=35; farx(n+1)=1.743509e+000; foe(n+1)=1.578361e+001; krok(n+1)=9.983416e-001; ng(n+1)=1.100624e+002;
n=36; farx(n+1)=1.666635e+000; foe(n+1)=1.561893e+001; krok(n+1)=4.228235e-001; ng(n+1)=1.259017e+002;
n=37; farx(n+1)=1.593695e+000; foe(n+1)=1.522632e+001; krok(n+1)=1.492366e+000; ng(n+1)=3.645287e+002;
n=38; farx(n+1)=1.605914e+000; foe(n+1)=1.506256e+001; krok(n+1)=3.903951e-001; ng(n+1)=3.194809e+002;
n=39; farx(n+1)=1.574800e+000; foe(n+1)=1.484697e+001; krok(n+1)=9.205345e-001; ng(n+1)=1.445821e+002;
n=40; farx(n+1)=1.372954e+000; foe(n+1)=1.478356e+001; krok(n+1)=5.636152e-001; ng(n+1)=1.100059e+002;
n=41; farx(n+1)=1.304039e+000; foe(n+1)=1.465731e+001; krok(n+1)=1.961603e+000; ng(n+1)=1.698700e+002;
n=42; farx(n+1)=1.308704e+000; foe(n+1)=1.462639e+001; krok(n+1)=2.176076e-001; ng(n+1)=9.841935e+001;
n=43; farx(n+1)=1.256496e+000; foe(n+1)=1.459075e+001; krok(n+1)=7.571876e-001; ng(n+1)=8.946922e+001;
n=44; farx(n+1)=1.239716e+000; foe(n+1)=1.458206e+001; krok(n+1)=7.101669e-001; ng(n+1)=1.033418e+002;
n=45; farx(n+1)=1.182619e+000; foe(n+1)=1.456381e+001; krok(n+1)=1.006124e+000; ng(n+1)=6.468330e+001;
n=46; farx(n+1)=1.156565e+000; foe(n+1)=1.455626e+001; krok(n+1)=4.500546e-001; ng(n+1)=7.088277e+001;
n=47; farx(n+1)=1.182104e+000; foe(n+1)=1.455071e+001; krok(n+1)=1.015323e+000; ng(n+1)=4.018242e+001;
n=48; farx(n+1)=1.137499e+000; foe(n+1)=1.454704e+001; krok(n+1)=1.784434e+000; ng(n+1)=1.422117e+001;
n=49; farx(n+1)=1.137988e+000; foe(n+1)=1.454549e+001; krok(n+1)=1.569476e+000; ng(n+1)=1.122586e+001;
n=50; farx(n+1)=1.100885e+000; foe(n+1)=1.454243e+001; krok(n+1)=3.771624e+000; ng(n+1)=3.603707e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.100820e+000; foe(n+1)=1.454227e+001; krok(n+1)=3.880465e-006; ng(n+1)=1.318570e+001;
n=52; farx(n+1)=1.098789e+000; foe(n+1)=1.454159e+001; krok(n+1)=1.929081e-005; ng(n+1)=1.310539e+001;
n=53; farx(n+1)=1.098317e+000; foe(n+1)=1.454132e+001; krok(n+1)=2.645953e-005; ng(n+1)=7.352726e+000;
n=54; farx(n+1)=1.107781e+000; foe(n+1)=1.453160e+001; krok(n+1)=1.828656e-003; ng(n+1)=5.319691e+000;
n=55; farx(n+1)=1.085761e+000; foe(n+1)=1.453036e+001; krok(n+1)=2.896961e-002; ng(n+1)=1.001160e+000;
n=56; farx(n+1)=1.095870e+000; foe(n+1)=1.452881e+001; krok(n+1)=6.105720e-002; ng(n+1)=4.107516e+000;
n=57; farx(n+1)=1.044471e+000; foe(n+1)=1.452504e+001; krok(n+1)=2.584327e-001; ng(n+1)=8.469999e+000;
n=58; farx(n+1)=1.012886e+000; foe(n+1)=1.452307e+001; krok(n+1)=1.454334e+000; ng(n+1)=3.581071e+001;
n=59; farx(n+1)=1.011144e+000; foe(n+1)=1.452245e+001; krok(n+1)=7.491049e-001; ng(n+1)=1.506364e+001;
n=60; farx(n+1)=9.942632e-001; foe(n+1)=1.452202e+001; krok(n+1)=1.071175e+000; ng(n+1)=9.055217e+000;
n=61; farx(n+1)=9.861708e-001; foe(n+1)=1.452191e+001; krok(n+1)=1.554622e+000; ng(n+1)=3.843088e+000;
n=62; farx(n+1)=9.853005e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.171186e-001; ng(n+1)=6.860681e+000;
n=63; farx(n+1)=9.839599e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.252141e-001; ng(n+1)=7.981173e-001;
n=64; farx(n+1)=9.839724e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.040723e+000; ng(n+1)=3.566104e-002;
n=65; farx(n+1)=9.839724e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.155324e-005; ng(n+1)=3.312510e-002;
n=66; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.996435e-001; ng(n+1)=3.312480e-002;
n=67; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.088221e-005; ng(n+1)=5.058741e-004;
n=68; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.448606e-005; ng(n+1)=5.058687e-004;
n=69; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.712708e-006; ng(n+1)=5.058613e-004;
n=70; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.570506e-006; ng(n+1)=5.058594e-004;
n=71; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.150304e-006; ng(n+1)=5.058561e-004;
n=72; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.013652e-005; ng(n+1)=5.058525e-004;
n=73; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.234087e-009; ng(n+1)=5.058474e-004;
n=74; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.607080e-010; ng(n+1)=5.058474e-004;
n=75; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.227349e-011; ng(n+1)=5.058474e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.221900e-006; ng(n+1)=5.058474e-004;
n=77; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.675917e-005; ng(n+1)=2.737464e-004;
n=78; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.549259e-005; ng(n+1)=1.247929e-004;
n=79; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.111781e-005; ng(n+1)=7.675979e-005;
n=80; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.851715e-005; ng(n+1)=7.677503e-005;
n=81; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.193805e-005; ng(n+1)=7.677323e-005;
n=82; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.632711e-006; ng(n+1)=7.677158e-005;
n=83; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.028100e-006; ng(n+1)=7.677103e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=84; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.575152e-006; ng(n+1)=7.677073e-005;
n=85; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.711919e-005; ng(n+1)=6.230420e-005;
n=86; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.964158e-006; ng(n+1)=6.663555e-005;
n=87; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.431291e-005; ng(n+1)=6.644883e-005;
n=88; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.577236e-006; ng(n+1)=6.643077e-005;
n=89; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.025906e-007; ng(n+1)=6.643046e-005;
n=90; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.321833e-008; ng(n+1)=6.643037e-005;
n=91; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.056800e-005; ng(n+1)=6.643039e-005;
n=92; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.778991e-006; ng(n+1)=6.643008e-005;
n=93; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.755755e-005; ng(n+1)=6.642991e-005;
n=94; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.638719e-005; ng(n+1)=6.642857e-005;
n=95; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.700898e-009; ng(n+1)=6.642742e-005;
n=96; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.396544e-008; ng(n+1)=6.642742e-005;
n=97; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.393995e-005; ng(n+1)=6.642738e-005;
n=98; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.032905e-007; ng(n+1)=6.642660e-005;
n=99; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.397738e-008; ng(n+1)=6.642658e-005;
n=100; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.301458e-009; ng(n+1)=6.642657e-005;
%odnowa zmiennej metryki
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
