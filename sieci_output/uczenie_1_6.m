%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.218214e+002; foe(n+1)=6.192520e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.142044e+002; foe(n+1)=6.109856e+002; krok(n+1)=6.467102e-004; ng(n+1)=1.930629e+002;
n=2; farx(n+1)=2.587295e+002; foe(n+1)=2.513679e+002; krok(n+1)=1.301252e-002; ng(n+1)=1.483656e+002;
n=3; farx(n+1)=2.544445e+002; foe(n+1)=2.436201e+002; krok(n+1)=3.656039e-004; ng(n+1)=6.191538e+002;
n=4; farx(n+1)=2.745784e+002; foe(n+1)=2.317126e+002; krok(n+1)=7.517005e-003; ng(n+1)=6.111129e+002;
n=5; farx(n+1)=4.072873e+002; foe(n+1)=2.265003e+002; krok(n+1)=3.481722e-002; ng(n+1)=4.304385e+002;
n=6; farx(n+1)=4.301578e+002; foe(n+1)=2.167280e+002; krok(n+1)=1.455442e-001; ng(n+1)=2.318288e+002;
n=7; farx(n+1)=3.848394e+002; foe(n+1)=2.132345e+002; krok(n+1)=1.387540e-001; ng(n+1)=2.104794e+002;
n=8; farx(n+1)=5.078375e+001; foe(n+1)=1.139809e+002; krok(n+1)=3.047347e-001; ng(n+1)=2.358107e+002;
n=9; farx(n+1)=5.000664e+001; foe(n+1)=1.136031e+002; krok(n+1)=6.669234e-003; ng(n+1)=1.677096e+002;
n=10; farx(n+1)=3.293148e+001; foe(n+1)=1.054382e+002; krok(n+1)=5.752763e-001; ng(n+1)=2.721578e+002;
n=11; farx(n+1)=2.181336e+001; foe(n+1)=9.130023e+001; krok(n+1)=2.997685e-001; ng(n+1)=2.233575e+002;
n=12; farx(n+1)=1.965708e+001; foe(n+1)=8.889985e+001; krok(n+1)=1.282772e-002; ng(n+1)=8.067115e+002;
n=13; farx(n+1)=1.312863e+001; foe(n+1)=6.034759e+001; krok(n+1)=4.953016e-001; ng(n+1)=9.548392e+002;
n=14; farx(n+1)=1.399961e+001; foe(n+1)=5.685236e+001; krok(n+1)=2.548582e-002; ng(n+1)=2.044942e+003;
n=15; farx(n+1)=1.467116e+001; foe(n+1)=5.032179e+001; krok(n+1)=3.589327e-001; ng(n+1)=1.692270e+003;
n=16; farx(n+1)=1.155301e+001; foe(n+1)=4.292824e+001; krok(n+1)=1.894216e+000; ng(n+1)=5.035106e+002;
n=17; farx(n+1)=8.089275e+000; foe(n+1)=3.692506e+001; krok(n+1)=1.784628e+000; ng(n+1)=5.117688e+002;
n=18; farx(n+1)=7.045039e+000; foe(n+1)=3.514044e+001; krok(n+1)=3.838379e-001; ng(n+1)=4.123920e+002;
n=19; farx(n+1)=6.112471e+000; foe(n+1)=3.329988e+001; krok(n+1)=7.178655e-001; ng(n+1)=2.305646e+002;
n=20; farx(n+1)=4.752566e+000; foe(n+1)=2.528793e+001; krok(n+1)=2.355579e+000; ng(n+1)=4.605445e+002;
n=21; farx(n+1)=3.016273e+000; foe(n+1)=2.226376e+001; krok(n+1)=1.240540e+000; ng(n+1)=2.760102e+002;
n=22; farx(n+1)=2.421691e+000; foe(n+1)=2.022689e+001; krok(n+1)=2.909773e-001; ng(n+1)=7.826936e+002;
n=23; farx(n+1)=2.188852e+000; foe(n+1)=1.924868e+001; krok(n+1)=2.507212e-001; ng(n+1)=2.834321e+002;
n=24; farx(n+1)=2.380789e+000; foe(n+1)=1.846850e+001; krok(n+1)=4.461084e-001; ng(n+1)=3.754790e+002;
n=25; farx(n+1)=2.525136e+000; foe(n+1)=1.770551e+001; krok(n+1)=5.355876e-001; ng(n+1)=6.199892e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.494923e+000; foe(n+1)=1.762603e+001; krok(n+1)=1.104522e-005; ng(n+1)=2.007365e+002;
n=27; farx(n+1)=2.396743e+000; foe(n+1)=1.735129e+001; krok(n+1)=5.039187e-005; ng(n+1)=1.816256e+002;
n=28; farx(n+1)=2.371948e+000; foe(n+1)=1.725122e+001; krok(n+1)=8.876552e-005; ng(n+1)=7.486285e+001;
n=29; farx(n+1)=2.303162e+000; foe(n+1)=1.647840e+001; krok(n+1)=1.043894e-002; ng(n+1)=1.823683e+001;
n=30; farx(n+1)=2.304649e+000; foe(n+1)=1.638844e+001; krok(n+1)=3.390416e-003; ng(n+1)=3.128109e+002;
n=31; farx(n+1)=1.939423e+000; foe(n+1)=1.614518e+001; krok(n+1)=1.778267e-002; ng(n+1)=2.241454e+002;
n=32; farx(n+1)=1.703609e+000; foe(n+1)=1.601052e+001; krok(n+1)=2.193298e-001; ng(n+1)=3.786670e+002;
n=33; farx(n+1)=1.708437e+000; foe(n+1)=1.551328e+001; krok(n+1)=8.181022e-001; ng(n+1)=2.707364e+002;
n=34; farx(n+1)=1.630042e+000; foe(n+1)=1.514214e+001; krok(n+1)=6.335709e-001; ng(n+1)=1.459130e+002;
n=35; farx(n+1)=1.499883e+000; foe(n+1)=1.501380e+001; krok(n+1)=1.089353e+000; ng(n+1)=2.140147e+002;
n=36; farx(n+1)=1.417550e+000; foe(n+1)=1.487969e+001; krok(n+1)=8.055989e-001; ng(n+1)=2.433719e+002;
n=37; farx(n+1)=1.437047e+000; foe(n+1)=1.473238e+001; krok(n+1)=8.456470e-001; ng(n+1)=1.262910e+002;
n=38; farx(n+1)=1.431914e+000; foe(n+1)=1.470952e+001; krok(n+1)=2.085241e-001; ng(n+1)=7.749124e+001;
n=39; farx(n+1)=1.376198e+000; foe(n+1)=1.463627e+001; krok(n+1)=1.663205e+000; ng(n+1)=8.898522e+001;
n=40; farx(n+1)=1.229926e+000; foe(n+1)=1.459676e+001; krok(n+1)=9.634903e-001; ng(n+1)=1.413118e+002;
n=41; farx(n+1)=1.192691e+000; foe(n+1)=1.458137e+001; krok(n+1)=4.764226e-001; ng(n+1)=5.452589e+001;
n=42; farx(n+1)=1.223094e+000; foe(n+1)=1.456802e+001; krok(n+1)=6.321212e-001; ng(n+1)=4.112815e+001;
n=43; farx(n+1)=1.201395e+000; foe(n+1)=1.455995e+001; krok(n+1)=6.335709e-001; ng(n+1)=6.573918e+001;
n=44; farx(n+1)=1.139925e+000; foe(n+1)=1.454775e+001; krok(n+1)=1.245801e+000; ng(n+1)=3.659540e+001;
n=45; farx(n+1)=1.111123e+000; foe(n+1)=1.454058e+001; krok(n+1)=1.331376e+000; ng(n+1)=2.961203e+001;
n=46; farx(n+1)=1.119158e+000; foe(n+1)=1.453815e+001; krok(n+1)=5.692710e-001; ng(n+1)=3.047118e+001;
n=47; farx(n+1)=1.092902e+000; foe(n+1)=1.453385e+001; krok(n+1)=1.402391e+000; ng(n+1)=3.059443e+001;
n=48; farx(n+1)=1.011151e+000; foe(n+1)=1.452871e+001; krok(n+1)=2.748589e+000; ng(n+1)=2.394931e+001;
n=49; farx(n+1)=9.918216e-001; foe(n+1)=1.452574e+001; krok(n+1)=1.675028e+000; ng(n+1)=1.919656e+001;
n=50; farx(n+1)=9.958672e-001; foe(n+1)=1.452517e+001; krok(n+1)=3.647485e-001; ng(n+1)=1.767499e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=9.960506e-001; foe(n+1)=1.452477e+001; krok(n+1)=1.816358e-006; ng(n+1)=3.580789e+001;
n=52; farx(n+1)=9.954646e-001; foe(n+1)=1.452456e+001; krok(n+1)=1.308479e-005; ng(n+1)=8.751322e+000;
n=53; farx(n+1)=9.948657e-001; foe(n+1)=1.452447e+001; krok(n+1)=4.095955e-005; ng(n+1)=3.421963e+000;
n=54; farx(n+1)=9.991820e-001; foe(n+1)=1.452240e+001; krok(n+1)=2.204222e-003; ng(n+1)=2.259044e+000;
n=55; farx(n+1)=9.913627e-001; foe(n+1)=1.452215e+001; krok(n+1)=2.840322e-002; ng(n+1)=3.526270e-001;
n=56; farx(n+1)=9.973061e-001; foe(n+1)=1.452199e+001; krok(n+1)=3.052860e-002; ng(n+1)=1.593788e+000;
n=57; farx(n+1)=9.864061e-001; foe(n+1)=1.452190e+001; krok(n+1)=8.536620e-001; ng(n+1)=3.428922e+000;
n=58; farx(n+1)=9.840760e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.307567e+000; ng(n+1)=4.432267e+000;
n=59; farx(n+1)=9.840440e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.047159e+000; ng(n+1)=1.476196e-001;
n=60; farx(n+1)=9.840440e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.269631e-006; ng(n+1)=2.444162e-002;
n=61; farx(n+1)=9.840440e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.026589e-008; ng(n+1)=2.444145e-002;
n=62; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.091642e+000; ng(n+1)=2.444145e-002;
n=63; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.905006e-006; ng(n+1)=2.464651e-003;
n=64; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.792012e-006; ng(n+1)=2.464630e-003;
n=65; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.009090e-009; ng(n+1)=2.464620e-003;
n=66; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.448236e-010; ng(n+1)=2.464620e-003;
n=67; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.721032e-010; ng(n+1)=2.464620e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=68; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.797081e-006; ng(n+1)=2.464620e-003;
n=69; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.069939e-005; ng(n+1)=4.985188e-004;
n=70; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.720244e-005; ng(n+1)=1.831969e-004;
n=71; farx(n+1)=9.839976e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.404706e-007; ng(n+1)=2.038604e-004;
n=72; farx(n+1)=9.839979e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.099901e-003; ng(n+1)=2.038597e-004;
n=73; farx(n+1)=9.839979e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.427471e-006; ng(n+1)=2.072887e-004;
n=74; farx(n+1)=9.839979e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.517921e-006; ng(n+1)=2.072844e-004;
n=75; farx(n+1)=9.839979e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.191662e-006; ng(n+1)=2.072821e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839979e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.575152e-006; ng(n+1)=2.072804e-004;
n=77; farx(n+1)=9.839979e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.912621e-005; ng(n+1)=1.946686e-004;
n=78; farx(n+1)=9.839979e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.635124e-005; ng(n+1)=2.188316e-004;
n=79; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.984182e-004; ng(n+1)=2.307666e-004;
n=80; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.511164e-005; ng(n+1)=1.848827e-004;
n=81; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.694130e-005; ng(n+1)=1.848785e-004;
n=82; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.325813e-005; ng(n+1)=1.848723e-004;
n=83; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.094896e-006; ng(n+1)=1.848684e-004;
n=84; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.797015e-007; ng(n+1)=1.848680e-004;
n=85; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.089725e-008; ng(n+1)=1.848680e-004;
n=86; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.215297e-011; ng(n+1)=1.848680e-004;
n=87; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.367212e-010; ng(n+1)=1.848680e-004;
n=88; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.964806e-010; ng(n+1)=1.848680e-004;
n=89; farx(n+1)=9.839978e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.798626e-010; ng(n+1)=1.848680e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
