%uczenie predyktora oe
clear all;
n=0; farx(n+1)=9.459395e+002; foe(n+1)=9.447793e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=9.181606e+002; foe(n+1)=9.178286e+002; krok(n+1)=6.064990e-004; ng(n+1)=4.075572e+002;
n=2; farx(n+1)=9.155143e+002; foe(n+1)=9.155396e+002; krok(n+1)=7.432430e-004; ng(n+1)=1.091050e+002;
n=3; farx(n+1)=1.732837e+002; foe(n+1)=1.749064e+002; krok(n+1)=4.686024e-001; ng(n+1)=5.347924e+000;
n=4; farx(n+1)=1.730484e+002; foe(n+1)=1.748940e+002; krok(n+1)=3.084957e-004; ng(n+1)=1.234756e+002;
n=5; farx(n+1)=1.626521e+002; foe(n+1)=1.715224e+002; krok(n+1)=1.160291e-001; ng(n+1)=1.249620e+002;
n=6; farx(n+1)=9.059948e+001; foe(n+1)=1.418617e+002; krok(n+1)=9.677825e-003; ng(n+1)=2.229259e+002;
n=7; farx(n+1)=8.668447e+001; foe(n+1)=1.342846e+002; krok(n+1)=4.112923e-002; ng(n+1)=2.933766e+002;
n=8; farx(n+1)=6.727082e+001; foe(n+1)=1.222677e+002; krok(n+1)=7.101669e-001; ng(n+1)=2.633778e+002;
n=9; farx(n+1)=3.659820e+001; foe(n+1)=1.004696e+002; krok(n+1)=3.852268e-001; ng(n+1)=2.391869e+002;
n=10; farx(n+1)=3.647311e+001; foe(n+1)=1.003750e+002; krok(n+1)=5.242823e-003; ng(n+1)=4.566434e+002;
n=11; farx(n+1)=3.402388e+001; foe(n+1)=9.306904e+001; krok(n+1)=5.551463e-001; ng(n+1)=1.253420e+002;
n=12; farx(n+1)=3.597590e+001; foe(n+1)=9.153629e+001; krok(n+1)=1.600146e-001; ng(n+1)=2.599265e+002;
n=13; farx(n+1)=3.450224e+001; foe(n+1)=8.842334e+001; krok(n+1)=6.577988e-001; ng(n+1)=1.008472e+002;
n=14; farx(n+1)=2.447353e+001; foe(n+1)=7.905322e+001; krok(n+1)=5.695627e-001; ng(n+1)=1.894734e+002;
n=15; farx(n+1)=2.160654e+001; foe(n+1)=7.400861e+001; krok(n+1)=6.476740e-002; ng(n+1)=5.674722e+002;
n=16; farx(n+1)=1.462110e+001; foe(n+1)=6.118943e+001; krok(n+1)=2.108705e+000; ng(n+1)=3.790310e+002;
n=17; farx(n+1)=1.226887e+001; foe(n+1)=5.305959e+001; krok(n+1)=3.060754e-001; ng(n+1)=7.411306e+002;
n=18; farx(n+1)=1.009819e+001; foe(n+1)=4.971152e+001; krok(n+1)=3.136673e-001; ng(n+1)=4.631302e+002;
n=19; farx(n+1)=9.909032e+000; foe(n+1)=4.122682e+001; krok(n+1)=4.310227e-001; ng(n+1)=7.732139e+002;
n=20; farx(n+1)=9.345281e+000; foe(n+1)=3.859978e+001; krok(n+1)=4.126070e-001; ng(n+1)=6.111964e+002;
n=21; farx(n+1)=3.254099e+000; foe(n+1)=2.720382e+001; krok(n+1)=5.043730e-001; ng(n+1)=7.739698e+002;
n=22; farx(n+1)=2.441865e+000; foe(n+1)=2.612827e+001; krok(n+1)=1.362644e-001; ng(n+1)=1.003252e+003;
n=23; farx(n+1)=2.633378e+000; foe(n+1)=2.317902e+001; krok(n+1)=2.828655e-001; ng(n+1)=9.187979e+002;
n=24; farx(n+1)=2.455216e+000; foe(n+1)=2.268989e+001; krok(n+1)=6.954939e-001; ng(n+1)=4.037658e+002;
n=25; farx(n+1)=2.658699e+000; foe(n+1)=2.203065e+001; krok(n+1)=8.131859e-001; ng(n+1)=4.263018e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.247783e+000; foe(n+1)=2.110984e+001; krok(n+1)=2.253084e-005; ng(n+1)=5.125980e+002;
n=27; farx(n+1)=2.094367e+000; foe(n+1)=2.070256e+001; krok(n+1)=8.468871e-006; ng(n+1)=5.395338e+002;
n=28; farx(n+1)=2.062509e+000; foe(n+1)=1.835996e+001; krok(n+1)=1.387045e-003; ng(n+1)=8.905987e+001;
n=29; farx(n+1)=2.071423e+000; foe(n+1)=1.629025e+001; krok(n+1)=3.179535e-004; ng(n+1)=1.815964e+002;
n=30; farx(n+1)=2.051927e+000; foe(n+1)=1.582562e+001; krok(n+1)=3.426502e-003; ng(n+1)=1.932440e+002;
n=31; farx(n+1)=1.806028e+000; foe(n+1)=1.541056e+001; krok(n+1)=3.556534e-002; ng(n+1)=4.881084e+002;
n=32; farx(n+1)=1.307194e+000; foe(n+1)=1.482748e+001; krok(n+1)=4.725510e-002; ng(n+1)=4.142901e+002;
n=33; farx(n+1)=1.080784e+000; foe(n+1)=1.298545e+001; krok(n+1)=1.356405e+000; ng(n+1)=4.704531e+002;
n=34; farx(n+1)=1.051382e+000; foe(n+1)=1.287601e+001; krok(n+1)=9.137743e-002; ng(n+1)=2.538235e+002;
n=35; farx(n+1)=1.042105e+000; foe(n+1)=1.238928e+001; krok(n+1)=4.773765e-002; ng(n+1)=2.655211e+002;
n=36; farx(n+1)=9.596291e-001; foe(n+1)=1.130068e+001; krok(n+1)=1.032026e-001; ng(n+1)=2.057766e+002;
n=37; farx(n+1)=9.507411e-001; foe(n+1)=1.058855e+001; krok(n+1)=6.751168e-001; ng(n+1)=3.715826e+002;
n=38; farx(n+1)=9.104445e-001; foe(n+1)=1.026790e+001; krok(n+1)=2.367770e-001; ng(n+1)=3.338754e+002;
n=39; farx(n+1)=9.029474e-001; foe(n+1)=9.878071e+000; krok(n+1)=1.068393e+000; ng(n+1)=1.422947e+002;
n=40; farx(n+1)=8.788585e-001; foe(n+1)=9.779672e+000; krok(n+1)=4.485036e-001; ng(n+1)=1.928702e+002;
n=41; farx(n+1)=8.608409e-001; foe(n+1)=9.663596e+000; krok(n+1)=1.002885e+000; ng(n+1)=2.592259e+002;
n=42; farx(n+1)=8.641350e-001; foe(n+1)=9.567434e+000; krok(n+1)=6.749097e-001; ng(n+1)=4.510322e+001;
n=43; farx(n+1)=8.617832e-001; foe(n+1)=9.537870e+000; krok(n+1)=6.762233e-001; ng(n+1)=9.528104e+001;
n=44; farx(n+1)=8.422879e-001; foe(n+1)=9.493807e+000; krok(n+1)=2.081446e+000; ng(n+1)=1.478822e+002;
n=45; farx(n+1)=8.366686e-001; foe(n+1)=9.477582e+000; krok(n+1)=6.022096e-001; ng(n+1)=1.390118e+002;
n=46; farx(n+1)=8.298576e-001; foe(n+1)=9.460091e+000; krok(n+1)=1.818906e+000; ng(n+1)=3.748076e+001;
n=47; farx(n+1)=8.110217e-001; foe(n+1)=9.446412e+000; krok(n+1)=2.845490e+000; ng(n+1)=5.217349e+001;
n=48; farx(n+1)=8.070876e-001; foe(n+1)=9.439334e+000; krok(n+1)=1.659005e+000; ng(n+1)=4.481784e+001;
n=49; farx(n+1)=8.017292e-001; foe(n+1)=9.433919e+000; krok(n+1)=1.650428e+000; ng(n+1)=5.680222e+001;
n=50; farx(n+1)=8.019935e-001; foe(n+1)=9.431679e+000; krok(n+1)=1.133514e+000; ng(n+1)=7.729911e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=8.020425e-001; foe(n+1)=9.431641e+000; krok(n+1)=3.065064e-006; ng(n+1)=8.718126e+000;
n=52; farx(n+1)=8.019316e-001; foe(n+1)=9.431627e+000; krok(n+1)=1.489745e-005; ng(n+1)=2.134711e+000;
n=53; farx(n+1)=8.013345e-001; foe(n+1)=9.431545e+000; krok(n+1)=1.098766e-004; ng(n+1)=1.816738e+000;
n=54; farx(n+1)=8.026515e-001; foe(n+1)=9.429497e+000; krok(n+1)=1.775201e-003; ng(n+1)=2.439590e+000;
n=55; farx(n+1)=7.959735e-001; foe(n+1)=9.427828e+000; krok(n+1)=7.990988e-003; ng(n+1)=1.044357e+000;
n=56; farx(n+1)=7.727913e-001; foe(n+1)=9.421683e+000; krok(n+1)=9.809225e-002; ng(n+1)=6.832042e-001;
n=57; farx(n+1)=7.574705e-001; foe(n+1)=9.417142e+000; krok(n+1)=1.232694e-001; ng(n+1)=5.450014e-001;
n=58; farx(n+1)=7.471283e-001; foe(n+1)=9.415598e+000; krok(n+1)=1.817806e+000; ng(n+1)=1.594322e+001;
n=59; farx(n+1)=7.423292e-001; foe(n+1)=9.415439e+000; krok(n+1)=8.773192e-001; ng(n+1)=4.373724e+000;
n=60; farx(n+1)=7.411248e-001; foe(n+1)=9.415427e+000; krok(n+1)=1.031099e+000; ng(n+1)=2.210511e+000;
n=61; farx(n+1)=7.409021e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.104103e+000; ng(n+1)=4.505703e-001;
n=62; farx(n+1)=7.409267e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.380032e+000; ng(n+1)=9.706626e-002;
n=63; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.876215e-001; ng(n+1)=2.794852e-002;
n=64; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.352749e-006; ng(n+1)=1.206715e-003;
n=65; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.407210e-008; ng(n+1)=1.206712e-003;
n=66; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.522364e-008; ng(n+1)=1.206712e-003;
n=67; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.679399e-008; ng(n+1)=1.206712e-003;
n=68; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.021083e-006; ng(n+1)=1.206712e-003;
n=69; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.343560e-007; ng(n+1)=1.206708e-003;
n=70; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.448771e-006; ng(n+1)=1.206708e-003;
n=71; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.225594e-010; ng(n+1)=1.206702e-003;
n=72; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.150021e-006; ng(n+1)=1.206702e-003;
n=73; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.698517e-006; ng(n+1)=1.206696e-003;
n=74; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.597736e-006; ng(n+1)=1.206691e-003;
n=75; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.586175e-008; ng(n+1)=1.206681e-003;
%odnowa zmiennej metryki
n=76; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.976235e-006; ng(n+1)=1.206681e-003;
n=77; farx(n+1)=7.409275e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.300043e-006; ng(n+1)=8.330987e-004;
n=78; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.762712e-005; ng(n+1)=1.265964e-004;
n=79; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.951202e-005; ng(n+1)=7.984071e-005;
n=80; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.211563e-006; ng(n+1)=7.935004e-005;
n=81; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.752144e-006; ng(n+1)=7.934959e-005;
n=82; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.384230e-006; ng(n+1)=7.934873e-005;
n=83; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.671012e-006; ng(n+1)=7.934860e-005;
n=84; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.982719e-009; ng(n+1)=7.934822e-005;
n=85; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.604127e-009; ng(n+1)=7.934823e-005;
n=86; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.290920e-011; ng(n+1)=7.934823e-005;
n=87; farx(n+1)=7.409276e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.992830e-009; ng(n+1)=7.934823e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
