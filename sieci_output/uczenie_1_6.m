%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.757471e+002; foe(n+1)=6.636777e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.231827e+002; foe(n+1)=6.141531e+002; krok(n+1)=5.157835e-004; ng(n+1)=4.386642e+002;
n=2; farx(n+1)=1.929523e+002; foe(n+1)=1.848770e+002; krok(n+1)=3.388472e-002; ng(n+1)=9.216467e+001;
n=3; farx(n+1)=1.793623e+002; foe(n+1)=1.800377e+002; krok(n+1)=1.131031e-002; ng(n+1)=7.378094e+001;
n=4; farx(n+1)=1.710011e+002; foe(n+1)=1.777899e+002; krok(n+1)=1.889294e-003; ng(n+1)=8.805373e+001;
n=5; farx(n+1)=1.494185e+002; foe(n+1)=1.733254e+002; krok(n+1)=1.251065e-002; ng(n+1)=8.452901e+001;
n=6; farx(n+1)=1.611291e+002; foe(n+1)=1.643401e+002; krok(n+1)=3.711420e-001; ng(n+1)=4.196944e+001;
n=7; farx(n+1)=1.601527e+002; foe(n+1)=1.641379e+002; krok(n+1)=3.052860e-002; ng(n+1)=3.636952e+001;
n=8; farx(n+1)=5.943762e+001; foe(n+1)=1.241282e+002; krok(n+1)=1.754638e+000; ng(n+1)=4.330410e+001;
n=9; farx(n+1)=5.881762e+001; foe(n+1)=1.239936e+002; krok(n+1)=1.597633e-003; ng(n+1)=1.868043e+002;
n=10; farx(n+1)=5.478456e+001; foe(n+1)=1.138344e+002; krok(n+1)=5.856145e-001; ng(n+1)=2.489893e+002;
n=11; farx(n+1)=5.167981e+001; foe(n+1)=1.084697e+002; krok(n+1)=1.951976e-001; ng(n+1)=2.200573e+002;
n=12; farx(n+1)=4.484217e+001; foe(n+1)=9.384222e+001; krok(n+1)=1.534454e-001; ng(n+1)=1.013569e+003;
n=13; farx(n+1)=3.398684e+001; foe(n+1)=8.098879e+001; krok(n+1)=3.735325e-001; ng(n+1)=6.857638e+002;
n=14; farx(n+1)=2.051216e+001; foe(n+1)=6.611404e+001; krok(n+1)=3.903951e-001; ng(n+1)=6.742812e+002;
n=15; farx(n+1)=1.719660e+001; foe(n+1)=5.756434e+001; krok(n+1)=1.232067e+000; ng(n+1)=8.426762e+002;
n=16; farx(n+1)=1.488104e+001; foe(n+1)=5.363667e+001; krok(n+1)=2.286351e-001; ng(n+1)=2.455684e+002;
n=17; farx(n+1)=1.034137e+001; foe(n+1)=4.536927e+001; krok(n+1)=3.333343e-001; ng(n+1)=8.152105e+002;
n=18; farx(n+1)=9.411192e+000; foe(n+1)=4.153198e+001; krok(n+1)=1.057059e-001; ng(n+1)=7.689470e+002;
n=19; farx(n+1)=6.014897e+000; foe(n+1)=3.265289e+001; krok(n+1)=5.154350e-001; ng(n+1)=4.929787e+002;
n=20; farx(n+1)=5.884239e+000; foe(n+1)=2.915439e+001; krok(n+1)=1.382584e+000; ng(n+1)=6.806466e+002;
n=21; farx(n+1)=3.078142e+000; foe(n+1)=2.434778e+001; krok(n+1)=1.617795e+000; ng(n+1)=3.636901e+002;
n=22; farx(n+1)=2.313838e+000; foe(n+1)=2.156605e+001; krok(n+1)=7.262643e-002; ng(n+1)=7.040741e+002;
n=23; farx(n+1)=2.267031e+000; foe(n+1)=1.933363e+001; krok(n+1)=2.497735e-001; ng(n+1)=4.186192e+002;
n=24; farx(n+1)=2.136215e+000; foe(n+1)=1.861246e+001; krok(n+1)=4.112198e-001; ng(n+1)=2.892289e+002;
n=25; farx(n+1)=2.192529e+000; foe(n+1)=1.799443e+001; krok(n+1)=8.536620e-001; ng(n+1)=2.369517e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.184435e+000; foe(n+1)=1.778087e+001; krok(n+1)=6.005855e-006; ng(n+1)=3.420474e+002;
n=27; farx(n+1)=2.101293e+000; foe(n+1)=1.759247e+001; krok(n+1)=4.963293e-005; ng(n+1)=1.475078e+002;
n=28; farx(n+1)=2.137114e+000; foe(n+1)=1.752987e+001; krok(n+1)=2.351766e-004; ng(n+1)=3.913555e+001;
n=29; farx(n+1)=2.189309e+000; foe(n+1)=1.695698e+001; krok(n+1)=2.883948e-003; ng(n+1)=3.065513e+001;
n=30; farx(n+1)=2.092933e+000; foe(n+1)=1.646745e+001; krok(n+1)=6.446985e-003; ng(n+1)=1.559300e+002;
n=31; farx(n+1)=1.911024e+000; foe(n+1)=1.629452e+001; krok(n+1)=1.873553e-002; ng(n+1)=1.996187e+002;
n=32; farx(n+1)=1.609238e+000; foe(n+1)=1.594730e+001; krok(n+1)=7.178738e-001; ng(n+1)=2.705752e+002;
n=33; farx(n+1)=1.780496e+000; foe(n+1)=1.576428e+001; krok(n+1)=1.592896e-001; ng(n+1)=2.832664e+002;
n=34; farx(n+1)=1.682061e+000; foe(n+1)=1.545126e+001; krok(n+1)=7.011953e-001; ng(n+1)=3.389594e+002;
n=35; farx(n+1)=1.594933e+000; foe(n+1)=1.514098e+001; krok(n+1)=5.154350e-001; ng(n+1)=1.029986e+002;
n=36; farx(n+1)=1.517672e+000; foe(n+1)=1.502808e+001; krok(n+1)=6.857223e-001; ng(n+1)=1.400662e+002;
n=37; farx(n+1)=1.476608e+000; foe(n+1)=1.486551e+001; krok(n+1)=1.371110e+000; ng(n+1)=2.273218e+002;
n=38; farx(n+1)=1.448106e+000; foe(n+1)=1.472667e+001; krok(n+1)=7.382907e-001; ng(n+1)=1.446626e+002;
n=39; farx(n+1)=1.310596e+000; foe(n+1)=1.467766e+001; krok(n+1)=1.274317e+000; ng(n+1)=9.563004e+001;
n=40; farx(n+1)=1.242890e+000; foe(n+1)=1.460890e+001; krok(n+1)=1.158471e+000; ng(n+1)=8.618201e+001;
n=41; farx(n+1)=1.252765e+000; foe(n+1)=1.459109e+001; krok(n+1)=2.656312e-001; ng(n+1)=1.633386e+002;
n=42; farx(n+1)=1.239737e+000; foe(n+1)=1.457423e+001; krok(n+1)=5.989693e-001; ng(n+1)=4.799675e+001;
n=43; farx(n+1)=1.167876e+000; foe(n+1)=1.455806e+001; krok(n+1)=7.289469e-001; ng(n+1)=3.468386e+001;
n=44; farx(n+1)=1.098814e+000; foe(n+1)=1.454836e+001; krok(n+1)=7.386536e-001; ng(n+1)=8.818433e+001;
n=45; farx(n+1)=1.104987e+000; foe(n+1)=1.454078e+001; krok(n+1)=9.469203e-001; ng(n+1)=3.476651e+001;
n=46; farx(n+1)=1.077140e+000; foe(n+1)=1.453168e+001; krok(n+1)=5.429402e-001; ng(n+1)=1.470948e+001;
n=47; farx(n+1)=1.064052e+000; foe(n+1)=1.452833e+001; krok(n+1)=1.078611e+000; ng(n+1)=4.391739e+001;
n=48; farx(n+1)=1.056467e+000; foe(n+1)=1.452569e+001; krok(n+1)=1.090364e+000; ng(n+1)=3.240516e+001;
n=49; farx(n+1)=1.043673e+000; foe(n+1)=1.452497e+001; krok(n+1)=5.596492e-001; ng(n+1)=2.291284e+001;
n=50; farx(n+1)=1.042165e+000; foe(n+1)=1.452447e+001; krok(n+1)=1.707324e+000; ng(n+1)=8.591532e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.042426e+000; foe(n+1)=1.452441e+001; krok(n+1)=6.542741e-006; ng(n+1)=7.386807e+000;
n=52; farx(n+1)=1.042566e+000; foe(n+1)=1.452436e+001; krok(n+1)=3.819098e-006; ng(n+1)=8.598401e+000;
n=53; farx(n+1)=1.042949e+000; foe(n+1)=1.452433e+001; krok(n+1)=4.661880e-005; ng(n+1)=1.850474e+000;
n=54; farx(n+1)=1.042919e+000; foe(n+1)=1.452375e+001; krok(n+1)=2.476023e-003; ng(n+1)=1.097019e+000;
n=55; farx(n+1)=1.031637e+000; foe(n+1)=1.452349e+001; krok(n+1)=1.688579e-002; ng(n+1)=3.054778e-001;
n=56; farx(n+1)=1.032746e+000; foe(n+1)=1.452318e+001; krok(n+1)=8.892157e-002; ng(n+1)=4.246372e-001;
n=57; farx(n+1)=9.973836e-001; foe(n+1)=1.452212e+001; krok(n+1)=4.442530e-001; ng(n+1)=1.145825e+000;
n=58; farx(n+1)=9.892453e-001; foe(n+1)=1.452192e+001; krok(n+1)=1.498210e+000; ng(n+1)=9.113630e+000;
n=59; farx(n+1)=9.844135e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.007999e+000; ng(n+1)=3.980817e+000;
n=60; farx(n+1)=9.844974e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.386536e-001; ng(n+1)=1.524664e+000;
n=61; farx(n+1)=9.840286e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.002692e+000; ng(n+1)=1.616857e-001;
n=62; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.765516e-001; ng(n+1)=4.650882e-002;
n=63; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.077173e-005; ng(n+1)=3.480937e-003;
n=64; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.416371e-005; ng(n+1)=3.480903e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=65; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.729350e-006; ng(n+1)=3.480854e-003;
n=66; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.209447e-005; ng(n+1)=6.277048e-004;
n=67; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.757294e-005; ng(n+1)=1.545149e-004;
n=68; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.006605e-008; ng(n+1)=8.266138e-005;
n=69; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.150304e-006; ng(n+1)=8.266198e-005;
n=70; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.349696e-006; ng(n+1)=8.265243e-005;
n=71; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.793088e-008; ng(n+1)=8.265233e-005;
n=72; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.566562e-006; ng(n+1)=8.265234e-005;
n=73; farx(n+1)=9.839907e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.243277e-006; ng(n+1)=8.265139e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
