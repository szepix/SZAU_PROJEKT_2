%uczenie predyktora oe
clear all;
n=0; farx(n+1)=9.119036e+002; foe(n+1)=9.244643e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=8.892133e+002; foe(n+1)=9.035581e+002; krok(n+1)=7.459007e-004; ng(n+1)=2.984494e+002;
n=2; farx(n+1)=3.050718e+002; foe(n+1)=3.223623e+002; krok(n+1)=7.531622e-003; ng(n+1)=3.014042e+002;
n=3; farx(n+1)=2.915444e+002; foe(n+1)=2.874592e+002; krok(n+1)=9.208067e-004; ng(n+1)=1.047891e+003;
n=4; farx(n+1)=2.832588e+002; foe(n+1)=2.644941e+002; krok(n+1)=2.519327e-003; ng(n+1)=8.708934e+002;
n=5; farx(n+1)=6.877982e+002; foe(n+1)=2.450098e+002; krok(n+1)=5.123880e-002; ng(n+1)=7.414285e+002;
n=6; farx(n+1)=6.437890e+002; foe(n+1)=2.287307e+002; krok(n+1)=2.193298e-001; ng(n+1)=3.544330e+002;
n=7; farx(n+1)=2.725085e+002; foe(n+1)=1.966977e+002; krok(n+1)=4.317671e-001; ng(n+1)=3.361414e+002;
n=8; farx(n+1)=3.546367e+002; foe(n+1)=1.734086e+002; krok(n+1)=4.372988e-001; ng(n+1)=4.429240e+002;
n=9; farx(n+1)=2.433559e+002; foe(n+1)=1.665455e+002; krok(n+1)=7.021280e-001; ng(n+1)=8.685985e+001;
n=10; farx(n+1)=1.268214e+002; foe(n+1)=1.529052e+002; krok(n+1)=2.804781e+000; ng(n+1)=1.216550e+002;
n=11; farx(n+1)=1.009388e+002; foe(n+1)=1.493798e+002; krok(n+1)=9.513510e-002; ng(n+1)=1.497676e+002;
n=12; farx(n+1)=1.059846e+002; foe(n+1)=1.398813e+002; krok(n+1)=5.738785e-001; ng(n+1)=3.077469e+002;
n=13; farx(n+1)=6.878332e+001; foe(n+1)=1.159169e+002; krok(n+1)=1.854055e+000; ng(n+1)=2.743523e+002;
n=14; farx(n+1)=6.293625e+001; foe(n+1)=1.141436e+002; krok(n+1)=9.363811e-002; ng(n+1)=2.496109e+002;
n=15; farx(n+1)=3.126856e+001; foe(n+1)=1.001091e+002; krok(n+1)=2.098654e-001; ng(n+1)=2.470739e+002;
n=16; farx(n+1)=2.078002e+001; foe(n+1)=9.655985e+001; krok(n+1)=3.106282e-001; ng(n+1)=2.740394e+002;
n=17; farx(n+1)=1.742924e+001; foe(n+1)=9.314460e+001; krok(n+1)=2.477353e-002; ng(n+1)=6.357315e+002;
n=18; farx(n+1)=1.295928e+001; foe(n+1)=7.300591e+001; krok(n+1)=2.623123e-001; ng(n+1)=6.101760e+002;
n=19; farx(n+1)=1.395501e+001; foe(n+1)=6.572835e+001; krok(n+1)=1.516671e-001; ng(n+1)=6.592665e+002;
n=20; farx(n+1)=1.390650e+001; foe(n+1)=5.716810e+001; krok(n+1)=2.711458e-001; ng(n+1)=5.437322e+002;
n=21; farx(n+1)=1.253273e+001; foe(n+1)=5.323037e+001; krok(n+1)=3.745525e-001; ng(n+1)=6.739320e+002;
n=22; farx(n+1)=1.101125e+001; foe(n+1)=5.003350e+001; krok(n+1)=5.134806e-001; ng(n+1)=2.920999e+002;
n=23; farx(n+1)=6.195572e+000; foe(n+1)=3.891665e+001; krok(n+1)=1.462039e+000; ng(n+1)=7.558903e+002;
n=24; farx(n+1)=6.592215e+000; foe(n+1)=3.577125e+001; krok(n+1)=1.372747e-001; ng(n+1)=4.170674e+002;
n=25; farx(n+1)=5.402995e+000; foe(n+1)=3.312522e+001; krok(n+1)=4.423764e-001; ng(n+1)=5.037088e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.313057e+000; foe(n+1)=3.209323e+001; krok(n+1)=1.729605e-005; ng(n+1)=5.145032e+002;
n=27; farx(n+1)=4.665533e+000; foe(n+1)=3.131819e+001; krok(n+1)=1.241749e-004; ng(n+1)=1.738972e+002;
n=28; farx(n+1)=4.631245e+000; foe(n+1)=2.993614e+001; krok(n+1)=2.896249e-004; ng(n+1)=1.531278e+002;
n=29; farx(n+1)=4.755640e+000; foe(n+1)=2.566285e+001; krok(n+1)=2.320282e-003; ng(n+1)=1.433589e+002;
n=30; farx(n+1)=4.723032e+000; foe(n+1)=2.542990e+001; krok(n+1)=1.945533e-003; ng(n+1)=3.679987e+002;
n=31; farx(n+1)=4.805659e+000; foe(n+1)=2.508526e+001; krok(n+1)=1.023953e-002; ng(n+1)=4.017655e+002;
n=32; farx(n+1)=2.683562e+000; foe(n+1)=2.179485e+001; krok(n+1)=2.818076e-001; ng(n+1)=4.673438e+002;
n=33; farx(n+1)=1.720081e+000; foe(n+1)=1.691474e+001; krok(n+1)=1.814761e+000; ng(n+1)=5.430608e+002;
n=34; farx(n+1)=1.330327e+000; foe(n+1)=1.480650e+001; krok(n+1)=3.550835e-001; ng(n+1)=4.019710e+002;
n=35; farx(n+1)=1.250240e+000; foe(n+1)=1.378189e+001; krok(n+1)=2.268451e-001; ng(n+1)=4.146601e+002;
n=36; farx(n+1)=1.092122e+000; foe(n+1)=1.318008e+001; krok(n+1)=2.624788e-001; ng(n+1)=5.748854e+002;
n=37; farx(n+1)=1.072352e+000; foe(n+1)=1.294717e+001; krok(n+1)=1.409038e-001; ng(n+1)=3.788524e+002;
n=38; farx(n+1)=9.827614e-001; foe(n+1)=1.201030e+001; krok(n+1)=8.316025e-001; ng(n+1)=2.763511e+002;
n=39; farx(n+1)=9.603568e-001; foe(n+1)=1.095948e+001; krok(n+1)=3.903951e-001; ng(n+1)=1.236471e+002;
n=40; farx(n+1)=9.086080e-001; foe(n+1)=1.056920e+001; krok(n+1)=6.698571e-001; ng(n+1)=2.245859e+002;
n=41; farx(n+1)=8.926283e-001; foe(n+1)=1.033496e+001; krok(n+1)=2.022243e-001; ng(n+1)=2.525055e+002;
n=42; farx(n+1)=8.568826e-001; foe(n+1)=1.005318e+001; krok(n+1)=5.343541e-001; ng(n+1)=4.839374e+002;
n=43; farx(n+1)=8.593810e-001; foe(n+1)=9.779628e+000; krok(n+1)=1.754638e+000; ng(n+1)=1.742467e+002;
n=44; farx(n+1)=8.444153e-001; foe(n+1)=9.679847e+000; krok(n+1)=5.631821e-001; ng(n+1)=1.842948e+002;
n=45; farx(n+1)=8.238294e-001; foe(n+1)=9.565081e+000; krok(n+1)=9.112329e-001; ng(n+1)=7.158045e+001;
n=46; farx(n+1)=8.110283e-001; foe(n+1)=9.520080e+000; krok(n+1)=1.111741e+000; ng(n+1)=2.171071e+002;
n=47; farx(n+1)=8.003880e-001; foe(n+1)=9.474719e+000; krok(n+1)=1.516744e+000; ng(n+1)=9.900809e+001;
n=48; farx(n+1)=7.956707e-001; foe(n+1)=9.460387e+000; krok(n+1)=4.555491e-001; ng(n+1)=6.116656e+001;
n=49; farx(n+1)=7.903860e-001; foe(n+1)=9.448476e+000; krok(n+1)=1.162605e+000; ng(n+1)=1.045594e+002;
n=50; farx(n+1)=7.750563e-001; foe(n+1)=9.437885e+000; krok(n+1)=2.137416e+000; ng(n+1)=5.157088e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=7.749192e-001; foe(n+1)=9.437020e+000; krok(n+1)=9.622040e-006; ng(n+1)=2.198075e+001;
n=52; farx(n+1)=7.755647e-001; foe(n+1)=9.436565e+000; krok(n+1)=5.693344e-006; ng(n+1)=1.883903e+001;
n=53; farx(n+1)=7.777165e-001; foe(n+1)=9.435336e+000; krok(n+1)=2.343658e-005; ng(n+1)=1.562327e+001;
n=54; farx(n+1)=7.641275e-001; foe(n+1)=9.419381e+000; krok(n+1)=2.388016e-003; ng(n+1)=5.555975e+000;
n=55; farx(n+1)=7.641686e-001; foe(n+1)=9.417706e+000; krok(n+1)=2.812841e-002; ng(n+1)=1.675587e+000;
n=56; farx(n+1)=7.577008e-001; foe(n+1)=9.416592e+000; krok(n+1)=3.459424e-002; ng(n+1)=4.176493e+000;
n=57; farx(n+1)=7.432546e-001; foe(n+1)=9.415491e+000; krok(n+1)=3.891962e-001; ng(n+1)=7.392309e+000;
n=58; farx(n+1)=7.412759e-001; foe(n+1)=9.415427e+000; krok(n+1)=1.224301e+000; ng(n+1)=6.488302e+000;
n=59; farx(n+1)=7.409519e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.155850e+000; ng(n+1)=4.010969e-001;
n=60; farx(n+1)=7.409242e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.074846e+000; ng(n+1)=6.992400e-002;
n=61; farx(n+1)=7.409242e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.728399e-010; ng(n+1)=1.328021e-002;
 % z³y kierunek w metodzie zm - odnowa 
n=62; farx(n+1)=7.409242e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.685539e-006; ng(n+1)=1.328021e-002;
n=63; farx(n+1)=7.409243e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.308338e-006; ng(n+1)=5.860677e-003;
n=64; farx(n+1)=7.409241e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.294446e-005; ng(n+1)=1.026465e-003;
n=65; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.603714e-003; ng(n+1)=3.413211e-004;
n=66; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.384727e-010; ng(n+1)=6.583650e-005;
n=67; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.510969e-011; ng(n+1)=6.583650e-005;
n=68; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.602457e-006; ng(n+1)=6.583650e-005;
n=69; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.226382e-006; ng(n+1)=6.583465e-005;
n=70; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.758671e-006; ng(n+1)=6.582296e-005;
n=71; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.779509e-005; ng(n+1)=6.583817e-005;
n=72; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.892703e-007; ng(n+1)=6.582924e-005;
n=73; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.344143e-006; ng(n+1)=6.582924e-005;
n=74; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.430061e-005; ng(n+1)=6.582908e-005;
n=75; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.189792e-006; ng(n+1)=6.582763e-005;
%odnowa zmiennej metryki
n=76; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.430061e-005; ng(n+1)=6.582721e-005;
n=77; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.639991e-005; ng(n+1)=1.907863e-004;
n=78; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.698743e-005; ng(n+1)=2.060898e-004;
n=79; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.192369e-003; ng(n+1)=1.134336e-004;
n=80; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.639991e-005; ng(n+1)=9.943965e-005;
n=81; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.209447e-005; ng(n+1)=9.928576e-005;
n=82; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.069939e-005; ng(n+1)=9.928100e-005;
n=83; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.150304e-006; ng(n+1)=9.927971e-005;
n=84; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.283312e-007; ng(n+1)=9.927896e-005;
n=85; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.179742e-011; ng(n+1)=9.927895e-005;
n=86; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.150304e-006; ng(n+1)=9.927895e-005;
n=87; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.349696e-006; ng(n+1)=9.922883e-005;
n=88; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.801229e-006; ng(n+1)=9.923296e-005;
n=89; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.254168e-007; ng(n+1)=9.923216e-005;
n=90; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.109377e-007; ng(n+1)=9.923194e-005;
n=91; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.975173e-010; ng(n+1)=9.923190e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=92; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.357975e-012; ng(n+1)=9.923190e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=93; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.999891e-009; ng(n+1)=9.923190e-005;
n=94; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.279756e-005; ng(n+1)=9.918636e-005;
n=95; farx(n+1)=7.409247e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.727205e-006; ng(n+1)=3.701133e-004;
n=96; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.235047e-004; ng(n+1)=1.804744e-004;
n=97; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.749849e-006; ng(n+1)=1.553628e-004;
n=98; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.298869e-005; ng(n+1)=1.553604e-004;
n=99; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.139878e-005; ng(n+1)=1.553505e-004;
n=100; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.215855e-005; ng(n+1)=1.553446e-004;
%odnowa zmiennej metryki
n=101; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.204914e-006; ng(n+1)=1.553426e-004;
n=102; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.424686e-005; ng(n+1)=1.094412e-004;
n=103; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.016423e-005; ng(n+1)=2.005610e-004;
n=104; farx(n+1)=7.409250e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.675577e-005; ng(n+1)=1.999889e-004;
n=105; farx(n+1)=7.409250e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.290553e-005; ng(n+1)=4.076081e-004;
n=106; farx(n+1)=7.409250e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.089046e-005; ng(n+1)=4.075944e-004;
n=107; farx(n+1)=7.409250e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.024995e-006; ng(n+1)=4.075862e-004;
n=108; farx(n+1)=7.409250e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.315661e-007; ng(n+1)=4.075855e-004;
n=109; farx(n+1)=7.409250e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.323895e-007; ng(n+1)=4.075852e-004;
n=110; farx(n+1)=7.409250e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.891890e-010; ng(n+1)=4.075850e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=111; farx(n+1)=7.409250e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.063575e-006; ng(n+1)=4.075850e-004;
n=112; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.639991e-005; ng(n+1)=3.877912e-004;
n=113; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.430061e-005; ng(n+1)=3.933767e-004;
n=114; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.504753e-005; ng(n+1)=8.497535e-005;
n=115; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.047236e-006; ng(n+1)=8.493602e-005;
n=116; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=9.841122e-006; ng(n+1)=8.493995e-005;
n=117; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.315661e-007; ng(n+1)=8.493727e-005;
n=118; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.026605e-006; ng(n+1)=8.493713e-005;
n=119; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.059525e-006; ng(n+1)=8.493695e-005;
n=120; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.990865e-009; ng(n+1)=8.493687e-005;
n=121; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.315971e-011; ng(n+1)=8.493686e-005;
n=122; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.114224e-011; ng(n+1)=8.493685e-005;
n=123; farx(n+1)=7.409249e-001; foe(n+1)=9.415426e+000; krok(n+1)=6.131313e-011; ng(n+1)=8.493686e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
