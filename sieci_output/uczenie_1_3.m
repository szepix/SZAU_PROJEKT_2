%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.249624e+002; foe(n+1)=6.185949e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.124742e+002; foe(n+1)=6.054844e+002; krok(n+1)=7.937301e-004; ng(n+1)=2.349394e+002;
n=2; farx(n+1)=2.959466e+002; foe(n+1)=2.860175e+002; krok(n+1)=7.152527e-003; ng(n+1)=2.392278e+002;
n=3; farx(n+1)=2.861026e+002; foe(n+1)=2.615362e+002; krok(n+1)=1.473014e-003; ng(n+1)=7.615008e+002;
n=4; farx(n+1)=2.939486e+002; foe(n+1)=2.503653e+002; krok(n+1)=4.259233e-003; ng(n+1)=6.526370e+002;
n=5; farx(n+1)=5.983710e+002; foe(n+1)=2.355008e+002; krok(n+1)=4.703530e-002; ng(n+1)=5.259224e+002;
n=6; farx(n+1)=6.098342e+002; foe(n+1)=2.254532e+002; krok(n+1)=1.112197e-001; ng(n+1)=1.936305e+002;
n=7; farx(n+1)=5.479382e+002; foe(n+1)=2.217548e+002; krok(n+1)=7.165516e-002; ng(n+1)=1.686903e+002;
n=8; farx(n+1)=1.233486e+002; foe(n+1)=1.875680e+002; krok(n+1)=1.548833e+000; ng(n+1)=1.899879e+002;
n=9; farx(n+1)=7.932143e+001; foe(n+1)=1.771790e+002; krok(n+1)=4.446078e-002; ng(n+1)=2.292960e+002;
n=10; farx(n+1)=7.577543e+001; foe(n+1)=1.664064e+002; krok(n+1)=1.420059e-001; ng(n+1)=2.990662e+002;
n=11; farx(n+1)=7.659331e+001; foe(n+1)=1.432594e+002; krok(n+1)=7.178738e-001; ng(n+1)=4.857048e+002;
n=12; farx(n+1)=6.409361e+001; foe(n+1)=1.355198e+002; krok(n+1)=2.416053e-001; ng(n+1)=4.596152e+002;
n=13; farx(n+1)=2.954156e+001; foe(n+1)=1.004437e+002; krok(n+1)=2.465387e-001; ng(n+1)=2.549435e+002;
n=14; farx(n+1)=2.788834e+001; foe(n+1)=9.551557e+001; krok(n+1)=1.178633e-001; ng(n+1)=7.746027e+002;
n=15; farx(n+1)=2.879873e+001; foe(n+1)=7.776412e+001; krok(n+1)=4.294671e-002; ng(n+1)=1.884240e+003;
n=16; farx(n+1)=3.000280e+001; foe(n+1)=7.271957e+001; krok(n+1)=2.193298e-001; ng(n+1)=4.763959e+002;
n=17; farx(n+1)=2.832466e+001; foe(n+1)=7.160413e+001; krok(n+1)=1.259999e-001; ng(n+1)=1.910260e+002;
n=18; farx(n+1)=1.842263e+001; foe(n+1)=6.003854e+001; krok(n+1)=1.204419e+000; ng(n+1)=6.615424e+002;
n=19; farx(n+1)=1.506125e+001; foe(n+1)=5.566307e+001; krok(n+1)=4.004429e-001; ng(n+1)=2.632809e+002;
n=20; farx(n+1)=1.288824e+001; foe(n+1)=4.962405e+001; krok(n+1)=3.096904e-001; ng(n+1)=1.096608e+003;
n=21; farx(n+1)=1.086409e+001; foe(n+1)=4.539631e+001; krok(n+1)=1.613595e+000; ng(n+1)=8.163981e+002;
n=22; farx(n+1)=1.067568e+001; foe(n+1)=4.206598e+001; krok(n+1)=4.150498e-001; ng(n+1)=1.528198e+002;
n=23; farx(n+1)=8.563094e+000; foe(n+1)=3.727333e+001; krok(n+1)=1.492366e+000; ng(n+1)=3.731960e+002;
n=24; farx(n+1)=6.247443e+000; foe(n+1)=3.134934e+001; krok(n+1)=1.322970e+000; ng(n+1)=2.936287e+002;
n=25; farx(n+1)=5.584515e+000; foe(n+1)=2.736197e+001; krok(n+1)=4.027995e-001; ng(n+1)=8.751819e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.374750e+000; foe(n+1)=2.696703e+001; krok(n+1)=3.185772e-004; ng(n+1)=8.951207e+001;
n=27; farx(n+1)=5.280565e+000; foe(n+1)=2.684106e+001; krok(n+1)=1.259177e-005; ng(n+1)=1.585643e+002;
n=28; farx(n+1)=5.315830e+000; foe(n+1)=2.619683e+001; krok(n+1)=2.852628e-004; ng(n+1)=1.151529e+002;
n=29; farx(n+1)=4.649914e+000; foe(n+1)=2.433939e+001; krok(n+1)=6.326141e-004; ng(n+1)=1.199429e+002;
n=30; farx(n+1)=4.841466e+000; foe(n+1)=2.386636e+001; krok(n+1)=5.269205e-003; ng(n+1)=5.024002e+002;
n=31; farx(n+1)=4.208972e+000; foe(n+1)=2.316839e+001; krok(n+1)=7.115888e-002; ng(n+1)=6.100736e+002;
n=32; farx(n+1)=3.325510e+000; foe(n+1)=2.234639e+001; krok(n+1)=1.090928e-001; ng(n+1)=7.769286e+002;
n=33; farx(n+1)=2.959193e+000; foe(n+1)=2.038482e+001; krok(n+1)=7.491049e-001; ng(n+1)=6.788290e+002;
n=34; farx(n+1)=2.415260e+000; foe(n+1)=1.907870e+001; krok(n+1)=4.386596e-001; ng(n+1)=2.538765e+002;
n=35; farx(n+1)=2.137415e+000; foe(n+1)=1.804019e+001; krok(n+1)=6.914797e-001; ng(n+1)=2.699721e+002;
n=36; farx(n+1)=2.052476e+000; foe(n+1)=1.708016e+001; krok(n+1)=6.930078e-001; ng(n+1)=7.048207e+002;
n=37; farx(n+1)=2.021720e+000; foe(n+1)=1.641427e+001; krok(n+1)=7.773108e-001; ng(n+1)=2.112882e+002;
n=38; farx(n+1)=1.872165e+000; foe(n+1)=1.590294e+001; krok(n+1)=4.714530e-001; ng(n+1)=2.242595e+002;
n=39; farx(n+1)=1.561931e+000; foe(n+1)=1.557243e+001; krok(n+1)=8.649503e-001; ng(n+1)=2.171887e+002;
n=40; farx(n+1)=1.435512e+000; foe(n+1)=1.527564e+001; krok(n+1)=4.602673e-001; ng(n+1)=4.619838e+002;
n=41; farx(n+1)=1.631406e+000; foe(n+1)=1.505851e+001; krok(n+1)=5.520515e-001; ng(n+1)=1.071172e+002;
n=42; farx(n+1)=1.537813e+000; foe(n+1)=1.487120e+001; krok(n+1)=1.155850e+000; ng(n+1)=1.220707e+002;
n=43; farx(n+1)=1.479804e+000; foe(n+1)=1.481021e+001; krok(n+1)=2.781623e-001; ng(n+1)=1.142922e+002;
n=44; farx(n+1)=1.420028e+000; foe(n+1)=1.472984e+001; krok(n+1)=1.009068e+000; ng(n+1)=2.475820e+002;
n=45; farx(n+1)=1.349006e+000; foe(n+1)=1.468750e+001; krok(n+1)=7.848019e-001; ng(n+1)=9.181815e+001;
n=46; farx(n+1)=1.348916e+000; foe(n+1)=1.464538e+001; krok(n+1)=9.933049e-001; ng(n+1)=1.005414e+002;
n=47; farx(n+1)=1.332458e+000; foe(n+1)=1.461520e+001; krok(n+1)=7.101669e-001; ng(n+1)=3.289690e+001;
n=48; farx(n+1)=1.248501e+000; foe(n+1)=1.460068e+001; krok(n+1)=1.189063e+000; ng(n+1)=8.007710e+001;
n=49; farx(n+1)=1.232261e+000; foe(n+1)=1.459203e+001; krok(n+1)=1.617795e+000; ng(n+1)=5.163945e+001;
n=50; farx(n+1)=1.213746e+000; foe(n+1)=1.458800e+001; krok(n+1)=6.273059e-001; ng(n+1)=5.689002e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.213773e+000; foe(n+1)=1.458760e+001; krok(n+1)=6.697231e-006; ng(n+1)=1.781238e+001;
n=52; farx(n+1)=1.212789e+000; foe(n+1)=1.458668e+001; krok(n+1)=1.085468e-005; ng(n+1)=1.854351e+001;
n=53; farx(n+1)=1.210017e+000; foe(n+1)=1.458526e+001; krok(n+1)=6.831655e-005; ng(n+1)=1.108481e+001;
n=54; farx(n+1)=1.230208e+000; foe(n+1)=1.455993e+001; krok(n+1)=1.296700e-003; ng(n+1)=1.041998e+001;
n=55; farx(n+1)=1.158381e+000; foe(n+1)=1.455462e+001; krok(n+1)=1.032026e-001; ng(n+1)=3.911219e+000;
n=56; farx(n+1)=1.146342e+000; foe(n+1)=1.454810e+001; krok(n+1)=4.002904e-002; ng(n+1)=2.778481e+001;
n=57; farx(n+1)=1.125198e+000; foe(n+1)=1.454287e+001; krok(n+1)=8.343244e-002; ng(n+1)=5.000469e+001;
n=58; farx(n+1)=1.106696e+000; foe(n+1)=1.453347e+001; krok(n+1)=1.280929e+000; ng(n+1)=6.430916e+001;
n=59; farx(n+1)=1.086716e+000; foe(n+1)=1.452785e+001; krok(n+1)=1.498210e+000; ng(n+1)=3.983311e+001;
n=60; farx(n+1)=1.050880e+000; foe(n+1)=1.452512e+001; krok(n+1)=4.353621e-001; ng(n+1)=1.049872e+001;
n=61; farx(n+1)=1.022459e+000; foe(n+1)=1.452374e+001; krok(n+1)=1.111368e+000; ng(n+1)=1.688869e+001;
n=62; farx(n+1)=1.012266e+000; foe(n+1)=1.452261e+001; krok(n+1)=1.422745e+000; ng(n+1)=3.386325e+001;
n=63; farx(n+1)=9.966851e-001; foe(n+1)=1.452210e+001; krok(n+1)=7.679697e-001; ng(n+1)=7.531647e+000;
n=64; farx(n+1)=9.902037e-001; foe(n+1)=1.452194e+001; krok(n+1)=9.673187e-001; ng(n+1)=5.704007e+000;
n=65; farx(n+1)=9.859382e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.516744e+000; ng(n+1)=3.366773e+000;
n=66; farx(n+1)=9.842507e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.310195e-001; ng(n+1)=2.125861e+000;
n=67; farx(n+1)=9.838521e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.585247e+000; ng(n+1)=5.894182e-001;
n=68; farx(n+1)=9.839730e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.258604e+000; ng(n+1)=7.715795e-002;
n=69; farx(n+1)=9.839893e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.159604e-001; ng(n+1)=5.905641e-002;
n=70; farx(n+1)=9.839893e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.675917e-005; ng(n+1)=1.019845e-002;
n=71; farx(n+1)=9.839893e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.306563e-006; ng(n+1)=1.019827e-002;
n=72; farx(n+1)=9.839893e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.444961e-005; ng(n+1)=1.019822e-002;
n=73; farx(n+1)=9.839893e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.847167e-008; ng(n+1)=1.019757e-002;
n=74; farx(n+1)=9.839893e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.244059e-006; ng(n+1)=1.019757e-002;
n=75; farx(n+1)=9.839893e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.612156e-009; ng(n+1)=1.019756e-002;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839894e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.826176e-006; ng(n+1)=1.019756e-002;
n=77; farx(n+1)=9.839895e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.653830e-005; ng(n+1)=3.578452e-003;
n=78; farx(n+1)=9.839898e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.977673e-005; ng(n+1)=1.506548e-003;
n=79; farx(n+1)=9.839879e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.899418e-003; ng(n+1)=1.165785e-004;
n=80; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.664599e-003; ng(n+1)=9.538678e-005;
n=81; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.139878e-005; ng(n+1)=7.450029e-005;
n=82; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.630239e-005; ng(n+1)=7.449442e-005;
n=83; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.349696e-006; ng(n+1)=7.449281e-005;
n=84; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.284475e-005; ng(n+1)=7.449240e-005;
n=85; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.230369e-006; ng(n+1)=7.449145e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=86; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.300043e-006; ng(n+1)=7.449107e-005;
n=87; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.574106e-006; ng(n+1)=8.333581e-005;
n=88; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.046444e-006; ng(n+1)=4.661997e-005;
n=89; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.684881e-005; ng(n+1)=4.639960e-005;
n=90; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.215693e-005; ng(n+1)=4.639596e-005;
n=91; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.418894e-005; ng(n+1)=4.638073e-005;
n=92; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.499946e-007; ng(n+1)=4.637361e-005;
n=93; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.832360e-012; ng(n+1)=4.637357e-005;
n=94; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.474124e-011; ng(n+1)=4.637358e-005;
n=95; farx(n+1)=9.839862e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.890319e-011; ng(n+1)=4.637357e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
