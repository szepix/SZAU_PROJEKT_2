%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.103969e+002; foe(n+1)=6.233179e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=5.990847e+002; foe(n+1)=6.112224e+002; krok(n+1)=6.384605e-004; ng(n+1)=2.359495e+002;
n=2; farx(n+1)=2.010607e+002; foe(n+1)=2.114478e+002; krok(n+1)=1.572069e-002; ng(n+1)=1.680377e+002;
n=3; farx(n+1)=1.903409e+002; foe(n+1)=1.893806e+002; krok(n+1)=6.450159e-003; ng(n+1)=4.057621e+002;
n=4; farx(n+1)=1.887099e+002; foe(n+1)=1.882098e+002; krok(n+1)=1.529718e-003; ng(n+1)=2.055419e+002;
n=5; farx(n+1)=1.602747e+002; foe(n+1)=1.832872e+002; krok(n+1)=5.099752e-002; ng(n+1)=1.669516e+002;
n=6; farx(n+1)=1.699060e+002; foe(n+1)=1.700353e+002; krok(n+1)=2.503104e-001; ng(n+1)=2.415236e+002;
n=7; farx(n+1)=1.470875e+002; foe(n+1)=1.644558e+002; krok(n+1)=9.073805e-001; ng(n+1)=1.388512e+002;
n=8; farx(n+1)=1.337225e+002; foe(n+1)=1.602369e+002; krok(n+1)=2.845227e-001; ng(n+1)=5.836860e+001;
n=9; farx(n+1)=8.596794e+001; foe(n+1)=1.473707e+002; krok(n+1)=1.083384e+000; ng(n+1)=5.323594e+001;
n=10; farx(n+1)=8.345993e+001; foe(n+1)=1.470955e+002; krok(n+1)=1.255187e-003; ng(n+1)=4.126164e+002;
n=11; farx(n+1)=4.996802e+001; foe(n+1)=1.331480e+002; krok(n+1)=3.854790e-001; ng(n+1)=6.504316e+002;
n=12; farx(n+1)=4.268182e+001; foe(n+1)=1.300351e+002; krok(n+1)=2.556569e-002; ng(n+1)=1.107942e+003;
n=13; farx(n+1)=2.176605e+001; foe(n+1)=1.042550e+002; krok(n+1)=2.764164e-001; ng(n+1)=1.135260e+003;
n=14; farx(n+1)=2.032287e+001; foe(n+1)=9.946883e+001; krok(n+1)=4.416696e-003; ng(n+1)=3.924619e+003;
n=15; farx(n+1)=1.844852e+001; foe(n+1)=9.077446e+001; krok(n+1)=1.653712e-001; ng(n+1)=3.841403e+003;
n=16; farx(n+1)=1.509426e+001; foe(n+1)=6.941880e+001; krok(n+1)=2.403251e-001; ng(n+1)=3.869658e+003;
n=17; farx(n+1)=1.601419e+001; foe(n+1)=6.626649e+001; krok(n+1)=1.549330e-001; ng(n+1)=1.023594e+003;
n=18; farx(n+1)=1.617805e+001; foe(n+1)=5.800810e+001; krok(n+1)=1.005489e+000; ng(n+1)=1.149984e+003;
n=19; farx(n+1)=1.262642e+001; foe(n+1)=4.804489e+001; krok(n+1)=2.196657e+000; ng(n+1)=1.018794e+003;
n=20; farx(n+1)=1.025247e+001; foe(n+1)=4.372133e+001; krok(n+1)=8.773192e-001; ng(n+1)=9.552924e+002;
n=21; farx(n+1)=9.086772e+000; foe(n+1)=3.872199e+001; krok(n+1)=6.871474e-001; ng(n+1)=1.529368e+002;
n=22; farx(n+1)=6.922938e+000; foe(n+1)=3.383900e+001; krok(n+1)=2.012558e+000; ng(n+1)=4.663428e+002;
n=23; farx(n+1)=6.044109e+000; foe(n+1)=3.005978e+001; krok(n+1)=5.813025e-001; ng(n+1)=3.258585e+002;
n=24; farx(n+1)=5.386519e+000; foe(n+1)=2.673086e+001; krok(n+1)=6.614848e-001; ng(n+1)=5.658463e+002;
n=25; farx(n+1)=4.132793e+000; foe(n+1)=2.338092e+001; krok(n+1)=6.163806e-001; ng(n+1)=4.669579e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.039202e+000; foe(n+1)=2.273379e+001; krok(n+1)=1.063629e-005; ng(n+1)=4.859173e+002;
n=27; farx(n+1)=3.572885e+000; foe(n+1)=2.154523e+001; krok(n+1)=5.097701e-005; ng(n+1)=3.821685e+002;
n=28; farx(n+1)=3.493720e+000; foe(n+1)=2.126366e+001; krok(n+1)=8.374265e-004; ng(n+1)=4.833821e+001;
n=29; farx(n+1)=3.622937e+000; foe(n+1)=1.989735e+001; krok(n+1)=1.182363e-003; ng(n+1)=9.574281e+001;
n=30; farx(n+1)=3.596408e+000; foe(n+1)=1.930473e+001; krok(n+1)=3.127663e-003; ng(n+1)=2.616465e+002;
n=31; farx(n+1)=2.822831e+000; foe(n+1)=1.861151e+001; krok(n+1)=5.113139e-002; ng(n+1)=2.399759e+002;
n=32; farx(n+1)=2.198467e+000; foe(n+1)=1.814384e+001; krok(n+1)=9.636975e-002; ng(n+1)=3.760274e+002;
n=33; farx(n+1)=2.055043e+000; foe(n+1)=1.720346e+001; krok(n+1)=1.056270e+000; ng(n+1)=3.001067e+002;
n=34; farx(n+1)=1.948926e+000; foe(n+1)=1.651304e+001; krok(n+1)=8.823184e-001; ng(n+1)=3.754049e+002;
n=35; farx(n+1)=1.792566e+000; foe(n+1)=1.593380e+001; krok(n+1)=4.819709e-001; ng(n+1)=2.208786e+002;
n=36; farx(n+1)=1.649647e+000; foe(n+1)=1.566131e+001; krok(n+1)=6.776371e-001; ng(n+1)=1.775275e+002;
n=37; farx(n+1)=1.582495e+000; foe(n+1)=1.527022e+001; krok(n+1)=1.454334e+000; ng(n+1)=3.531399e+002;
n=38; farx(n+1)=1.585125e+000; foe(n+1)=1.502924e+001; krok(n+1)=4.372988e-001; ng(n+1)=8.118752e+001;
n=39; farx(n+1)=1.518504e+000; foe(n+1)=1.495710e+001; krok(n+1)=6.553300e-001; ng(n+1)=7.446157e+001;
n=40; farx(n+1)=1.318274e+000; foe(n+1)=1.479630e+001; krok(n+1)=1.779515e+000; ng(n+1)=2.499028e+002;
n=41; farx(n+1)=1.429779e+000; foe(n+1)=1.469702e+001; krok(n+1)=8.209742e-001; ng(n+1)=7.986875e+001;
n=42; farx(n+1)=1.384813e+000; foe(n+1)=1.467091e+001; krok(n+1)=6.656880e-001; ng(n+1)=1.746660e+002;
n=43; farx(n+1)=1.347890e+000; foe(n+1)=1.464064e+001; krok(n+1)=4.188592e-001; ng(n+1)=6.564394e+001;
n=44; farx(n+1)=1.228184e+000; foe(n+1)=1.457897e+001; krok(n+1)=7.271671e-001; ng(n+1)=7.405135e+001;
n=45; farx(n+1)=1.214732e+000; foe(n+1)=1.456924e+001; krok(n+1)=4.909897e-001; ng(n+1)=1.221199e+002;
n=46; farx(n+1)=1.100405e+000; foe(n+1)=1.455419e+001; krok(n+1)=8.847528e-001; ng(n+1)=6.826849e+001;
n=47; farx(n+1)=1.111067e+000; foe(n+1)=1.453572e+001; krok(n+1)=1.722419e+000; ng(n+1)=6.983932e+001;
n=48; farx(n+1)=1.107404e+000; foe(n+1)=1.453257e+001; krok(n+1)=5.535078e-001; ng(n+1)=2.171705e+001;
n=49; farx(n+1)=1.078017e+000; foe(n+1)=1.452778e+001; krok(n+1)=4.726961e-001; ng(n+1)=2.061214e+001;
n=50; farx(n+1)=1.064283e+000; foe(n+1)=1.452679e+001; krok(n+1)=8.179879e-001; ng(n+1)=3.401783e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.064651e+000; foe(n+1)=1.452653e+001; krok(n+1)=5.356044e-006; ng(n+1)=1.713230e+001;
n=52; farx(n+1)=1.064767e+000; foe(n+1)=1.452629e+001; krok(n+1)=4.525389e-006; ng(n+1)=1.822948e+001;
n=53; farx(n+1)=1.065733e+000; foe(n+1)=1.452622e+001; krok(n+1)=5.391128e-004; ng(n+1)=6.596878e-001;
n=54; farx(n+1)=1.067012e+000; foe(n+1)=1.452592e+001; krok(n+1)=2.383591e-004; ng(n+1)=2.678638e+000;
n=55; farx(n+1)=1.033335e+000; foe(n+1)=1.452343e+001; krok(n+1)=5.914179e-001; ng(n+1)=1.514725e-001;
n=56; farx(n+1)=1.015246e+000; foe(n+1)=1.452311e+001; krok(n+1)=2.357847e-002; ng(n+1)=9.857442e+000;
n=57; farx(n+1)=1.013402e+000; foe(n+1)=1.452294e+001; krok(n+1)=3.571281e-002; ng(n+1)=1.373868e+001;
n=58; farx(n+1)=1.003284e+000; foe(n+1)=1.452218e+001; krok(n+1)=1.371110e+000; ng(n+1)=1.764349e+001;
n=59; farx(n+1)=9.882619e-001; foe(n+1)=1.452192e+001; krok(n+1)=1.170743e+000; ng(n+1)=6.738918e+000;
n=60; farx(n+1)=9.856237e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.505130e+000; ng(n+1)=2.653652e+000;
n=61; farx(n+1)=9.842470e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.480438e-001; ng(n+1)=8.064375e-001;
n=62; farx(n+1)=9.839842e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.576737e-001; ng(n+1)=3.295727e-001;
n=63; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.100878e+000; ng(n+1)=2.526463e-002;
n=64; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.660513e-005; ng(n+1)=7.868196e-003;
n=65; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.106422e-006; ng(n+1)=7.868055e-003;
n=66; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.573435e-006; ng(n+1)=7.867991e-003;
n=67; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.709072e-006; ng(n+1)=7.867955e-003;
n=68; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.476011e-005; ng(n+1)=7.867934e-003;
n=69; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.150429e-005; ng(n+1)=7.867818e-003;
n=70; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.344676e-005; ng(n+1)=7.867727e-003;
n=71; farx(n+1)=9.839915e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.690940e-010; ng(n+1)=7.867621e-003;
n=72; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.710756e-002; ng(n+1)=7.867621e-003;
n=73; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.204290e-005; ng(n+1)=1.108795e-002;
n=74; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.344676e-005; ng(n+1)=1.108781e-002;
n=75; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.632711e-006; ng(n+1)=1.108766e-002;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839918e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.625920e-006; ng(n+1)=1.108760e-002;
n=77; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.108453e-005; ng(n+1)=6.653879e-004;
n=78; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.214901e-009; ng(n+1)=1.526289e-004;
n=79; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.907853e-005; ng(n+1)=1.526312e-004;
n=80; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.747856e-006; ng(n+1)=1.522766e-004;
n=81; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.056896e-007; ng(n+1)=1.522551e-004;
n=82; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.467555e-008; ng(n+1)=1.522541e-004;
n=83; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.561714e-006; ng(n+1)=1.522541e-004;
n=84; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.977599e-007; ng(n+1)=1.522535e-004;
n=85; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.728399e-010; ng(n+1)=1.522535e-004;
n=86; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.792054e-006; ng(n+1)=1.522535e-004;
n=87; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.550218e-005; ng(n+1)=1.522549e-004;
n=88; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.016951e-010; ng(n+1)=1.522324e-004;
n=89; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.219308e-007; ng(n+1)=1.522324e-004;
n=90; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.372249e-007; ng(n+1)=1.522459e-004;
n=91; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.380733e-008; ng(n+1)=1.522463e-004;
n=92; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.661569e-006; ng(n+1)=1.522463e-004;
n=93; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.482329e-008; ng(n+1)=1.522474e-004;
n=94; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.867152e-007; ng(n+1)=1.522474e-004;
n=95; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.257227e-007; ng(n+1)=1.522473e-004;
n=96; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.632381e-010; ng(n+1)=1.522473e-004;
n=97; farx(n+1)=9.839919e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.283804e-009; ng(n+1)=1.522473e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
