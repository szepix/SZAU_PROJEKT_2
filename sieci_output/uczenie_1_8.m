%uczenie predyktora oe
clear all;
n=0; farx(n+1)=6.676563e+002; foe(n+1)=6.542488e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.202479e+002; foe(n+1)=6.045528e+002; krok(n+1)=5.465324e-004; ng(n+1)=4.208631e+002;
n=2; farx(n+1)=2.468280e+002; foe(n+1)=2.130736e+002; krok(n+1)=1.097075e-002; ng(n+1)=1.787013e+002;
n=3; farx(n+1)=2.358533e+002; foe(n+1)=2.044461e+002; krok(n+1)=1.099965e-003; ng(n+1)=2.834206e+002;
n=4; farx(n+1)=2.658897e+002; foe(n+1)=1.989838e+002; krok(n+1)=2.680031e-002; ng(n+1)=2.134586e+002;
n=5; farx(n+1)=2.405125e+002; foe(n+1)=1.957297e+002; krok(n+1)=6.047937e-003; ng(n+1)=1.240729e+002;
n=6; farx(n+1)=2.315226e+002; foe(n+1)=1.854057e+002; krok(n+1)=6.189726e-002; ng(n+1)=2.070444e+002;
n=7; farx(n+1)=2.133939e+002; foe(n+1)=1.829900e+002; krok(n+1)=9.047997e-002; ng(n+1)=1.680140e+002;
n=8; farx(n+1)=2.876781e+001; foe(n+1)=1.187015e+002; krok(n+1)=1.008497e-001; ng(n+1)=2.221482e+002;
n=9; farx(n+1)=2.464739e+001; foe(n+1)=1.132200e+002; krok(n+1)=4.517978e-002; ng(n+1)=6.516023e+002;
n=10; farx(n+1)=2.566248e+001; foe(n+1)=1.068933e+002; krok(n+1)=5.558094e-002; ng(n+1)=6.847602e+002;
n=11; farx(n+1)=3.252050e+001; foe(n+1)=9.883588e+001; krok(n+1)=1.096481e-001; ng(n+1)=7.817343e+002;
n=12; farx(n+1)=1.933836e+001; foe(n+1)=7.935124e+001; krok(n+1)=2.511202e+000; ng(n+1)=2.889006e+002;
n=13; farx(n+1)=1.415471e+001; foe(n+1)=6.500374e+001; krok(n+1)=8.512166e-002; ng(n+1)=1.495363e+003;
n=14; farx(n+1)=1.318116e+001; foe(n+1)=6.102686e+001; krok(n+1)=3.897540e-002; ng(n+1)=1.064486e+003;
n=15; farx(n+1)=1.463112e+001; foe(n+1)=5.578693e+001; krok(n+1)=7.551359e-002; ng(n+1)=1.527947e+003;
n=16; farx(n+1)=1.449242e+001; foe(n+1)=5.171535e+001; krok(n+1)=3.319551e-001; ng(n+1)=1.337584e+003;
n=17; farx(n+1)=1.310474e+001; foe(n+1)=4.794127e+001; krok(n+1)=2.485530e-001; ng(n+1)=6.549783e+002;
n=18; farx(n+1)=7.160427e+000; foe(n+1)=3.773516e+001; krok(n+1)=2.657511e+000; ng(n+1)=4.765024e+002;
n=19; farx(n+1)=5.788112e+000; foe(n+1)=3.311489e+001; krok(n+1)=1.038220e+000; ng(n+1)=2.615550e+002;
n=20; farx(n+1)=5.476893e+000; foe(n+1)=2.920820e+001; krok(n+1)=3.923690e-001; ng(n+1)=4.758765e+002;
n=21; farx(n+1)=5.084432e+000; foe(n+1)=2.785362e+001; krok(n+1)=6.268073e-001; ng(n+1)=2.253694e+002;
n=22; farx(n+1)=4.722625e+000; foe(n+1)=2.707500e+001; krok(n+1)=8.008859e-001; ng(n+1)=2.565126e+002;
n=23; farx(n+1)=4.366577e+000; foe(n+1)=2.479382e+001; krok(n+1)=2.560234e+000; ng(n+1)=1.086111e+002;
n=24; farx(n+1)=4.023672e+000; foe(n+1)=2.404104e+001; krok(n+1)=4.485036e-001; ng(n+1)=1.790820e+002;
n=25; farx(n+1)=3.708383e+000; foe(n+1)=2.357873e+001; krok(n+1)=3.075863e-001; ng(n+1)=5.061190e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.633649e+000; foe(n+1)=2.348369e+001; krok(n+1)=1.572983e-005; ng(n+1)=1.806370e+002;
n=27; farx(n+1)=3.544192e+000; foe(n+1)=2.308508e+001; krok(n+1)=5.111781e-005; ng(n+1)=1.768943e+002;
n=28; farx(n+1)=3.285372e+000; foe(n+1)=2.182715e+001; krok(n+1)=4.616173e-004; ng(n+1)=1.249403e+002;
n=29; farx(n+1)=2.326403e+000; foe(n+1)=1.906721e+001; krok(n+1)=5.828972e-004; ng(n+1)=1.705676e+002;
n=30; farx(n+1)=2.259345e+000; foe(n+1)=1.889313e+001; krok(n+1)=1.615205e-002; ng(n+1)=3.611450e+002;
n=31; farx(n+1)=2.258736e+000; foe(n+1)=1.888134e+001; krok(n+1)=5.557598e-003; ng(n+1)=5.390782e+002;
n=32; farx(n+1)=2.572728e+000; foe(n+1)=1.870973e+001; krok(n+1)=1.337651e-001; ng(n+1)=4.686001e+002;
n=33; farx(n+1)=2.264451e+000; foe(n+1)=1.719019e+001; krok(n+1)=1.691553e+000; ng(n+1)=4.420806e+002;
n=34; farx(n+1)=1.654823e+000; foe(n+1)=1.622202e+001; krok(n+1)=1.272242e+000; ng(n+1)=2.384634e+002;
n=35; farx(n+1)=1.601609e+000; foe(n+1)=1.572262e+001; krok(n+1)=7.011953e-001; ng(n+1)=4.383904e+002;
n=36; farx(n+1)=1.666436e+000; foe(n+1)=1.542787e+001; krok(n+1)=3.050693e-001; ng(n+1)=2.029423e+002;
n=37; farx(n+1)=1.769894e+000; foe(n+1)=1.524784e+001; krok(n+1)=3.589327e-001; ng(n+1)=1.835551e+002;
n=38; farx(n+1)=1.395950e+000; foe(n+1)=1.499667e+001; krok(n+1)=1.854055e+000; ng(n+1)=2.251325e+002;
n=39; farx(n+1)=1.414978e+000; foe(n+1)=1.486117e+001; krok(n+1)=5.772243e-001; ng(n+1)=2.862934e+002;
n=40; farx(n+1)=1.452213e+000; foe(n+1)=1.475989e+001; krok(n+1)=4.275922e-001; ng(n+1)=4.780869e+001;
n=41; farx(n+1)=1.443197e+000; foe(n+1)=1.471075e+001; krok(n+1)=5.956610e-001; ng(n+1)=8.181198e+001;
n=42; farx(n+1)=1.393728e+000; foe(n+1)=1.467046e+001; krok(n+1)=9.961132e-001; ng(n+1)=7.416258e+001;
n=43; farx(n+1)=1.311546e+000; foe(n+1)=1.463181e+001; krok(n+1)=6.674447e-001; ng(n+1)=1.846943e+002;
n=44; farx(n+1)=1.254507e+000; foe(n+1)=1.460445e+001; krok(n+1)=5.570755e-001; ng(n+1)=3.706423e+001;
n=45; farx(n+1)=1.287146e+000; foe(n+1)=1.458713e+001; krok(n+1)=9.769152e-001; ng(n+1)=4.195841e+001;
n=46; farx(n+1)=1.274133e+000; foe(n+1)=1.457491e+001; krok(n+1)=1.315598e+000; ng(n+1)=4.920393e+001;
n=47; farx(n+1)=1.186975e+000; foe(n+1)=1.456270e+001; krok(n+1)=8.340965e-001; ng(n+1)=3.013733e+001;
n=48; farx(n+1)=1.147033e+000; foe(n+1)=1.455771e+001; krok(n+1)=9.985387e-001; ng(n+1)=3.390301e+001;
n=49; farx(n+1)=1.130650e+000; foe(n+1)=1.455326e+001; krok(n+1)=1.420334e+000; ng(n+1)=4.083999e+001;
n=50; farx(n+1)=1.103826e+000; foe(n+1)=1.455015e+001; krok(n+1)=7.310195e-001; ng(n+1)=5.693320e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.104039e+000; foe(n+1)=1.454995e+001; krok(n+1)=2.429186e-006; ng(n+1)=1.467274e+001;
n=52; farx(n+1)=1.104313e+000; foe(n+1)=1.454965e+001; krok(n+1)=1.814366e-005; ng(n+1)=1.040698e+001;
n=53; farx(n+1)=1.112385e+000; foe(n+1)=1.453380e+001; krok(n+1)=1.889294e-003; ng(n+1)=7.048399e+000;
n=54; farx(n+1)=1.116373e+000; foe(n+1)=1.453249e+001; krok(n+1)=4.438276e-005; ng(n+1)=1.215048e+001;
n=55; farx(n+1)=1.093235e+000; foe(n+1)=1.453125e+001; krok(n+1)=2.594061e-002; ng(n+1)=1.397452e+000;
n=56; farx(n+1)=1.100802e+000; foe(n+1)=1.452943e+001; krok(n+1)=7.828124e-002; ng(n+1)=3.956909e+000;
n=57; farx(n+1)=1.053449e+000; foe(n+1)=1.452590e+001; krok(n+1)=1.958039e-001; ng(n+1)=8.170674e+000;
n=58; farx(n+1)=1.018545e+000; foe(n+1)=1.452349e+001; krok(n+1)=1.512163e+000; ng(n+1)=4.191133e+001;
n=59; farx(n+1)=1.015518e+000; foe(n+1)=1.452263e+001; krok(n+1)=8.334333e-001; ng(n+1)=1.837518e+001;
n=60; farx(n+1)=9.963699e-001; foe(n+1)=1.452207e+001; krok(n+1)=1.087290e+000; ng(n+1)=1.045355e+001;
n=61; farx(n+1)=9.862366e-001; foe(n+1)=1.452192e+001; krok(n+1)=1.818906e+000; ng(n+1)=4.640257e+000;
n=62; farx(n+1)=9.855727e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.704536e-001; ng(n+1)=7.837089e+000;
n=63; farx(n+1)=9.839940e-001; foe(n+1)=1.452189e+001; krok(n+1)=7.847380e-001; ng(n+1)=1.025944e+000;
n=64; farx(n+1)=9.839526e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.081948e+000; ng(n+1)=7.035642e-002;
n=65; farx(n+1)=9.839816e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.244898e+000; ng(n+1)=5.724956e-002;
n=66; farx(n+1)=9.839816e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.302585e-005; ng(n+1)=5.333088e-003;
n=67; farx(n+1)=9.839816e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.526923e-011; ng(n+1)=5.333020e-003;
n=68; farx(n+1)=9.839816e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.600086e-006; ng(n+1)=5.333020e-003;
n=69; farx(n+1)=9.839816e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.960983e-009; ng(n+1)=5.332773e-003;
n=70; farx(n+1)=9.839816e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.740021e-007; ng(n+1)=5.332773e-003;
n=71; farx(n+1)=9.839816e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.384861e-010; ng(n+1)=5.332769e-003;
n=72; farx(n+1)=9.839816e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.604471e-011; ng(n+1)=5.332769e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=73; farx(n+1)=9.839812e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.383749e-005; ng(n+1)=5.332769e-003;
n=74; farx(n+1)=9.839811e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.612004e-006; ng(n+1)=3.297144e-003;
n=75; farx(n+1)=9.839808e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.672860e-005; ng(n+1)=2.627884e-003;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.839808e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.725175e-006; ng(n+1)=2.467504e-004;
n=77; farx(n+1)=9.839813e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.605927e-004; ng(n+1)=2.712938e-004;
n=78; farx(n+1)=9.839818e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.098532e-004; ng(n+1)=1.007602e-003;
n=79; farx(n+1)=9.839819e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.311024e-005; ng(n+1)=9.460504e-004;
n=80; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=9.326892e-003; ng(n+1)=1.563302e-004;
n=81; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.504667e-006; ng(n+1)=1.082906e-004;
n=82; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.646043e-005; ng(n+1)=1.082894e-004;
n=83; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.738439e-006; ng(n+1)=1.082869e-004;
n=84; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.069939e-005; ng(n+1)=1.082866e-004;
n=85; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.606966e-005; ng(n+1)=1.082855e-004;
n=86; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=3.023578e-008; ng(n+1)=1.082826e-004;
n=87; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.757149e-006; ng(n+1)=1.082826e-004;
n=88; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.644844e-010; ng(n+1)=1.082827e-004;
n=89; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=8.905006e-006; ng(n+1)=1.082827e-004;
n=90; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=6.880834e-007; ng(n+1)=1.083047e-004;
n=91; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.676308e-007; ng(n+1)=1.083037e-004;
n=92; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.779782e-006; ng(n+1)=1.083046e-004;
n=93; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=5.348515e-009; ng(n+1)=1.083058e-004;
n=94; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=4.099979e-006; ng(n+1)=1.083059e-004;
n=95; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.002836e-005; ng(n+1)=1.083011e-004;
n=96; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=1.403351e-008; ng(n+1)=1.083042e-004;
n=97; farx(n+1)=9.839851e-001; foe(n+1)=1.452189e+001; krok(n+1)=2.447853e-009; ng(n+1)=1.083042e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
