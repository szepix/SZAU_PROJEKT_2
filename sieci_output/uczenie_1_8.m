%uczenie predyktora oe
clear all;
n=0; farx(n+1)=9.311611e+002; foe(n+1)=9.377501e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=9.156938e+002; foe(n+1)=9.003508e+002; krok(n+1)=8.500296e-004; ng(n+1)=3.552429e+002;
n=2; farx(n+1)=2.318657e+002; foe(n+1)=1.858207e+002; krok(n+1)=6.776891e-003; ng(n+1)=3.394065e+002;
n=3; farx(n+1)=2.187807e+002; foe(n+1)=1.829259e+002; krok(n+1)=1.472618e-004; ng(n+1)=3.333603e+002;
n=4; farx(n+1)=1.925172e+002; foe(n+1)=1.769115e+002; krok(n+1)=1.091588e-002; ng(n+1)=1.707229e+002;
n=5; farx(n+1)=1.257640e+002; foe(n+1)=1.676202e+002; krok(n+1)=7.039256e-004; ng(n+1)=2.040265e+002;
n=6; farx(n+1)=1.328568e+002; foe(n+1)=1.652993e+002; krok(n+1)=5.557598e-003; ng(n+1)=5.984970e+002;
n=7; farx(n+1)=2.443941e+001; foe(n+1)=1.254747e+002; krok(n+1)=3.261226e-001; ng(n+1)=5.468219e+002;
n=8; farx(n+1)=2.091216e+001; foe(n+1)=1.227938e+002; krok(n+1)=8.891335e-003; ng(n+1)=2.594739e+003;
n=9; farx(n+1)=2.145646e+001; foe(n+1)=1.044840e+002; krok(n+1)=6.428475e-001; ng(n+1)=3.271483e+003;
n=10; farx(n+1)=1.678344e+001; foe(n+1)=7.458602e+001; krok(n+1)=4.356626e-002; ng(n+1)=1.980468e+003;
n=11; farx(n+1)=1.538443e+001; foe(n+1)=6.030325e+001; krok(n+1)=1.006999e-001; ng(n+1)=1.577154e+003;
n=12; farx(n+1)=8.525720e+000; foe(n+1)=4.442905e+001; krok(n+1)=4.003408e-001; ng(n+1)=7.284403e+002;
n=13; farx(n+1)=4.744188e+000; foe(n+1)=3.355787e+001; krok(n+1)=2.836964e-001; ng(n+1)=3.576311e+002;
n=14; farx(n+1)=3.390655e+000; foe(n+1)=2.240664e+001; krok(n+1)=1.128562e+000; ng(n+1)=1.326222e+003;
n=15; farx(n+1)=2.079613e+000; foe(n+1)=1.771363e+001; krok(n+1)=6.930078e-001; ng(n+1)=9.465927e+002;
n=16; farx(n+1)=1.432401e+000; foe(n+1)=1.628706e+001; krok(n+1)=6.328829e-001; ng(n+1)=3.360212e+002;
n=17; farx(n+1)=1.522976e+000; foe(n+1)=1.566167e+001; krok(n+1)=2.016487e+000; ng(n+1)=2.943854e+002;
n=18; farx(n+1)=1.493399e+000; foe(n+1)=1.476749e+001; krok(n+1)=1.934637e+000; ng(n+1)=2.556765e+002;
n=19; farx(n+1)=1.351149e+000; foe(n+1)=1.399535e+001; krok(n+1)=4.187571e-001; ng(n+1)=5.297731e+002;
n=20; farx(n+1)=1.072682e+000; foe(n+1)=1.333514e+001; krok(n+1)=7.571530e-001; ng(n+1)=2.511472e+002;
n=21; farx(n+1)=1.039466e+000; foe(n+1)=1.297145e+001; krok(n+1)=1.512759e-001; ng(n+1)=2.072691e+002;
n=22; farx(n+1)=1.085252e+000; foe(n+1)=1.223324e+001; krok(n+1)=1.179292e+000; ng(n+1)=1.259823e+002;
n=23; farx(n+1)=1.055867e+000; foe(n+1)=1.170089e+001; krok(n+1)=1.822196e+000; ng(n+1)=3.258975e+002;
n=24; farx(n+1)=9.556276e-001; foe(n+1)=1.066142e+001; krok(n+1)=1.691553e+000; ng(n+1)=2.934976e+002;
n=25; farx(n+1)=9.819881e-001; foe(n+1)=1.031542e+001; krok(n+1)=5.138574e-001; ng(n+1)=5.257913e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=9.688522e-001; foe(n+1)=1.027206e+001; krok(n+1)=4.910098e-006; ng(n+1)=2.301631e+002;
n=27; farx(n+1)=9.611984e-001; foe(n+1)=1.024768e+001; krok(n+1)=1.496592e-005; ng(n+1)=9.202875e+001;
n=28; farx(n+1)=9.473168e-001; foe(n+1)=1.022109e+001; krok(n+1)=6.446963e-005; ng(n+1)=4.096353e+001;
n=29; farx(n+1)=9.030133e-001; foe(n+1)=1.003996e+001; krok(n+1)=2.695374e-003; ng(n+1)=1.894490e+001;
n=30; farx(n+1)=8.723864e-001; foe(n+1)=9.893584e+000; krok(n+1)=9.127324e-003; ng(n+1)=2.809328e+001;
n=31; farx(n+1)=8.843260e-001; foe(n+1)=9.774666e+000; krok(n+1)=3.400118e-003; ng(n+1)=2.191934e+002;
n=32; farx(n+1)=8.494157e-001; foe(n+1)=9.751874e+000; krok(n+1)=5.734876e-002; ng(n+1)=3.620311e+002;
n=33; farx(n+1)=8.624060e-001; foe(n+1)=9.599275e+000; krok(n+1)=1.190373e+000; ng(n+1)=2.947716e+002;
n=34; farx(n+1)=8.378038e-001; foe(n+1)=9.499343e+000; krok(n+1)=1.190373e+000; ng(n+1)=1.219762e+002;
n=35; farx(n+1)=8.335866e-001; foe(n+1)=9.474972e+000; krok(n+1)=8.670260e-001; ng(n+1)=7.080611e+001;
n=36; farx(n+1)=8.271272e-001; foe(n+1)=9.454345e+000; krok(n+1)=9.145402e-001; ng(n+1)=1.201115e+002;
n=37; farx(n+1)=8.147688e-001; foe(n+1)=9.441524e+000; krok(n+1)=1.594157e+000; ng(n+1)=5.038286e+001;
n=38; farx(n+1)=8.004222e-001; foe(n+1)=9.434894e+000; krok(n+1)=2.808512e+000; ng(n+1)=1.257870e+001;
n=39; farx(n+1)=7.933271e-001; foe(n+1)=9.431557e+000; krok(n+1)=1.107016e+000; ng(n+1)=3.026027e+001;
n=40; farx(n+1)=7.741164e-001; foe(n+1)=9.424145e+000; krok(n+1)=1.476581e+000; ng(n+1)=5.854133e+001;
n=41; farx(n+1)=7.495201e-001; foe(n+1)=9.416922e+000; krok(n+1)=2.408839e+000; ng(n+1)=1.949247e+001;
n=42; farx(n+1)=7.418200e-001; foe(n+1)=9.415798e+000; krok(n+1)=1.261180e+000; ng(n+1)=2.526356e+001;
n=43; farx(n+1)=7.402967e-001; foe(n+1)=9.415595e+000; krok(n+1)=9.576737e-001; ng(n+1)=1.236120e+001;
n=44; farx(n+1)=7.399925e-001; foe(n+1)=9.415444e+000; krok(n+1)=1.975361e+000; ng(n+1)=5.548926e+000;
n=45; farx(n+1)=7.405762e-001; foe(n+1)=9.415427e+000; krok(n+1)=1.023163e+000; ng(n+1)=1.337993e+000;
n=46; farx(n+1)=7.408938e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.113726e-001; ng(n+1)=5.832426e-001;
n=47; farx(n+1)=7.409055e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.340965e-001; ng(n+1)=3.560537e-002;
n=48; farx(n+1)=7.409281e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.296705e+000; ng(n+1)=2.681009e-002;
n=49; farx(n+1)=7.409281e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.618497e-005; ng(n+1)=6.513014e-003;
n=50; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.000274e+000; ng(n+1)=6.512694e-003;
%odnowa zmiennej metryki
n=51; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.269631e-006; ng(n+1)=2.559444e-006;
n=52; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.226987e-006; ng(n+1)=7.789406e-007;
n=53; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=8.080268e-006; ng(n+1)=1.508476e-006;
n=54; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.616520e-005; ng(n+1)=1.507794e-006;
n=55; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.348599e-006; ng(n+1)=1.507765e-006;
n=56; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.523765e-006; ng(n+1)=1.507714e-006;
n=57; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.430061e-005; ng(n+1)=1.507707e-006;
n=58; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.252525e-007; ng(n+1)=1.507659e-006;
n=59; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=5.331223e-007; ng(n+1)=1.507664e-006;
n=60; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.400140e-007; ng(n+1)=1.507692e-006;
n=61; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.559044e-007; ng(n+1)=1.507699e-006;
n=62; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=4.300521e-008; ng(n+1)=1.507690e-006;
n=63; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.179989e-006; ng(n+1)=1.507706e-006;
n=64; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.561103e-007; ng(n+1)=1.507652e-006;
n=65; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.905083e-008; ng(n+1)=1.507646e-006;
 % z³y kierunek w metodzie zm - odnowa 
n=66; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=3.779522e-007; ng(n+1)=1.507655e-006;
n=67; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.639991e-005; ng(n+1)=1.263446e-006;
n=68; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=2.816905e-005; ng(n+1)=1.587237e-006;
n=69; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=7.166239e-006; ng(n+1)=1.576622e-006;
n=70; farx(n+1)=7.409278e-001; foe(n+1)=9.415426e+000; krok(n+1)=1.664714e-008; ng(n+1)=1.576599e-006;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
